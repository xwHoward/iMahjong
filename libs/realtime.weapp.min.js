!function (e, t) { "object" == typeof exports && "undefined" != typeof module ? t(exports) : "function" == typeof define && define.amd ? define("leancloud-realtime", ["exports"], t) : t(e.AV = e.AV || {}) }(this, function (e) { "use strict"; function t() { throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs") } function n(e) { return e && e.__esModule && Object.prototype.hasOwnProperty.call(e, "default") ? e.default : e } function r(e, t) { return t = { exports: {} }, e(t, t.exports), t.exports } function i(e) { var t, n; this.promise = new e(function (e, r) { if (void 0 !== t || void 0 !== n) throw TypeError("Bad Promise constructor"); t = e, n = r }), this.resolve = H(t), this.reject = H(n) } function o(e) { if (null === e || void 0 === e) throw new TypeError("Object.assign cannot be called with null or undefined"); return Object(e) } function s(e, t) { for (var n = e[ei][t]; null != n;) { if (n.kind === ti) return n.listener; n = n.next } return null } function a(e, t, n) { "function" != typeof n && "object" != typeof n && (n = null); for (var r = null, i = e[ei][t]; null != i;)i.kind === ti ? null == r ? e[ei][t] = i.next : r.next = i.next : r = i, i = i.next; null != n && (null == r ? e[ei][t] = ni(n, ti) : r.next = ni(n, ti)) } function u(e) { this.status = e.statusCode, this.statusText = e.statusCode, e.header && (this._responseHeaders = Jr(e.header).reduce(function (t, n) { return t[n.toLowerCase()] = e.header[n], t }, {})); var t = e.data; "string" != typeof t && (t = Wr(t)), this.responseText = this.response = t, this.readyState = pi, this.dispatchEvent({ type: "readystatechange" }) } function f(e) { "" !== e.message && Ei && (Ei._readyState = _i, Ei.dispatchEvent({ type: "error", message: e.errMsg })) } function c(e) { if (!((e = String(e)).length > 100)) { var t = /^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e); if (t) { var n = parseFloat(t[1]); switch ((t[2] || "ms").toLowerCase()) { case "years": case "year": case "yrs": case "yr": case "y": return n * Go; case "days": case "day": case "d": return n * $o; case "hours": case "hour": case "hrs": case "hr": case "h": return n * Wo; case "minutes": case "minute": case "mins": case "min": case "m": return n * qo; case "seconds": case "second": case "secs": case "sec": case "s": return n * zo; case "milliseconds": case "millisecond": case "msecs": case "msec": case "ms": return n; default: return } } } } function l(e) { return e >= $o ? Math.round(e / $o) + "d" : e >= Wo ? Math.round(e / Wo) + "h" : e >= qo ? Math.round(e / qo) + "m" : e >= zo ? Math.round(e / zo) + "s" : e + "ms" } function h(e) { return p(e, $o, "day") || p(e, Wo, "hour") || p(e, qo, "minute") || p(e, zo, "second") || e + " ms" } function p(e, t, n) { if (!(e < t)) return e < 1.5 * t ? Math.floor(e / t) + " " + n : Math.ceil(e / t) + " " + n + "s" } function d(e) { return !!e.constructor && "function" == typeof e.constructor.isBuffer && e.constructor.isBuffer(e) } function m(e) { return "function" == typeof e.readFloatLE && "function" == typeof e.slice && d(e.slice(0, 0)) } function y(e) { return "[object Array]" === Ko.call(e) } function g(e) { return null !== e && "object" === (void 0 === e ? "undefined" : Ir(e)) } function v(e) { return "[object Function]" === Ko.call(e) } function b(e, t) { if (null !== e && void 0 !== e) if ("object" === (void 0 === e ? "undefined" : Ir(e)) || y(e) || (e = [e]), y(e)) for (var n = 0, r = e.length; n < r; n++)t.call(null, e[n], n, e); else for (var i in e) Object.prototype.hasOwnProperty.call(e, i) && t.call(null, e[i], i, e) } function w() { for (var e = {}, t = 0, n = arguments.length; t < n; t++)b(arguments[t], function (t, n) { "object" === Ir(e[n]) && "object" === (void 0 === t ? "undefined" : Ir(t)) ? e[n] = w(e[n], t) : e[n] = t }); return e } function _(e) { return encodeURIComponent(e).replace(/%40/gi, "@").replace(/%3A/gi, ":").replace(/%24/g, "$").replace(/%2C/gi, ",").replace(/%20/g, "+").replace(/%5B/gi, "[").replace(/%5D/gi, "]") } function E() { this.message = "String contains an invalid character" } function T(e, t) { !Qo.isUndefined(e) && Qo.isUndefined(e["Content-Type"]) && (e["Content-Type"] = t) } function S() { this.handlers = [] } function A(e) { e.cancelToken && e.cancelToken.throwIfRequested() } function I(e) { this.defaults = e, this.interceptors = { request: new ds, response: new ds } } function C(e) { this.message = e } function O(e) { if ("function" != typeof e) throw new TypeError("executor must be a function."); var t; this.promise = new In(function (e) { t = e }); var n = this; e(function (e) { n.reason || (n.reason = new _s(e), t(n.reason)) }) } function x(e) { var t = new ws(e), n = Xo(ws.prototype.request, t); return Qo.extend(n, ws.prototype, t), Qo.extend(n, t), n } function M(e, t, n, r, i) { var o = {}; return Object.keys(r).forEach(function (e) { o[e] = r[e] }), o.enumerable = !!o.enumerable, o.configurable = !!o.configurable, ("value" in o || o.initializer) && (o.writable = !0), o = n.slice().reverse().reduce(function (n, r) { return r(e, t, n) || n }, o), i && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(i) : void 0, o.initializer = void 0), void 0 === o.initializer && (Object.defineProperty(e, t, o), o = null), o } function P(e) { var t = -1, n = null == e ? 0 : e.length; for (this.clear(); ++t < n;) { var r = e[t]; this.set(r[0], r[1]) } } function R(e) { var t = -1, n = null == e ? 0 : e.length; for (this.clear(); ++t < n;) { var r = e[t]; this.set(r[0], r[1]) } } function L(e) { var t = -1, n = null == e ? 0 : e.length; for (this.clear(); ++t < n;) { var r = e[t]; this.set(r[0], r[1]) } } function k(e) { var t = this.__data__ = new Ef(e); this.size = t.size } function N(e) { var t = -1, n = null == e ? 0 : e.length; for (this.__data__ = new Gf; ++t < n;)this.add(e[t]) } function j(e, t, n, r, i) { return e === t || (null == e || null == t || !Xs(e) && !Xs(t) ? e !== e && t !== t : Zc(e, t, n, r, j, i)) } function F(e, t) { if ("function" != typeof e || null != t && "function" != typeof t) throw new TypeError(fl); var n = function () { var r = arguments, i = t ? t.apply(this, r) : r[0], o = n.cache; if (o.has(i)) return o.get(i); var s = e.apply(this, r); return n.cache = o.set(i, s) || o, s }; return n.cache = new (F.Cache || Gf), n } function U(e) { if ("string" == typeof e) return e; if (ia(e)) return Ls(e, U) + ""; if (ol(e)) return vl ? vl.call(e) : ""; var t = e + ""; return "0" == t && 1 / e == -yl ? "-0" : t } function D(e, t, n, r, i, o) { var s, a = t & tp, u = t & np, f = t & rp; if (n && (s = i ? n(e, r, i, o) : n(e)), void 0 !== s) return s; if (!Aa(e)) return e; var c = ia(e); if (c) { if (s = yh(e), !a) return Cs(e, s) } else { var l = zc(e), h = l == op || l == sp; if (sa(e)) return ch(e, a); if (l == ap || l == ip || h && !i) { if (s = u || h ? {} : ep(e), !a) return u ? ph(e, fh(s, e)) : lh(e, ih(s, e)) } else { if (!up[l]) return i ? e : {}; s = Xh(e, l, D, a) } } o || (o = new Zf); var p = o.get(e); if (p) return p; o.set(e, s); var d = f ? u ? dh : xc : u ? keysIn : Ra, m = c ? void 0 : d(e); return Kl(m || e, function (r, i) { m && (r = e[i = r]), nh(s, i, D(r, t, n, i, e, o)) }), s } function B() { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, t = e.signature, n = e.timestamp, r = e.nonce; if ("string" != typeof t || "number" != typeof n || "string" != typeof r) throw new Error("malformed signature"); return { signature: t, timestamp: n, nonce: r } } function V(e, t, n, r, i) { var o = {}; return Object.keys(r).forEach(function (e) { o[e] = r[e] }), o.enumerable = !!o.enumerable, o.configurable = !!o.configurable, ("value" in o || o.initializer) && (o.writable = !0), o = n.slice().reverse().reduce(function (n, r) { return r(e, t, n) || n }, o), i && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(i) : void 0, o.initializer = void 0), void 0 === o.initializer && (Object.defineProperty(e, t, o), o = null), o } var Y = window && window.process || {}; Y.env = Y.env || {}; var z = "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {}, q = Math.ceil, W = Math.floor, $ = function (e) { return isNaN(e = +e) ? 0 : (e > 0 ? W : q)(e) }, G = function (e) { if (void 0 == e) throw TypeError("Can't call method on  " + e); return e }, J = r(function (e) { var t = e.exports = "undefined" != typeof window && window.Math == Math ? window : "undefined" != typeof self && self.Math == Math ? self : Function("return this")(); "number" == typeof __g && (__g = t) }), Z = r(function (e) { var t = e.exports = { version: "2.5.1" }; "number" == typeof __e && (__e = t) }), H = function (e) { if ("function" != typeof e) throw TypeError(e + " is not a function!"); return e }, X = function (e, t, n) { if (H(e), void 0 === t) return e; switch (n) { case 1: return function (n) { return e.call(t, n) }; case 2: return function (n, r) { return e.call(t, n, r) }; case 3: return function (n, r, i) { return e.call(t, n, r, i) } }return function () { return e.apply(t, arguments) } }, K = function (e) { return "object" == typeof e ? null !== e : "function" == typeof e }, Q = function (e) { if (!K(e)) throw TypeError(e + " is not an object!"); return e }, ee = function (e) { try { return !!e() } catch (e) { return !0 } }, te = !ee(function () { return 7 != Object.defineProperty({}, "a", { get: function () { return 7 } }).a }), ne = J.document, re = K(ne) && K(ne.createElement), ie = function (e) { return re ? ne.createElement(e) : {} }, oe = !te && !ee(function () { return 7 != Object.defineProperty(ie("div"), "a", { get: function () { return 7 } }).a }), se = function (e, t) { if (!K(e)) return e; var n, r; if (t && "function" == typeof (n = e.toString) && !K(r = n.call(e))) return r; if ("function" == typeof (n = e.valueOf) && !K(r = n.call(e))) return r; if (!t && "function" == typeof (n = e.toString) && !K(r = n.call(e))) return r; throw TypeError("Can't convert object to primitive value") }, ae = Object.defineProperty, ue = { f: te ? Object.defineProperty : function (e, t, n) { if (Q(e), t = se(t, !0), Q(n), oe) try { return ae(e, t, n) } catch (e) { } if ("get" in n || "set" in n) throw TypeError("Accessors not supported!"); return "value" in n && (e[t] = n.value), e } }, fe = function (e, t) { return { enumerable: !(1 & e), configurable: !(2 & e), writable: !(4 & e), value: t } }, ce = te ? function (e, t, n) { return ue.f(e, t, fe(1, n)) } : function (e, t, n) { return e[t] = n, e }, le = function (e, t, n) { var r, i, o, s = e & le.F, a = e & le.G, u = e & le.S, f = e & le.P, c = e & le.B, l = e & le.W, h = a ? Z : Z[t] || (Z[t] = {}), p = h.prototype, d = a ? J : u ? J[t] : (J[t] || {}).prototype; a && (n = t); for (r in n) (i = !s && d && void 0 !== d[r]) && r in h || (o = i ? d[r] : n[r], h[r] = a && "function" != typeof d[r] ? n[r] : c && i ? X(o, J) : l && d[r] == o ? function (e) { var t = function (t, n, r) { if (this instanceof e) { switch (arguments.length) { case 0: return new e; case 1: return new e(t); case 2: return new e(t, n) }return new e(t, n, r) } return e.apply(this, arguments) }; return t.prototype = e.prototype, t }(o) : f && "function" == typeof o ? X(Function.call, o) : o, f && ((h.virtual || (h.virtual = {}))[r] = o, e & le.R && p && !p[r] && ce(p, r, o))) }; le.F = 1, le.G = 2, le.S = 4, le.P = 8, le.B = 16, le.W = 32, le.U = 64, le.R = 128; var he = le, pe = ce, de = {}.hasOwnProperty, me = function (e, t) { return de.call(e, t) }, ye = {}, ge = {}.toString, ve = function (e) { return ge.call(e).slice(8, -1) }, be = Object("z").propertyIsEnumerable(0) ? Object : function (e) { return "String" == ve(e) ? e.split("") : Object(e) }, we = function (e) { return be(G(e)) }, _e = Math.min, Ee = function (e) { return e > 0 ? _e($(e), 9007199254740991) : 0 }, Te = Math.max, Se = Math.min, Ae = function (e, t) { return (e = $(e)) < 0 ? Te(e + t, 0) : Se(e, t) }, Ie = J["__core-js_shared__"] || (J["__core-js_shared__"] = {}), Ce = function (e) { return Ie[e] || (Ie[e] = {}) }, Oe = 0, xe = Math.random(), Me = function (e) { return "Symbol(".concat(void 0 === e ? "" : e, ")_", (++Oe + xe).toString(36)) }, Pe = Ce("keys"), Re = function (e) { return Pe[e] || (Pe[e] = Me(e)) }, Le = function (e) { return function (t, n, r) { var i, o = we(t), s = Ee(o.length), a = Ae(r, s); if (e && n != n) { for (; s > a;)if ((i = o[a++]) != i) return !0 } else for (; s > a; a++)if ((e || a in o) && o[a] === n) return e || a || 0; return !e && -1 } }(!1), ke = Re("IE_PROTO"), Ne = function (e, t) { var n, r = we(e), i = 0, o = []; for (n in r) n != ke && me(r, n) && o.push(n); for (; t.length > i;)me(r, n = t[i++]) && (~Le(o, n) || o.push(n)); return o }, je = "constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","), Fe = Object.keys || function (e) { return Ne(e, je) }, Ue = te ? Object.defineProperties : function (e, t) { Q(e); for (var n, r = Fe(t), i = r.length, o = 0; i > o;)ue.f(e, n = r[o++], t[n]); return e }, De = J.document, Be = De && De.documentElement, Ve = Re("IE_PROTO"), Ye = function () { }, ze = function () { var e, t = ie("iframe"), n = je.length; for (t.style.display = "none", Be.appendChild(t), t.src = "javascript:", (e = t.contentWindow.document).open(), e.write("<script>document.F=Object<\/script>"), e.close(), ze = e.F; n--;)delete ze.prototype[je[n]]; return ze() }, qe = Object.create || function (e, t) { var n; return null !== e ? (Ye.prototype = Q(e), n = new Ye, Ye.prototype = null, n[Ve] = e) : n = ze(), void 0 === t ? n : Ue(n, t) }, We = r(function (e) { var t = Ce("wks"), n = J.Symbol, r = "function" == typeof n; (e.exports = function (e) { return t[e] || (t[e] = r && n[e] || (r ? n : Me)("Symbol." + e)) }).store = t }), $e = ue.f, Ge = We("toStringTag"), Je = function (e, t, n) { e && !me(e = n ? e : e.prototype, Ge) && $e(e, Ge, { configurable: !0, value: t }) }, Ze = {}; ce(Ze, We("iterator"), function () { return this }); var He = function (e, t, n) { e.prototype = qe(Ze, { next: fe(1, n) }), Je(e, t + " Iterator") }, Xe = function (e) { return Object(G(e)) }, Ke = Re("IE_PROTO"), Qe = Object.prototype, et = Object.getPrototypeOf || function (e) { return e = Xe(e), me(e, Ke) ? e[Ke] : "function" == typeof e.constructor && e instanceof e.constructor ? e.constructor.prototype : e instanceof Object ? Qe : null }, tt = We("iterator"), nt = !([].keys && "next" in [].keys()), rt = function () { return this }, it = function (e, t, n, r, i, o, s) { He(n, t, r); var a, u, f, c = function (e) { if (!nt && e in d) return d[e]; switch (e) { case "keys": case "values": return function () { return new n(this, e) } }return function () { return new n(this, e) } }, l = t + " Iterator", h = "values" == i, p = !1, d = e.prototype, m = d[tt] || d["@@iterator"] || i && d[i], y = m || c(i), g = i ? h ? c("entries") : y : void 0, v = "Array" == t ? d.entries || m : m; if (v && (f = et(v.call(new e))) !== Object.prototype && f.next && Je(f, l, !0), h && m && "values" !== m.name && (p = !0, y = function () { return m.call(this) }), s && (nt || p || !d[tt]) && ce(d, tt, y), ye[t] = y, ye[l] = rt, i) if (a = { values: h ? y : c("values"), keys: o ? y : c("keys"), entries: g }, s) for (u in a) u in d || pe(d, u, a[u]); else he(he.P + he.F * (nt || p), t, a); return a }, ot = function (e) { return function (t, n) { var r, i, o = String(G(t)), s = $(n), a = o.length; return s < 0 || s >= a ? e ? "" : void 0 : (r = o.charCodeAt(s)) < 55296 || r > 56319 || s + 1 === a || (i = o.charCodeAt(s + 1)) < 56320 || i > 57343 ? e ? o.charAt(s) : r : e ? o.slice(s, s + 2) : i - 56320 + (r - 55296 << 10) + 65536 } }(!0); it(String, "String", function (e) { this._t = String(e), this._i = 0 }, function () { var e, t = this._t, n = this._i; return n >= t.length ? { value: void 0, done: !0 } : (e = ot(t, n), this._i += e.length, { value: e, done: !1 }) }); var st = function () { }, at = function (e, t) { return { value: t, done: !!e } }; it(Array, "Array", function (e, t) { this._t = we(e), this._i = 0, this._k = t }, function () { var e = this._t, t = this._k, n = this._i++; return !e || n >= e.length ? (this._t = void 0, at(1)) : "keys" == t ? at(0, n) : "values" == t ? at(0, e[n]) : at(0, [n, e[n]]) }, "values"); ye.Arguments = ye.Array, st(), st(), st(); for (var ut = We("toStringTag"), ft = "CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","), ct = 0; ct < ft.length; ct++) { var lt = ft[ct], ht = J[lt], pt = ht && ht.prototype; pt && !pt[ut] && ce(pt, ut, lt), ye[lt] = ye.Array } var dt, mt, yt, gt = We("toStringTag"), vt = "Arguments" == ve(function () { return arguments }()), bt = function (e, t) { try { return e[t] } catch (e) { } }, wt = function (e) { var t, n, r; return void 0 === e ? "Undefined" : null === e ? "Null" : "string" == typeof (n = bt(t = Object(e), gt)) ? n : vt ? ve(t) : "Object" == (r = ve(t)) && "function" == typeof t.callee ? "Arguments" : r }, _t = function (e, t, n, r) { if (!(e instanceof t) || void 0 !== r && r in e) throw TypeError(n + ": incorrect invocation!"); return e }, Et = function (e, t, n, r) { try { return r ? t(Q(n)[0], n[1]) : t(n) } catch (t) { var i = e.return; throw void 0 !== i && Q(i.call(e)), t } }, Tt = We("iterator"), St = Array.prototype, At = function (e) { return void 0 !== e && (ye.Array === e || St[Tt] === e) }, It = We("iterator"), Ct = Z.getIteratorMethod = function (e) { if (void 0 != e) return e[It] || e["@@iterator"] || ye[wt(e)] }, Ot = r(function (e) { var t = {}, n = {}, r = e.exports = function (e, r, i, o, s) { var a, u, f, c, l = s ? function () { return e } : Ct(e), h = X(i, o, r ? 2 : 1), p = 0; if ("function" != typeof l) throw TypeError(e + " is not iterable!"); if (At(l)) { for (a = Ee(e.length); a > p; p++)if ((c = r ? h(Q(u = e[p])[0], u[1]) : h(e[p])) === t || c === n) return c } else for (f = l.call(e); !(u = f.next()).done;)if ((c = Et(f, h, u.value, r)) === t || c === n) return c }; r.BREAK = t, r.RETURN = n }), xt = We("species"), Mt = function (e, t) { var n, r = Q(e).constructor; return void 0 === r || void 0 == (n = Q(r)[xt]) ? t : H(n) }, Pt = function (e, t, n) { var r = void 0 === n; switch (t.length) { case 0: return r ? e() : e.call(n); case 1: return r ? e(t[0]) : e.call(n, t[0]); case 2: return r ? e(t[0], t[1]) : e.call(n, t[0], t[1]); case 3: return r ? e(t[0], t[1], t[2]) : e.call(n, t[0], t[1], t[2]); case 4: return r ? e(t[0], t[1], t[2], t[3]) : e.call(n, t[0], t[1], t[2], t[3]) }return e.apply(n, t) }, Rt = J.process, Lt = J.setImmediate, kt = J.clearImmediate, Nt = J.MessageChannel, jt = J.Dispatch, Ft = 0, Ut = {}, Dt = function () { var e = +this; if (Ut.hasOwnProperty(e)) { var t = Ut[e]; delete Ut[e], t() } }, Bt = function (e) { Dt.call(e.data) }; Lt && kt || (Lt = function (e) { for (var t = [], n = 1; arguments.length > n;)t.push(arguments[n++]); return Ut[++Ft] = function () { Pt("function" == typeof e ? e : Function(e), t) }, dt(Ft), Ft }, kt = function (e) { delete Ut[e] }, "process" == ve(Rt) ? dt = function (e) { Rt.nextTick(X(Dt, e, 1)) } : jt && jt.now ? dt = function (e) { jt.now(X(Dt, e, 1)) } : Nt ? (yt = (mt = new Nt).port2, mt.port1.onmessage = Bt, dt = X(yt.postMessage, yt, 1)) : J.addEventListener && "function" == typeof postMessage && !J.importScripts ? (dt = function (e) { J.postMessage(e + "", "*") }, J.addEventListener("message", Bt, !1)) : dt = "onreadystatechange" in ie("script") ? function (e) { Be.appendChild(ie("script")).onreadystatechange = function () { Be.removeChild(this), Dt.call(e) } } : function (e) { setTimeout(X(Dt, e, 1), 0) }); var Vt = { set: Lt, clear: kt }, Yt = Vt.set, zt = J.MutationObserver || J.WebKitMutationObserver, qt = J.process, Wt = J.Promise, $t = "process" == ve(qt), Gt = { f: function (e) { return new i(e) } }, Jt = function (e) { try { return { e: !1, v: e() } } catch (e) { return { e: !0, v: e } } }, Zt = function (e, t) { if (Q(e), K(t) && t.constructor === e) return t; var n = Gt.f(e); return (0, n.resolve)(t), n.promise }, Ht = function (e, t, n) { for (var r in t) n && e[r] ? e[r] = t[r] : ce(e, r, t[r]); return e }, Xt = We("species"), Kt = function (e) { var t = "function" == typeof Z[e] ? Z[e] : J[e]; te && t && !t[Xt] && ue.f(t, Xt, { configurable: !0, get: function () { return this } }) }, Qt = We("iterator"), en = !1; try { var tn = [7][Qt](); tn.return = function () { en = !0 }, Array.from(tn, function () { throw 2 }) } catch (e) { } var nn, rn, on, sn, an = function (e, t) { if (!t && !en) return !1; var n = !1; try { var r = [7], i = r[Qt](); i.next = function () { return { done: n = !0 } }, r[Qt] = function () { return i }, e(r) } catch (e) { } return n }, un = Vt.set, fn = function () { var e, t, n, r = function () { var r, i; for ($t && (r = qt.domain) && r.exit(); e;) { i = e.fn, e = e.next; try { i() } catch (r) { throw e ? n() : t = void 0, r } } t = void 0, r && r.enter() }; if ($t) n = function () { qt.nextTick(r) }; else if (zt) { var i = !0, o = document.createTextNode(""); new zt(r).observe(o, { characterData: !0 }), n = function () { o.data = i = !i } } else if (Wt && Wt.resolve) { var s = Wt.resolve(); n = function () { s.then(r) } } else n = function () { Yt.call(J, r) }; return function (r) { var i = { fn: r, next: void 0 }; t && (t.next = i), e || (e = i, n()), t = i } }(), cn = J.TypeError, ln = J.process, hn = J.Promise, pn = "process" == wt(ln), dn = function () { }, mn = rn = Gt.f, yn = !!function () { try { var e = hn.resolve(1), t = (e.constructor = {})[We("species")] = function (e) { e(dn, dn) }; return (pn || "function" == typeof PromiseRejectionEvent) && e.then(dn) instanceof t } catch (e) { } }(), gn = function (e) { var t; return !(!K(e) || "function" != typeof (t = e.then)) && t }, vn = function (e, t) { if (!e._n) { e._n = !0; var n = e._c; fn(function () { for (var r = e._v, i = 1 == e._s, o = 0; n.length > o;)!function (t) { var n, o, s = i ? t.ok : t.fail, a = t.resolve, u = t.reject, f = t.domain; try { s ? (i || (2 == e._h && _n(e), e._h = 1), !0 === s ? n = r : (f && f.enter(), n = s(r), f && f.exit()), n === t.promise ? u(cn("Promise-chain cycle")) : (o = gn(n)) ? o.call(n, a, u) : a(n)) : u(r) } catch (e) { u(e) } }(n[o++]); e._c = [], e._n = !1, t && !e._h && bn(e) }) } }, bn = function (e) { un.call(J, function () { var t, n, r, i = e._v, o = wn(e); if (o && (t = Jt(function () { pn ? ln.emit("unhandledRejection", i, e) : (n = J.onunhandledrejection) ? n({ promise: e, reason: i }) : (r = J.console) && r.error && r.error("Unhandled promise rejection", i) }), e._h = pn || wn(e) ? 2 : 1), e._a = void 0, o && t.e) throw t.v }) }, wn = function (e) { if (1 == e._h) return !1; for (var t, n = e._a || e._c, r = 0; n.length > r;)if ((t = n[r++]).fail || !wn(t.promise)) return !1; return !0 }, _n = function (e) { un.call(J, function () { var t; pn ? ln.emit("rejectionHandled", e) : (t = J.onrejectionhandled) && t({ promise: e, reason: e._v }) }) }, En = function (e) { var t = this; t._d || (t._d = !0, (t = t._w || t)._v = e, t._s = 2, t._a || (t._a = t._c.slice()), vn(t, !0)) }, Tn = function (e) { var t, n = this; if (!n._d) { n._d = !0, n = n._w || n; try { if (n === e) throw cn("Promise can't be resolved itself"); (t = gn(e)) ? fn(function () { var r = { _w: n, _d: !1 }; try { t.call(e, X(Tn, r, 1), X(En, r, 1)) } catch (e) { En.call(r, e) } }) : (n._v = e, n._s = 1, vn(n, !1)) } catch (e) { En.call({ _w: n, _d: !1 }, e) } } }; yn || (hn = function (e) { _t(this, hn, "Promise", "_h"), H(e), nn.call(this); try { e(X(Tn, this, 1), X(En, this, 1)) } catch (e) { En.call(this, e) } }, (nn = function (e) { this._c = [], this._a = void 0, this._s = 0, this._d = !1, this._v = void 0, this._h = 0, this._n = !1 }).prototype = Ht(hn.prototype, { then: function (e, t) { var n = mn(Mt(this, hn)); return n.ok = "function" != typeof e || e, n.fail = "function" == typeof t && t, n.domain = pn ? ln.domain : void 0, this._c.push(n), this._a && this._a.push(n), this._s && vn(this, !1), n.promise }, catch: function (e) { return this.then(void 0, e) } }), on = function () { var e = new nn; this.promise = e, this.resolve = X(Tn, e, 1), this.reject = X(En, e, 1) }, Gt.f = mn = function (e) { return e === hn || e === sn ? new on(e) : rn(e) }), he(he.G + he.W + he.F * !yn, { Promise: hn }), Je(hn, "Promise"), Kt("Promise"), sn = Z.Promise, he(he.S + he.F * !yn, "Promise", { reject: function (e) { var t = mn(this); return (0, t.reject)(e), t.promise } }), he(he.S + !0 * he.F, "Promise", { resolve: function (e) { return Zt(this === sn ? hn : this, e) } }), he(he.S + he.F * !(yn && an(function (e) { hn.all(e).catch(dn) })), "Promise", { all: function (e) { var t = this, n = mn(t), r = n.resolve, i = n.reject, o = Jt(function () { var n = [], o = 0, s = 1; Ot(e, !1, function (e) { var a = o++, u = !1; n.push(void 0), s++ , t.resolve(e).then(function (e) { u || (u = !0, n[a] = e, --s || r(n)) }, i) }), --s || r(n) }); return o.e && i(o.v), n.promise }, race: function (e) { var t = this, n = mn(t), r = n.reject, i = Jt(function () { Ot(e, !1, function (e) { t.resolve(e).then(n.resolve, r) }) }); return i.e && r(i.v), n.promise } }), he(he.P + he.R, "Promise", { finally: function (e) { var t = Mt(this, Z.Promise || J.Promise), n = "function" == typeof e; return this.then(n ? function (n) { return Zt(t, e()).then(function () { return n }) } : e, n ? function (n) { return Zt(t, e()).then(function () { throw n }) } : e) } }), he(he.S, "Promise", { try: function (e) { var t = Gt.f(this), n = Jt(e); return (n.e ? t.reject : t.resolve)(n.v), t.promise } }); var Sn = Z.Promise, An = r(function (e) { e.exports = { default: Sn, __esModule: !0 } }), In = n(An), Cn = { f: We }, On = Cn.f("iterator"), xn = r(function (e) { e.exports = { default: On, __esModule: !0 } }); n(xn); var Mn = r(function (e) { var t = Me("meta"), n = ue.f, r = 0, i = Object.isExtensible || function () { return !0 }, o = !ee(function () { return i(Object.preventExtensions({})) }), s = function (e) { n(e, t, { value: { i: "O" + ++r, w: {} } }) }, a = e.exports = { KEY: t, NEED: !1, fastKey: function (e, n) { if (!K(e)) return "symbol" == typeof e ? e : ("string" == typeof e ? "S" : "P") + e; if (!me(e, t)) { if (!i(e)) return "F"; if (!n) return "E"; s(e) } return e[t].i }, getWeak: function (e, n) { if (!me(e, t)) { if (!i(e)) return !0; if (!n) return !1; s(e) } return e[t].w }, onFreeze: function (e) { return o && a.NEED && i(e) && !me(e, t) && s(e), e } } }), Pn = ue.f, Rn = function (e) { var t = Z.Symbol || (Z.Symbol = {}); "_" == e.charAt(0) || e in t || Pn(t, e, { value: Cn.f(e) }) }, Ln = { f: Object.getOwnPropertySymbols }, kn = { f: {}.propertyIsEnumerable }, Nn = function (e) { var t = Fe(e), n = Ln.f; if (n) for (var r, i = n(e), o = kn.f, s = 0; i.length > s;)o.call(e, r = i[s++]) && t.push(r); return t }, jn = Array.isArray || function (e) { return "Array" == ve(e) }, Fn = je.concat("length", "prototype"), Un = { f: Object.getOwnPropertyNames || function (e) { return Ne(e, Fn) } }, Dn = Un.f, Bn = {}.toString, Vn = "object" == typeof window && window && Object.getOwnPropertyNames ? Object.getOwnPropertyNames(window) : [], Yn = function (e) { try { return Dn(e) } catch (e) { return Vn.slice() } }, zn = { f: function (e) { return Vn && "[object Window]" == Bn.call(e) ? Yn(e) : Dn(we(e)) } }, qn = Object.getOwnPropertyDescriptor, Wn = { f: te ? qn : function (e, t) { if (e = we(e), t = se(t, !0), oe) try { return qn(e, t) } catch (e) { } if (me(e, t)) return fe(!kn.f.call(e, t), e[t]) } }, $n = Mn.KEY, Gn = Wn.f, Jn = ue.f, Zn = zn.f, Hn = J.Symbol, Xn = J.JSON, Kn = Xn && Xn.stringify, Qn = We("_hidden"), er = We("toPrimitive"), tr = {}.propertyIsEnumerable, nr = Ce("symbol-registry"), rr = Ce("symbols"), ir = Ce("op-symbols"), or = Object.prototype, sr = "function" == typeof Hn, ar = J.QObject, ur = !ar || !ar.prototype || !ar.prototype.findChild, fr = te && ee(function () { return 7 != qe(Jn({}, "a", { get: function () { return Jn(this, "a", { value: 7 }).a } })).a }) ? function (e, t, n) { var r = Gn(or, t); r && delete or[t], Jn(e, t, n), r && e !== or && Jn(or, t, r) } : Jn, cr = function (e) { var t = rr[e] = qe(Hn.prototype); return t._k = e, t }, lr = sr && "symbol" == typeof Hn.iterator ? function (e) { return "symbol" == typeof e } : function (e) { return e instanceof Hn }, hr = function (e, t, n) { return e === or && hr(ir, t, n), Q(e), t = se(t, !0), Q(n), me(rr, t) ? (n.enumerable ? (me(e, Qn) && e[Qn][t] && (e[Qn][t] = !1), n = qe(n, { enumerable: fe(0, !1) })) : (me(e, Qn) || Jn(e, Qn, fe(1, {})), e[Qn][t] = !0), fr(e, t, n)) : Jn(e, t, n) }, pr = function (e, t) { Q(e); for (var n, r = Nn(t = we(t)), i = 0, o = r.length; o > i;)hr(e, n = r[i++], t[n]); return e }, dr = function (e) { var t = tr.call(this, e = se(e, !0)); return !(this === or && me(rr, e) && !me(ir, e)) && (!(t || !me(this, e) || !me(rr, e) || me(this, Qn) && this[Qn][e]) || t) }, mr = function (e, t) { if (e = we(e), t = se(t, !0), e !== or || !me(rr, t) || me(ir, t)) { var n = Gn(e, t); return !n || !me(rr, t) || me(e, Qn) && e[Qn][t] || (n.enumerable = !0), n } }, yr = function (e) { for (var t, n = Zn(we(e)), r = [], i = 0; n.length > i;)me(rr, t = n[i++]) || t == Qn || t == $n || r.push(t); return r }, gr = function (e) { for (var t, n = e === or, r = Zn(n ? ir : we(e)), i = [], o = 0; r.length > o;)!me(rr, t = r[o++]) || n && !me(or, t) || i.push(rr[t]); return i }; sr || (pe((Hn = function () { if (this instanceof Hn) throw TypeError("Symbol is not a constructor!"); var e = Me(arguments.length > 0 ? arguments[0] : void 0), t = function (n) { this === or && t.call(ir, n), me(this, Qn) && me(this[Qn], e) && (this[Qn][e] = !1), fr(this, e, fe(1, n)) }; return te && ur && fr(or, e, { configurable: !0, set: t }), cr(e) }).prototype, "toString", function () { return this._k }), Wn.f = mr, ue.f = hr, Un.f = zn.f = yr, kn.f = dr, Ln.f = gr, Cn.f = function (e) { return cr(We(e)) }), he(he.G + he.W + he.F * !sr, { Symbol: Hn }); for (var vr = "hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","), br = 0; vr.length > br;)We(vr[br++]); for (var wr = Fe(We.store), _r = 0; wr.length > _r;)Rn(wr[_r++]); he(he.S + he.F * !sr, "Symbol", { for: function (e) { return me(nr, e += "") ? nr[e] : nr[e] = Hn(e) }, keyFor: function (e) { if (!lr(e)) throw TypeError(e + " is not a symbol!"); for (var t in nr) if (nr[t] === e) return t }, useSetter: function () { ur = !0 }, useSimple: function () { ur = !1 } }), he(he.S + he.F * !sr, "Object", { create: function (e, t) { return void 0 === t ? qe(e) : pr(qe(e), t) }, defineProperty: hr, defineProperties: pr, getOwnPropertyDescriptor: mr, getOwnPropertyNames: yr, getOwnPropertySymbols: gr }), Xn && he(he.S + he.F * (!sr || ee(function () { var e = Hn(); return "[null]" != Kn([e]) || "{}" != Kn({ a: e }) || "{}" != Kn(Object(e)) })), "JSON", { stringify: function (e) { if (void 0 !== e && !lr(e)) { for (var t, n, r = [e], i = 1; arguments.length > i;)r.push(arguments[i++]); return "function" == typeof (t = r[1]) && (n = t), !n && jn(t) || (t = function (e, t) { if (n && (t = n.call(this, e, t)), !lr(t)) return t }), r[1] = t, Kn.apply(Xn, r) } } }), Hn.prototype[er] || ce(Hn.prototype, er, Hn.prototype.valueOf), Je(Hn, "Symbol"), Je(Math, "Math", !0), Je(J.JSON, "JSON", !0), Rn("asyncIterator"), Rn("observable"); var Er = Z.Symbol, Tr = r(function (e) { e.exports = { default: Er, __esModule: !0 } }), Sr = n(Tr), Ar = r(function (e, t) { function n(e) { return e && e.__esModule ? e : { default: e } } t.__esModule = !0; var r = n(xn), i = n(Tr), o = "function" == typeof i.default && "symbol" == typeof r.default ? function (e) { return typeof e } : function (e) { return e && "function" == typeof i.default && e.constructor === i.default && e !== i.default.prototype ? "symbol" : typeof e }; t.default = "function" == typeof i.default && "symbol" === o(r.default) ? function (e) { return void 0 === e ? "undefined" : o(e) } : function (e) { return e && "function" == typeof i.default && e.constructor === i.default && e !== i.default.prototype ? "symbol" : void 0 === e ? "undefined" : o(e) } }), Ir = n(Ar), Cr = n(r(function (e, t) { t.__esModule = !0, t.default = function (e, t) { if (!(e instanceof t)) throw new TypeError("Cannot call a class as a function") } })), Or = new (function () { function e() { Cr(this, e) } return e.prototype.getItem = function (e) { return wx.getStorageSync(e) }, e.prototype.setItem = function (e, t) { return wx.setStorageSync(e, t) }, e.prototype.removeItem = function (e) { return this.setItem(e, "") }, e.prototype.clear = function () { return wx.clearStorageSync() }, e }()); he(he.S + he.F * !te, "Object", { defineProperty: ue.f }); var xr = Z.Object, Mr = function (e, t, n) { return xr.defineProperty(e, t, n) }, Pr = r(function (e) { e.exports = { default: Mr, __esModule: !0 } }), Rr = n(Pr), Lr = n(r(function (e, t) { t.__esModule = !0; var n = function (e) { return e && e.__esModule ? e : { default: e } }(Pr); t.default = function (e, t, r) { return t in e ? (0, n.default)(e, t, { value: r, enumerable: !0, configurable: !0, writable: !0 }) : e[t] = r, e } })), kr = n(r(function (e, t) { t.__esModule = !0; var n = function (e) { return e && e.__esModule ? e : { default: e } }(Ar); t.default = function (e, t) { if (!e) throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); return !t || "object" !== (void 0 === t ? "undefined" : (0, n.default)(t)) && "function" != typeof t ? e : t } })), Nr = function (e, t) { if (Q(e), !K(t) && null !== t) throw TypeError(t + ": can't set as prototype!") }, jr = { set: Object.setPrototypeOf || ("__proto__" in {} ? function (e, t, n) { try { (n = X(Function.call, Wn.f(Object.prototype, "__proto__").set, 2))(e, []), t = !(e instanceof Array) } catch (e) { t = !0 } return function (e, r) { return Nr(e, r), t ? e.__proto__ = r : n(e, r), e } }({}, !1) : void 0), check: Nr }; he(he.S, "Object", { setPrototypeOf: jr.set }); var Fr = Z.Object.setPrototypeOf, Ur = r(function (e) { e.exports = { default: Fr, __esModule: !0 } }); n(Ur), he(he.S, "Object", { create: qe }); var Dr = Z.Object, Br = function (e, t) { return Dr.create(e, t) }, Vr = r(function (e) { e.exports = { default: Br, __esModule: !0 } }); n(Vr); var Yr = n(r(function (e, t) { function n(e) { return e && e.__esModule ? e : { default: e } } t.__esModule = !0; var r = n(Ur), i = n(Vr), o = n(Ar); t.default = function (e, t) { if ("function" != typeof t && null !== t) throw new TypeError("Super expression must either be null or a function, not " + (void 0 === t ? "undefined" : (0, o.default)(t))); e.prototype = (0, i.default)(t && t.prototype, { constructor: { value: e, enumerable: !1, writable: !0, configurable: !0 } }), t && (r.default ? (0, r.default)(e, t) : e.__proto__ = t) } })), zr = Z.JSON || (Z.JSON = { stringify: JSON.stringify }), qr = function (e) { return zr.stringify.apply(zr, arguments) }, Wr = n(r(function (e) { e.exports = { default: qr, __esModule: !0 } })), $r = function (e, t) { var n = (Z.Object || {})[e] || Object[e], r = {}; r[e] = t(n), he(he.S + he.F * ee(function () { n(1) }), "Object", r) }; $r("keys", function () { return function (e) { return Fe(Xe(e)) } }); var Gr = Z.Object.keys, Jr = n(r(function (e) { e.exports = { default: Gr, __esModule: !0 } })), Zr = Object.getOwnPropertySymbols, Hr = Object.prototype.hasOwnProperty, Xr = Object.prototype.propertyIsEnumerable, Kr = function () { try { if (!Object.assign) return !1; var e = new String("abc"); if (e[5] = "de", "5" === Object.getOwnPropertyNames(e)[0]) return !1; for (var t = {}, n = 0; n < 10; n++)t["_" + String.fromCharCode(n)] = n; if ("0123456789" !== Object.getOwnPropertyNames(t).map(function (e) { return t[e] }).join("")) return !1; var r = {}; return "abcdefghijklmnopqrst".split("").forEach(function (e) { r[e] = e }), "abcdefghijklmnopqrst" === Object.keys(Object.assign({}, r)).join("") } catch (e) { return !1 } }() ? Object.assign : function (e, t) { for (var n, r, i = o(e), s = 1; s < arguments.length; s++) { n = Object(arguments[s]); for (var a in n) Hr.call(n, a) && (i[a] = n[a]); if (Zr) { r = Zr(n); for (var u = 0; u < r.length; u++)Xr.call(n, r[u]) && (i[r[u]] = n[r[u]]) } } return i }, Qr = r(function (e, t) { var n = t.createUniqueKey = "undefined" != typeof Symbol ? Symbol : function (e) { return "[[" + e + "_" + Math.random().toFixed(8).slice(2) + "]]" }; t.LISTENERS = n("listeners"), t.CAPTURE = 1, t.BUBBLE = 2, t.ATTRIBUTE = 3, t.newNode = function (e, t) { return { listener: e, kind: t, next: null } } }), ei = Qr.LISTENERS, ti = Qr.ATTRIBUTE, ni = Qr.newNode, ri = { defineCustomEventTarget: function (e, t) { function n() { e.call(this) } var r = { constructor: { value: n, configurable: !0, writable: !0 } }; return t.forEach(function (e) { r["on" + e] = { get: function () { return s(this, e) }, set: function (t) { a(this, e, t) }, configurable: !0, enumerable: !0 } }), n.prototype = Object.create(e.prototype, r), n } }, ii = Qr.createUniqueKey, oi = ii("stop_immediate_propagation_flag"), si = ii("canceled_flag"), ai = ii("original_event"), ui = Object.freeze({ stopPropagation: Object.freeze({ value: function () { var e = this[ai]; "function" == typeof e.stopPropagation && e.stopPropagation() }, writable: !0, configurable: !0 }), stopImmediatePropagation: Object.freeze({ value: function () { this[oi] = !0; var e = this[ai]; "function" == typeof e.stopImmediatePropagation && e.stopImmediatePropagation() }, writable: !0, configurable: !0 }), preventDefault: Object.freeze({ value: function () { !0 === this.cancelable && (this[si] = !0); var e = this[ai]; "function" == typeof e.preventDefault && e.preventDefault() }, writable: !0, configurable: !0 }), defaultPrevented: Object.freeze({ get: function () { return this[si] }, enumerable: !0, configurable: !0 }) }), fi = { STOP_IMMEDIATE_PROPAGATION_FLAG: oi, createEventWrapper: function (e, t) { var n = "number" == typeof e.timeStamp ? e.timeStamp : Date.now(), r = { type: { value: e.type, enumerable: !0 }, target: { value: t, enumerable: !0 }, currentTarget: { value: t, enumerable: !0 }, eventPhase: { value: 2, enumerable: !0 }, bubbles: { value: Boolean(e.bubbles), enumerable: !0 }, cancelable: { value: Boolean(e.cancelable), enumerable: !0 }, timeStamp: { value: n, enumerable: !0 }, isTrusted: { value: !1, enumerable: !0 } }; return r[oi] = { value: !1, writable: !0 }, r[si] = { value: !1, writable: !0 }, r[ai] = { value: e }, void 0 !== e.detail && (r.detail = { value: e.detail, enumerable: !0 }), Object.create(Object.create(e, ui), r) } }, ci = r(function (e) { var t = Qr.LISTENERS, n = Qr.CAPTURE, r = Qr.BUBBLE, i = Qr.ATTRIBUTE, o = Qr.newNode, s = ri.defineCustomEventTarget, a = fi.createEventWrapper, u = fi.STOP_IMMEDIATE_PROPAGATION_FLAG, f = "undefined" != typeof window && void 0 !== window.EventTarget, c = e.exports = function e() { if (!(this instanceof e)) { if (1 === arguments.length && Array.isArray(arguments[0])) return s(e, arguments[0]); if (arguments.length > 0) { for (var n = Array(arguments.length), r = 0; r < arguments.length; ++r)n[r] = arguments[r]; return s(e, n) } throw new TypeError("Cannot call a class as a function") } Object.defineProperty(this, t, { value: Object.create(null) }) }; c.prototype = Object.create((f ? window.EventTarget : Object).prototype, { constructor: { value: c, writable: !0, configurable: !0 }, addEventListener: { value: function (e, i, s) { if (null == i) return !1; if ("function" != typeof i && "object" != typeof i) throw new TypeError('"listener" is not an object.'); var a = s ? n : r, u = this[t][e]; if (null == u) return this[t][e] = o(i, a), !0; for (var f = null; null != u;) { if (u.listener === i && u.kind === a) return !1; f = u, u = u.next } return f.next = o(i, a), !0 }, configurable: !0, writable: !0 }, removeEventListener: { value: function (e, i, o) { if (null == i) return !1; for (var s = o ? n : r, a = null, u = this[t][e]; null != u;) { if (u.listener === i && u.kind === s) return null == a ? this[t][e] = u.next : a.next = u.next, !0; a = u, u = u.next } return !1 }, configurable: !0, writable: !0 }, dispatchEvent: { value: function (e) { var n = this[t][e.type]; if (null == n) return !0; for (var r = a(e, this); null != n && ("function" == typeof n.listener ? n.listener.call(this, r) : n.kind !== i && "function" == typeof n.listener.handleEvent && n.listener.handleEvent(r), !r[u]);)n = n.next; return !r.defaultPrevented }, configurable: !0, writable: !0 } }) }), li = function () { function e() { Cr(this, e), this._entries = [] } return e.prototype.append = function (e, t) { if ("string" != typeof e) throw new TypeError("FormData name must be a string"); if ("string" != typeof t && ("object" !== (void 0 === t ? "undefined" : Ir(t)) || "string" != typeof t.uri)) throw new TypeError("FormData value must be a string or { uri: tempFilePath }"); this._entries.push([e, t]) }, e.prototype.set = function (e, t) { var n = this.get(e); n ? n[1] = t : this.append(e, t) }, e.prototype.delete = function (e) { this._entries = this._entries.filter(function (t) { return t[0] !== e }) }, e.prototype.entries = function () { return this._entries }, e.prototype.get = function (e) { return this._entries.find(function (t) { return t[0] === e }) }, e.prototype.getAll = function (e) { return this._entries.filter(function (t) { return t[0] === e }) }, e.prototype.has = function (e) { return this._entries.some(function (t) { return t[0] === e }) }, e.prototype.keys = function () { return this._entries.map(function (e) { return e[0] }) }, e.prototype.values = function () { return this._entries.map(function (e) { return e[1] }) }, e }(), hi = 0, pi = 4, di = ["abort", "error", "load", "loadstart", "progress", "timeout", "loadend", "readystatechange"], mi = function (e) { function t() { return Cr(this, t), kr(this, e.apply(this, arguments)) } return Yr(t, e), t }(ci(["abort", "error", "load", "loadstart", "progress", "timeout", "loadend"])), yi = function (e) { function t() { Cr(this, t); var n = kr(this, e.call(this)); return n.readyState = hi, n._headers = {}, n.upload = new mi, n } return Yr(t, e), t.prototype.abort = function () { if (!this._request || this._request.abort) return this.status = 0, this.readyState = pi, this._request.abort(); throw new Error("该版本基础库不支持 abort request") }, t.prototype.getAllResponseHeaders = function () { var e = this; return this._responseHeaders ? Jr(this._responseHeaders).map(function (t) { return t + ": " + e._responseHeaders[t] }).join("\r\n") : "" }, t.prototype.getResponseHeader = function (e) { var t = e.toLowerCase(); return this._responseHeaders && this._responseHeaders[t] ? this._responseHeaders[t] : null }, t.prototype.overrideMimeType = function () { throw new Error("not supported in weapp") }, t.prototype.open = function (e, t) { var n = !(arguments.length > 2 && void 0 !== arguments[2]) || arguments[2]; if (this.readyState !== hi) throw new Error("request is already opened"); if (!n) throw new Error("sync request is not supported"); this._method = e, this._url = t, this.readyState = 1, this.dispatchEvent({ type: "readystatechange" }) }, t.prototype.setRequestHeader = function (e, t) { if (1 !== this.readyState) throw new Error("request is not opened"); this._headers[e.toLowerCase()] = t }, t.prototype.send = function (e) { var t = this; if (1 !== this.readyState) throw new Error("request is not opened"); if (e instanceof li) { var n = e.entries(), r = n.filter(function (e) { return "string" != typeof e[1] }); if (0 === r.length) throw new Error("Must specify a Blob field in FormData"); r.length > 1 && console.warn("Only the first Blob will be send in Weapp"); var i = n.filter(function (e) { return "string" == typeof e[1] }).reduce(function (e, t) { return Kr(e, Lr({}, t[0], t[1])) }, {}); this._request = wx.uploadFile({ url: this._url, name: r[0][0], filePath: r[0][1].uri, formData: i, header: this._headers, success: u.bind(this), fail: function (e) { t.status = 0, t.readyState = pi, t.dispatchEvent({ type: "readystatechange" }), t.dispatchEvent({ type: "error" }) } }), this._request && this._request.onProgressUpdate && this._request.onProgressUpdate(function (e) { var n = e.totalBytesSent, r = e.totalBytesExpectedToSend; t.upload.dispatchEvent({ type: "progress", loaded: n, total: r }) }) } else this._request = wx.request({ url: this._url, data: e || "", method: this._method.toUpperCase(), header: this._headers, success: u.bind(this), fail: function (e) { t.status = 0, t.readyState = pi, t.dispatchEvent({ type: "readystatechange" }), t.dispatchEvent({ type: "error" }) } }) }, t }(ci(di)); Kr(yi, { UNSENT: hi, OPENED: 1, HEADERS_RECEIVED: 2, LOADING: 3, DONE: pi }); var gi = yi, vi = n(r(function (e, t) { t.__esModule = !0; var n = function (e) { return e && e.__esModule ? e : { default: e } }(Pr); t.default = function () { function e(e, t) { for (var r = 0; r < t.length; r++) { var i = t[r]; i.enumerable = i.enumerable || !1, i.configurable = !0, "value" in i && (i.writable = !0), (0, n.default)(e, i.key, i) } } return function (t, n, r) { return n && e(t.prototype, n), r && e(t, r), t } }() })), bi = 0, wi = 1, _i = 3, Ei = void 0, Ti = function (e) { function t(n, r) { if (Cr(this, t), !n) throw new TypeError("Failed to construct 'WebSocket': url required"); if (r && (!wx.canIUse || !wx.canIUse("connectSocket.object.protocols"))) throw new Error("subprotocal not supported in weapp"); var i = kr(this, e.call(this)); return i._url = n, i._protocal = r || "", i._readyState = bi, Ei && Ei.dispatchEvent({ type: "close" }), Ei = i, wx.onSocketOpen(function (e) { Ei && (Ei._readyState = wi, Ei.dispatchEvent({ type: "open" })) }), wx.onSocketError(f), wx.onSocketMessage(function (e) { if (Ei) { var t = e.data, n = e.origin, r = e.ports, i = e.source; Ei.dispatchEvent({ data: t, origin: n, ports: r, source: i, type: "message" }) } }), wx.onSocketClose(function (e) { if (Ei) { Ei._readyState = _i; var t = e.code, n = e.reason, r = e.wasClean; Ei.dispatchEvent({ code: t, reason: n, wasClean: r, type: "close" }), Ei = null } }), wx.connectSocket({ url: n, protocals: i._protocal, fail: function (e) { return setTimeout(function () { return f(e) }, 0) } }), i } return Yr(t, e), t.prototype.close = function () { this.readyState === bi && console.warn("close WebSocket which is connecting might not work"), wx.closeSocket() }, t.prototype.send = function (e) { if (this.readyState !== wi) throw new Error("INVALID_STATE_ERR"); if (!("string" == typeof e || e instanceof ArrayBuffer)) throw new TypeError("only String/ArrayBuffer supported"); wx.sendSocketMessage({ data: e }) }, vi(t, [{ key: "url", get: function () { return this._url } }, { key: "protocal", get: function () { return this._protocal } }, { key: "readyState", get: function () { return this._readyState } }]), t }(ci(["open", "error", "message", "close"])); Kr(Ti, { CONNECTING: bi, OPEN: wi, CLOSING: 2, CLOSED: _i }); var Si = Ti, Ai = r(function (e, t) { t.polyfill = function (e) { if (wx.onNetworkStatusChange && !e.__onlineOfflinePolyfilled) { e.__onlineOfflinePolyfilled = !0; var t = new ci; e.dispatchEvent || (e.addEventListener = t.addEventListener.bind(t), e.removeEventListener = t.removeEventListener.bind(t), e.dispatchEvent = t.dispatchEvent.bind(t)), wx.getNetworkType({ success: function (t) { var n = t.networkType; e.onLine = "none" !== n, wx.onNetworkStatusChange(function (t) { var n = t.isConnected; e.onLine !== n && (e.onLine = n, e.dispatchEvent({ type: n ? "online" : "offline" })) }) } }) } } }), Ii = {}, Ci = { polyfill: function () { var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : z || window; if ("object" !== (void 0 === e ? "undefined" : Ir(e))) throw new Error("polyfill target is not an Object"); var t = { localStorage: Or, XMLHttpRequest: gi, FormData: li, WebSocket: Si, Object: Object, navigator: Ii }; for (var n in t) e[n] || (e[n] = t[n]); Ai.polyfill(e) }, localStorage: Or, XMLHttpRequest: gi, FormData: li, WebSocket: Si }.polyfill; window = window || {}, Ci(), Ci(window); try { localStorage = localStorage || Or } catch (e) { } try { XMLHttpRequest = XMLHttpRequest || gi } catch (e) { } try { FormData = FormData || li } catch (e) { } try { WebSocket = WebSocket || Si } catch (e) { } try { navigator = navigator || Ii } catch (e) { } var Oi = r(function (e) { !function (n, r) { "function" == typeof t && e && e.exports ? e.exports = r() : (n.dcodeIO = n.dcodeIO || {}).Long = r() }(z, function () { function e(e, t, n) { this.low = 0 | e, this.high = 0 | t, this.unsigned = !!n } function t(e) { return !0 === (e && e.__isLong__) } function n(e, t) { var n, r, o; return t ? (e >>>= 0, (o = 0 <= e && e < 256) && (r = u[e]) ? r : (n = i(e, (0 | e) < 0 ? -1 : 0, !0), o && (u[e] = n), n)) : (e |= 0, (o = -128 <= e && e < 128) && (r = a[e]) ? r : (n = i(e, e < 0 ? -1 : 0, !1), o && (a[e] = n), n)) } function r(e, t) { if (isNaN(e) || !isFinite(e)) return t ? m : d; if (t) { if (e < 0) return m; if (e >= l) return w } else { if (e <= -h) return _; if (e + 1 >= h) return b } return e < 0 ? r(-e, t).neg() : i(e % c | 0, e / c | 0, t) } function i(t, n, r) { return new e(t, n, r) } function o(e, t, n) { if (0 === e.length) throw Error("empty string"); if ("NaN" === e || "Infinity" === e || "+Infinity" === e || "-Infinity" === e) return d; if ("number" == typeof t ? (n = t, t = !1) : t = !!t, (n = n || 10) < 2 || 36 < n) throw RangeError("radix"); var i; if ((i = e.indexOf("-")) > 0) throw Error("interior hyphen"); if (0 === i) return o(e.substring(1), t, n).neg(); for (var s = r(f(n, 8)), a = d, u = 0; u < e.length; u += 8) { var c = Math.min(8, e.length - u), l = parseInt(e.substring(u, u + c), n); if (c < 8) { var h = r(f(n, c)); a = a.mul(h).add(r(l)) } else a = (a = a.mul(s)).add(r(l)) } return a.unsigned = t, a } function s(t) { return t instanceof e ? t : "number" == typeof t ? r(t) : "string" == typeof t ? o(t) : i(t.low, t.high, t.unsigned) } e.prototype.__isLong__, Object.defineProperty(e.prototype, "__isLong__", { value: !0, enumerable: !1, configurable: !1 }), e.isLong = t; var a = {}, u = {}; e.fromInt = n, e.fromNumber = r, e.fromBits = i; var f = Math.pow; e.fromString = o, e.fromValue = s; var c = 4294967296, l = c * c, h = l / 2, p = n(1 << 24), d = n(0); e.ZERO = d; var m = n(0, !0); e.UZERO = m; var y = n(1); e.ONE = y; var g = n(1, !0); e.UONE = g; var v = n(-1); e.NEG_ONE = v; var b = i(-1, 2147483647, !1); e.MAX_VALUE = b; var w = i(-1, -1, !0); e.MAX_UNSIGNED_VALUE = w; var _ = i(0, -2147483648, !1); e.MIN_VALUE = _; var E = e.prototype; return E.toInt = function () { return this.unsigned ? this.low >>> 0 : this.low }, E.toNumber = function () { return this.unsigned ? (this.high >>> 0) * c + (this.low >>> 0) : this.high * c + (this.low >>> 0) }, E.toString = function (e) { if ((e = e || 10) < 2 || 36 < e) throw RangeError("radix"); if (this.isZero()) return "0"; if (this.isNegative()) { if (this.eq(_)) { var t = r(e), n = this.div(t), i = n.mul(t).sub(this); return n.toString(e) + i.toInt().toString(e) } return "-" + this.neg().toString(e) } for (var o = r(f(e, 6), this.unsigned), s = this, a = ""; ;) { var u = s.div(o), c = (s.sub(u.mul(o)).toInt() >>> 0).toString(e); if ((s = u).isZero()) return c + a; for (; c.length < 6;)c = "0" + c; a = "" + c + a } }, E.getHighBits = function () { return this.high }, E.getHighBitsUnsigned = function () { return this.high >>> 0 }, E.getLowBits = function () { return this.low }, E.getLowBitsUnsigned = function () { return this.low >>> 0 }, E.getNumBitsAbs = function () { if (this.isNegative()) return this.eq(_) ? 64 : this.neg().getNumBitsAbs(); for (var e = 0 != this.high ? this.high : this.low, t = 31; t > 0 && 0 == (e & 1 << t); t--); return 0 != this.high ? t + 33 : t + 1 }, E.isZero = function () { return 0 === this.high && 0 === this.low }, E.isNegative = function () { return !this.unsigned && this.high < 0 }, E.isPositive = function () { return this.unsigned || this.high >= 0 }, E.isOdd = function () { return 1 == (1 & this.low) }, E.isEven = function () { return 0 == (1 & this.low) }, E.equals = function (e) { return t(e) || (e = s(e)), (this.unsigned === e.unsigned || this.high >>> 31 != 1 || e.high >>> 31 != 1) && (this.high === e.high && this.low === e.low) }, E.eq = E.equals, E.notEquals = function (e) { return !this.eq(e) }, E.neq = E.notEquals, E.lessThan = function (e) { return this.comp(e) < 0 }, E.lt = E.lessThan, E.lessThanOrEqual = function (e) { return this.comp(e) <= 0 }, E.lte = E.lessThanOrEqual, E.greaterThan = function (e) { return this.comp(e) > 0 }, E.gt = E.greaterThan, E.greaterThanOrEqual = function (e) { return this.comp(e) >= 0 }, E.gte = E.greaterThanOrEqual, E.compare = function (e) { if (t(e) || (e = s(e)), this.eq(e)) return 0; var n = this.isNegative(), r = e.isNegative(); return n && !r ? -1 : !n && r ? 1 : this.unsigned ? e.high >>> 0 > this.high >>> 0 || e.high === this.high && e.low >>> 0 > this.low >>> 0 ? -1 : 1 : this.sub(e).isNegative() ? -1 : 1 }, E.comp = E.compare, E.negate = function () { return !this.unsigned && this.eq(_) ? _ : this.not().add(y) }, E.neg = E.negate, E.add = function (e) { t(e) || (e = s(e)); var n = this.high >>> 16, r = 65535 & this.high, o = this.low >>> 16, a = 65535 & this.low, u = e.high >>> 16, f = 65535 & e.high, c = e.low >>> 16, l = 0, h = 0, p = 0, d = 0; return d += a + (65535 & e.low), p += d >>> 16, d &= 65535, p += o + c, h += p >>> 16, p &= 65535, h += r + f, l += h >>> 16, h &= 65535, l += n + u, l &= 65535, i(p << 16 | d, l << 16 | h, this.unsigned) }, E.subtract = function (e) { return t(e) || (e = s(e)), this.add(e.neg()) }, E.sub = E.subtract, E.multiply = function (e) { if (this.isZero()) return d; if (t(e) || (e = s(e)), e.isZero()) return d; if (this.eq(_)) return e.isOdd() ? _ : d; if (e.eq(_)) return this.isOdd() ? _ : d; if (this.isNegative()) return e.isNegative() ? this.neg().mul(e.neg()) : this.neg().mul(e).neg(); if (e.isNegative()) return this.mul(e.neg()).neg(); if (this.lt(p) && e.lt(p)) return r(this.toNumber() * e.toNumber(), this.unsigned); var n = this.high >>> 16, o = 65535 & this.high, a = this.low >>> 16, u = 65535 & this.low, f = e.high >>> 16, c = 65535 & e.high, l = e.low >>> 16, h = 65535 & e.low, m = 0, y = 0, g = 0, v = 0; return v += u * h, g += v >>> 16, v &= 65535, g += a * h, y += g >>> 16, g &= 65535, g += u * l, y += g >>> 16, g &= 65535, y += o * h, m += y >>> 16, y &= 65535, y += a * l, m += y >>> 16, y &= 65535, y += u * c, m += y >>> 16, y &= 65535, m += n * h + o * l + a * c + u * f, m &= 65535, i(g << 16 | v, m << 16 | y, this.unsigned) }, E.mul = E.multiply, E.divide = function (e) { if (t(e) || (e = s(e)), e.isZero()) throw Error("division by zero"); if (this.isZero()) return this.unsigned ? m : d; var n, i, o; if (this.unsigned) { if (e.unsigned || (e = e.toUnsigned()), e.gt(this)) return m; if (e.gt(this.shru(1))) return g; o = m } else { if (this.eq(_)) return e.eq(y) || e.eq(v) ? _ : e.eq(_) ? y : (n = this.shr(1).div(e).shl(1)).eq(d) ? e.isNegative() ? y : v : (i = this.sub(e.mul(n)), o = n.add(i.div(e))); if (e.eq(_)) return this.unsigned ? m : d; if (this.isNegative()) return e.isNegative() ? this.neg().div(e.neg()) : this.neg().div(e).neg(); if (e.isNegative()) return this.div(e.neg()).neg(); o = d } for (i = this; i.gte(e);) { n = Math.max(1, Math.floor(i.toNumber() / e.toNumber())); for (var a = Math.ceil(Math.log(n) / Math.LN2), u = a <= 48 ? 1 : f(2, a - 48), c = r(n), l = c.mul(e); l.isNegative() || l.gt(i);)l = (c = r(n -= u, this.unsigned)).mul(e); c.isZero() && (c = y), o = o.add(c), i = i.sub(l) } return o }, E.div = E.divide, E.modulo = function (e) { return t(e) || (e = s(e)), this.sub(this.div(e).mul(e)) }, E.mod = E.modulo, E.not = function () { return i(~this.low, ~this.high, this.unsigned) }, E.and = function (e) { return t(e) || (e = s(e)), i(this.low & e.low, this.high & e.high, this.unsigned) }, E.or = function (e) { return t(e) || (e = s(e)), i(this.low | e.low, this.high | e.high, this.unsigned) }, E.xor = function (e) { return t(e) || (e = s(e)), i(this.low ^ e.low, this.high ^ e.high, this.unsigned) }, E.shiftLeft = function (e) { return t(e) && (e = e.toInt()), 0 == (e &= 63) ? this : e < 32 ? i(this.low << e, this.high << e | this.low >>> 32 - e, this.unsigned) : i(0, this.low << e - 32, this.unsigned) }, E.shl = E.shiftLeft, E.shiftRight = function (e) { return t(e) && (e = e.toInt()), 0 == (e &= 63) ? this : e < 32 ? i(this.low >>> e | this.high << 32 - e, this.high >> e, this.unsigned) : i(this.high >> e - 32, this.high >= 0 ? 0 : -1, this.unsigned) }, E.shr = E.shiftRight, E.shiftRightUnsigned = function (e) { if (t(e) && (e = e.toInt()), 0 === (e &= 63)) return this; var n = this.high; return e < 32 ? i(this.low >>> e | n << 32 - e, n >>> e, this.unsigned) : 32 === e ? i(n, 0, this.unsigned) : i(n >>> e - 32, 0, this.unsigned) }, E.shru = E.shiftRightUnsigned, E.toSigned = function () { return this.unsigned ? i(this.low, this.high, !1) : this }, E.toUnsigned = function () { return this.unsigned ? this : i(this.low, this.high, !0) }, E.toBytes = function (e) { return e ? this.toBytesLE() : this.toBytesBE() }, E.toBytesLE = function () { var e = this.high, t = this.low; return [255 & t, t >>> 8 & 255, t >>> 16 & 255, t >>> 24 & 255, 255 & e, e >>> 8 & 255, e >>> 16 & 255, e >>> 24 & 255] }, E.toBytesBE = function () { var e = this.high, t = this.low; return [e >>> 24 & 255, e >>> 16 & 255, e >>> 8 & 255, 255 & e, t >>> 24 & 255, t >>> 16 & 255, t >>> 8 & 255, 255 & t] }, e }) }), xi = r(function (e) { !function (n, r) { "function" == typeof t && e && e.exports ? e.exports = function () { var e; try { e = Oi } catch (e) { } return r(e) }() : (n.dcodeIO = n.dcodeIO || {}).ByteBuffer = r(n.dcodeIO.Long) }(z, function (e) { function t(e) { var t = 0; return function () { return t < e.length ? e.charCodeAt(t++) : null } } function n() { var e = [], t = []; return function () { if (0 === arguments.length) return t.join("") + u.apply(String, e); e.length + arguments.length > 1024 && (t.push(u.apply(String, e)), e.length = 0), Array.prototype.push.apply(e, arguments) } } function r(e, t, n, r, i) { var o, s, a = 8 * i - r - 1, u = (1 << a) - 1, f = u >> 1, c = -7, l = n ? i - 1 : 0, h = n ? -1 : 1, p = e[t + l]; for (l += h, o = p & (1 << -c) - 1, p >>= -c, c += a; c > 0; o = 256 * o + e[t + l], l += h, c -= 8); for (s = o & (1 << -c) - 1, o >>= -c, c += r; c > 0; s = 256 * s + e[t + l], l += h, c -= 8); if (0 === o) o = 1 - f; else { if (o === u) return s ? NaN : 1 / 0 * (p ? -1 : 1); s += Math.pow(2, r), o -= f } return (p ? -1 : 1) * s * Math.pow(2, o - r) } function i(e, t, n, r, i, o) { var s, a, u, f = 8 * o - i - 1, c = (1 << f) - 1, l = c >> 1, h = 23 === i ? Math.pow(2, -24) - Math.pow(2, -77) : 0, p = r ? 0 : o - 1, d = r ? 1 : -1, m = t < 0 || 0 === t && 1 / t < 0 ? 1 : 0; for (t = Math.abs(t), isNaN(t) || t === 1 / 0 ? (a = isNaN(t) ? 1 : 0, s = c) : (s = Math.floor(Math.log(t) / Math.LN2), t * (u = Math.pow(2, -s)) < 1 && (s-- , u *= 2), (t += s + l >= 1 ? h / u : h * Math.pow(2, 1 - l)) * u >= 2 && (s++ , u /= 2), s + l >= c ? (a = 0, s = c) : s + l >= 1 ? (a = (t * u - 1) * Math.pow(2, i), s += l) : (a = t * Math.pow(2, l - 1) * Math.pow(2, i), s = 0)); i >= 8; e[n + p] = 255 & a, p += d, a /= 256, i -= 8); for (s = s << i | a, f += i; f > 0; e[n + p] = 255 & s, p += d, s /= 256, f -= 8); e[n + p - d] |= 128 * m } var o = function (e, t, n) { if (void 0 === e && (e = o.DEFAULT_CAPACITY), void 0 === t && (t = o.DEFAULT_ENDIAN), void 0 === n && (n = o.DEFAULT_NOASSERT), !n) { if ((e |= 0) < 0) throw RangeError("Illegal capacity"); t = !!t, n = !!n } this.buffer = 0 === e ? a : new ArrayBuffer(e), this.view = 0 === e ? null : new Uint8Array(this.buffer), this.offset = 0, this.markedOffset = -1, this.limit = e, this.littleEndian = t, this.noAssert = n }; o.VERSION = "5.0.1", o.LITTLE_ENDIAN = !0, o.BIG_ENDIAN = !1, o.DEFAULT_CAPACITY = 16, o.DEFAULT_ENDIAN = o.BIG_ENDIAN, o.DEFAULT_NOASSERT = !1, o.Long = e || null; var s = o.prototype; s.__isByteBuffer__, Object.defineProperty(s, "__isByteBuffer__", { value: !0, enumerable: !1, configurable: !1 }); var a = new ArrayBuffer(0), u = String.fromCharCode; o.accessor = function () { return Uint8Array }, o.allocate = function (e, t, n) { return new o(e, t, n) }, o.concat = function (e, t, n, r) { "boolean" != typeof t && "string" == typeof t || (r = n, n = t, t = void 0); for (var i, s = 0, a = 0, u = e.length; a < u; ++a)o.isByteBuffer(e[a]) || (e[a] = o.wrap(e[a], t)), (i = e[a].limit - e[a].offset) > 0 && (s += i); if (0 === s) return new o(0, n, r); var f, c = new o(s, n, r); for (a = 0; a < u;)(i = (f = e[a++]).limit - f.offset) <= 0 || (c.view.set(f.view.subarray(f.offset, f.limit), c.offset), c.offset += i); return c.limit = c.offset, c.offset = 0, c }, o.isByteBuffer = function (e) { return !0 === (e && e.__isByteBuffer__) }, o.type = function () { return ArrayBuffer }, o.wrap = function (e, t, n, r) { if ("string" != typeof t && (r = n, n = t, t = void 0), "string" == typeof e) switch (void 0 === t && (t = "utf8"), t) { case "base64": return o.fromBase64(e, n); case "hex": return o.fromHex(e, n); case "binary": return o.fromBinary(e, n); case "utf8": return o.fromUTF8(e, n); case "debug": return o.fromDebug(e, n); default: throw Error("Unsupported encoding: " + t) }if (null === e || "object" != typeof e) throw TypeError("Illegal buffer"); var i; if (o.isByteBuffer(e)) return i = s.clone.call(e), i.markedOffset = -1, i; if (e instanceof Uint8Array) i = new o(0, n, r), e.length > 0 && (i.buffer = e.buffer, i.offset = e.byteOffset, i.limit = e.byteOffset + e.byteLength, i.view = new Uint8Array(e.buffer)); else if (e instanceof ArrayBuffer) i = new o(0, n, r), e.byteLength > 0 && (i.buffer = e, i.offset = 0, i.limit = e.byteLength, i.view = e.byteLength > 0 ? new Uint8Array(e) : null); else { if ("[object Array]" !== Object.prototype.toString.call(e)) throw TypeError("Illegal buffer"); (i = new o(e.length, n, r)).limit = e.length; for (var a = 0; a < e.length; ++a)i.view[a] = e[a] } return i }, s.writeBitSet = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if (!(e instanceof Array)) throw TypeError("Illegal BitSet: Not an array"); if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } var r, i = t, o = e.length, s = o >> 3, a = 0; for (t += this.writeVarint32(o, t); s--;)r = 1 & !!e[a++] | (1 & !!e[a++]) << 1 | (1 & !!e[a++]) << 2 | (1 & !!e[a++]) << 3 | (1 & !!e[a++]) << 4 | (1 & !!e[a++]) << 5 | (1 & !!e[a++]) << 6 | (1 & !!e[a++]) << 7, this.writeByte(r, t++); if (a < o) { var u = 0; for (r = 0; a < o;)r |= (1 & !!e[a++]) << u++; this.writeByte(r, t++) } return n ? (this.offset = t, this) : t - i }, s.readBitSet = function (e) { var t = void 0 === e; t && (e = this.offset); var n, r = this.readVarint32(e), i = r.value, o = i >> 3, s = 0, a = []; for (e += r.length; o--;)n = this.readByte(e++), a[s++] = !!(1 & n), a[s++] = !!(2 & n), a[s++] = !!(4 & n), a[s++] = !!(8 & n), a[s++] = !!(16 & n), a[s++] = !!(32 & n), a[s++] = !!(64 & n), a[s++] = !!(128 & n); if (s < i) { var u = 0; for (n = this.readByte(e++); s < i;)a[s++] = !!(n >> u++ & 1) } return t && (this.offset = e), a }, s.readBytes = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + e > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+" + e + ") <= " + this.buffer.byteLength) } var r = this.slice(t, t + e); return n && (this.offset += e), r }, s.writeBytes = s.append, s.writeInt8 = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal value: " + e + " (not an integer)"); if (e |= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } t += 1; var r = this.buffer.byteLength; return t > r && this.resize((r *= 2) > t ? r : t), t -= 1, this.view[t] = e, n && (this.offset += 1), this }, s.writeByte = s.writeInt8, s.readInt8 = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength) } var n = this.view[e]; return 128 == (128 & n) && (n = -(255 - n + 1)), t && (this.offset += 1), n }, s.readByte = s.readInt8, s.writeUint8 = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal value: " + e + " (not an integer)"); if (e >>>= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } t += 1; var r = this.buffer.byteLength; return t > r && this.resize((r *= 2) > t ? r : t), t -= 1, this.view[t] = e, n && (this.offset += 1), this }, s.writeUInt8 = s.writeUint8, s.readUint8 = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength) } var n = this.view[e]; return t && (this.offset += 1), n }, s.readUInt8 = s.readUint8, s.writeInt16 = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal value: " + e + " (not an integer)"); if (e |= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } t += 2; var r = this.buffer.byteLength; return t > r && this.resize((r *= 2) > t ? r : t), t -= 2, this.littleEndian ? (this.view[t + 1] = (65280 & e) >>> 8, this.view[t] = 255 & e) : (this.view[t] = (65280 & e) >>> 8, this.view[t + 1] = 255 & e), n && (this.offset += 2), this }, s.writeShort = s.writeInt16, s.readInt16 = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 2 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+2) <= " + this.buffer.byteLength) } var n = 0; return this.littleEndian ? (n = this.view[e], n |= this.view[e + 1] << 8) : (n = this.view[e] << 8, n |= this.view[e + 1]), 32768 == (32768 & n) && (n = -(65535 - n + 1)), t && (this.offset += 2), n }, s.readShort = s.readInt16, s.writeUint16 = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal value: " + e + " (not an integer)"); if (e >>>= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } t += 2; var r = this.buffer.byteLength; return t > r && this.resize((r *= 2) > t ? r : t), t -= 2, this.littleEndian ? (this.view[t + 1] = (65280 & e) >>> 8, this.view[t] = 255 & e) : (this.view[t] = (65280 & e) >>> 8, this.view[t + 1] = 255 & e), n && (this.offset += 2), this }, s.writeUInt16 = s.writeUint16, s.readUint16 = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 2 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+2) <= " + this.buffer.byteLength) } var n = 0; return this.littleEndian ? (n = this.view[e], n |= this.view[e + 1] << 8) : (n = this.view[e] << 8, n |= this.view[e + 1]), t && (this.offset += 2), n }, s.readUInt16 = s.readUint16, s.writeInt32 = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal value: " + e + " (not an integer)"); if (e |= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } t += 4; var r = this.buffer.byteLength; return t > r && this.resize((r *= 2) > t ? r : t), t -= 4, this.littleEndian ? (this.view[t + 3] = e >>> 24 & 255, this.view[t + 2] = e >>> 16 & 255, this.view[t + 1] = e >>> 8 & 255, this.view[t] = 255 & e) : (this.view[t] = e >>> 24 & 255, this.view[t + 1] = e >>> 16 & 255, this.view[t + 2] = e >>> 8 & 255, this.view[t + 3] = 255 & e), n && (this.offset += 4), this }, s.writeInt = s.writeInt32, s.readInt32 = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 4 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength) } var n = 0; return this.littleEndian ? (n = this.view[e + 2] << 16, n |= this.view[e + 1] << 8, n |= this.view[e], n += this.view[e + 3] << 24 >>> 0) : (n = this.view[e + 1] << 16, n |= this.view[e + 2] << 8, n |= this.view[e + 3], n += this.view[e] << 24 >>> 0), n |= 0, t && (this.offset += 4), n }, s.readInt = s.readInt32, s.writeUint32 = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal value: " + e + " (not an integer)"); if (e >>>= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } t += 4; var r = this.buffer.byteLength; return t > r && this.resize((r *= 2) > t ? r : t), t -= 4, this.littleEndian ? (this.view[t + 3] = e >>> 24 & 255, this.view[t + 2] = e >>> 16 & 255, this.view[t + 1] = e >>> 8 & 255, this.view[t] = 255 & e) : (this.view[t] = e >>> 24 & 255, this.view[t + 1] = e >>> 16 & 255, this.view[t + 2] = e >>> 8 & 255, this.view[t + 3] = 255 & e), n && (this.offset += 4), this }, s.writeUInt32 = s.writeUint32, s.readUint32 = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 4 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength) } var n = 0; return this.littleEndian ? (n = this.view[e + 2] << 16, n |= this.view[e + 1] << 8, n |= this.view[e], n += this.view[e + 3] << 24 >>> 0) : (n = this.view[e + 1] << 16, n |= this.view[e + 2] << 8, n |= this.view[e + 3], n += this.view[e] << 24 >>> 0), t && (this.offset += 4), n }, s.readUInt32 = s.readUint32, e && (s.writeInt64 = function (t, n) { var r = void 0 === n; if (r && (n = this.offset), !this.noAssert) { if ("number" == typeof t) t = e.fromNumber(t); else if ("string" == typeof t) t = e.fromString(t); else if (!(t && t instanceof e)) throw TypeError("Illegal value: " + t + " (not an integer or Long)"); if ("number" != typeof n || n % 1 != 0) throw TypeError("Illegal offset: " + n + " (not an integer)"); if ((n >>>= 0) < 0 || n + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength) } "number" == typeof t ? t = e.fromNumber(t) : "string" == typeof t && (t = e.fromString(t)), n += 8; var i = this.buffer.byteLength; n > i && this.resize((i *= 2) > n ? i : n), n -= 8; var o = t.low, s = t.high; return this.littleEndian ? (this.view[n + 3] = o >>> 24 & 255, this.view[n + 2] = o >>> 16 & 255, this.view[n + 1] = o >>> 8 & 255, this.view[n] = 255 & o, n += 4, this.view[n + 3] = s >>> 24 & 255, this.view[n + 2] = s >>> 16 & 255, this.view[n + 1] = s >>> 8 & 255, this.view[n] = 255 & s) : (this.view[n] = s >>> 24 & 255, this.view[n + 1] = s >>> 16 & 255, this.view[n + 2] = s >>> 8 & 255, this.view[n + 3] = 255 & s, n += 4, this.view[n] = o >>> 24 & 255, this.view[n + 1] = o >>> 16 & 255, this.view[n + 2] = o >>> 8 & 255, this.view[n + 3] = 255 & o), r && (this.offset += 8), this }, s.writeLong = s.writeInt64, s.readInt64 = function (t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 8 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+8) <= " + this.buffer.byteLength) } var r = 0, i = 0; this.littleEndian ? (r = this.view[t + 2] << 16, r |= this.view[t + 1] << 8, r |= this.view[t], r += this.view[t + 3] << 24 >>> 0, t += 4, i = this.view[t + 2] << 16, i |= this.view[t + 1] << 8, i |= this.view[t], i += this.view[t + 3] << 24 >>> 0) : (i = this.view[t + 1] << 16, i |= this.view[t + 2] << 8, i |= this.view[t + 3], i += this.view[t] << 24 >>> 0, t += 4, r = this.view[t + 1] << 16, r |= this.view[t + 2] << 8, r |= this.view[t + 3], r += this.view[t] << 24 >>> 0); var o = new e(r, i, !1); return n && (this.offset += 8), o }, s.readLong = s.readInt64, s.writeUint64 = function (t, n) { var r = void 0 === n; if (r && (n = this.offset), !this.noAssert) { if ("number" == typeof t) t = e.fromNumber(t); else if ("string" == typeof t) t = e.fromString(t); else if (!(t && t instanceof e)) throw TypeError("Illegal value: " + t + " (not an integer or Long)"); if ("number" != typeof n || n % 1 != 0) throw TypeError("Illegal offset: " + n + " (not an integer)"); if ((n >>>= 0) < 0 || n + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength) } "number" == typeof t ? t = e.fromNumber(t) : "string" == typeof t && (t = e.fromString(t)), n += 8; var i = this.buffer.byteLength; n > i && this.resize((i *= 2) > n ? i : n), n -= 8; var o = t.low, s = t.high; return this.littleEndian ? (this.view[n + 3] = o >>> 24 & 255, this.view[n + 2] = o >>> 16 & 255, this.view[n + 1] = o >>> 8 & 255, this.view[n] = 255 & o, n += 4, this.view[n + 3] = s >>> 24 & 255, this.view[n + 2] = s >>> 16 & 255, this.view[n + 1] = s >>> 8 & 255, this.view[n] = 255 & s) : (this.view[n] = s >>> 24 & 255, this.view[n + 1] = s >>> 16 & 255, this.view[n + 2] = s >>> 8 & 255, this.view[n + 3] = 255 & s, n += 4, this.view[n] = o >>> 24 & 255, this.view[n + 1] = o >>> 16 & 255, this.view[n + 2] = o >>> 8 & 255, this.view[n + 3] = 255 & o), r && (this.offset += 8), this }, s.writeUInt64 = s.writeUint64, s.readUint64 = function (t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 8 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+8) <= " + this.buffer.byteLength) } var r = 0, i = 0; this.littleEndian ? (r = this.view[t + 2] << 16, r |= this.view[t + 1] << 8, r |= this.view[t], r += this.view[t + 3] << 24 >>> 0, t += 4, i = this.view[t + 2] << 16, i |= this.view[t + 1] << 8, i |= this.view[t], i += this.view[t + 3] << 24 >>> 0) : (i = this.view[t + 1] << 16, i |= this.view[t + 2] << 8, i |= this.view[t + 3], i += this.view[t] << 24 >>> 0, t += 4, r = this.view[t + 1] << 16, r |= this.view[t + 2] << 8, r |= this.view[t + 3], r += this.view[t] << 24 >>> 0); var o = new e(r, i, !0); return n && (this.offset += 8), o }, s.readUInt64 = s.readUint64), s.writeFloat32 = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof e) throw TypeError("Illegal value: " + e + " (not a number)"); if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } t += 4; var r = this.buffer.byteLength; return t > r && this.resize((r *= 2) > t ? r : t), t -= 4, i(this.view, e, t, this.littleEndian, 23, 4), n && (this.offset += 4), this }, s.writeFloat = s.writeFloat32, s.readFloat32 = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 4 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength) } var n = r(this.view, e, this.littleEndian, 23, 4); return t && (this.offset += 4), n }, s.readFloat = s.readFloat32, s.writeFloat64 = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof e) throw TypeError("Illegal value: " + e + " (not a number)"); if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } t += 8; var r = this.buffer.byteLength; return t > r && this.resize((r *= 2) > t ? r : t), t -= 8, i(this.view, e, t, this.littleEndian, 52, 8), n && (this.offset += 8), this }, s.writeDouble = s.writeFloat64, s.readFloat64 = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 8 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+8) <= " + this.buffer.byteLength) } var n = r(this.view, e, this.littleEndian, 52, 8); return t && (this.offset += 8), n }, s.readDouble = s.readFloat64, o.MAX_VARINT32_BYTES = 5, o.calculateVarint32 = function (e) { return (e >>>= 0) < 128 ? 1 : e < 16384 ? 2 : e < 1 << 21 ? 3 : e < 1 << 28 ? 4 : 5 }, o.zigZagEncode32 = function (e) { return ((e |= 0) << 1 ^ e >> 31) >>> 0 }, o.zigZagDecode32 = function (e) { return e >>> 1 ^ -(1 & e) | 0 }, s.writeVarint32 = function (e, t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal value: " + e + " (not an integer)"); if (e |= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+0) <= " + this.buffer.byteLength) } var r, i = o.calculateVarint32(e); t += i; var s = this.buffer.byteLength; for (t > s && this.resize((s *= 2) > t ? s : t), t -= i, e >>>= 0; e >= 128;)r = 127 & e | 128, this.view[t++] = r, e >>>= 7; return this.view[t++] = e, n ? (this.offset = t, this) : i }, s.writeVarint32ZigZag = function (e, t) { return this.writeVarint32(o.zigZagEncode32(e), t) }, s.readVarint32 = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength) } var n, r = 0, i = 0; do { if (!this.noAssert && e > this.limit) { var o = Error("Truncated"); throw o.truncated = !0, o } n = this.view[e++], r < 5 && (i |= (127 & n) << 7 * r), ++r } while (0 != (128 & n)); return i |= 0, t ? (this.offset = e, i) : { value: i, length: r } }, s.readVarint32ZigZag = function (e) { var t = this.readVarint32(e); return "object" == typeof t ? t.value = o.zigZagDecode32(t.value) : t = o.zigZagDecode32(t), t }, e && (o.MAX_VARINT64_BYTES = 10, o.calculateVarint64 = function (t) { "number" == typeof t ? t = e.fromNumber(t) : "string" == typeof t && (t = e.fromString(t)); var n = t.toInt() >>> 0, r = t.shiftRightUnsigned(28).toInt() >>> 0, i = t.shiftRightUnsigned(56).toInt() >>> 0; return 0 == i ? 0 == r ? n < 16384 ? n < 128 ? 1 : 2 : n < 1 << 21 ? 3 : 4 : r < 16384 ? r < 128 ? 5 : 6 : r < 1 << 21 ? 7 : 8 : i < 128 ? 9 : 10 }, o.zigZagEncode64 = function (t) { return "number" == typeof t ? t = e.fromNumber(t, !1) : "string" == typeof t ? t = e.fromString(t, !1) : !1 !== t.unsigned && (t = t.toSigned()), t.shiftLeft(1).xor(t.shiftRight(63)).toUnsigned() }, o.zigZagDecode64 = function (t) { return "number" == typeof t ? t = e.fromNumber(t, !1) : "string" == typeof t ? t = e.fromString(t, !1) : !1 !== t.unsigned && (t = t.toSigned()), t.shiftRightUnsigned(1).xor(t.and(e.ONE).toSigned().negate()).toSigned() }, s.writeVarint64 = function (t, n) { var r = void 0 === n; if (r && (n = this.offset), !this.noAssert) { if ("number" == typeof t) t = e.fromNumber(t); else if ("string" == typeof t) t = e.fromString(t); else if (!(t && t instanceof e)) throw TypeError("Illegal value: " + t + " (not an integer or Long)"); if ("number" != typeof n || n % 1 != 0) throw TypeError("Illegal offset: " + n + " (not an integer)"); if ((n >>>= 0) < 0 || n + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength) } "number" == typeof t ? t = e.fromNumber(t, !1) : "string" == typeof t ? t = e.fromString(t, !1) : !1 !== t.unsigned && (t = t.toSigned()); var i = o.calculateVarint64(t), s = t.toInt() >>> 0, a = t.shiftRightUnsigned(28).toInt() >>> 0, u = t.shiftRightUnsigned(56).toInt() >>> 0; n += i; var f = this.buffer.byteLength; switch (n > f && this.resize((f *= 2) > n ? f : n), n -= i, i) { case 10: this.view[n + 9] = u >>> 7 & 1; case 9: this.view[n + 8] = 9 !== i ? 128 | u : 127 & u; case 8: this.view[n + 7] = 8 !== i ? a >>> 21 | 128 : a >>> 21 & 127; case 7: this.view[n + 6] = 7 !== i ? a >>> 14 | 128 : a >>> 14 & 127; case 6: this.view[n + 5] = 6 !== i ? a >>> 7 | 128 : a >>> 7 & 127; case 5: this.view[n + 4] = 5 !== i ? 128 | a : 127 & a; case 4: this.view[n + 3] = 4 !== i ? s >>> 21 | 128 : s >>> 21 & 127; case 3: this.view[n + 2] = 3 !== i ? s >>> 14 | 128 : s >>> 14 & 127; case 2: this.view[n + 1] = 2 !== i ? s >>> 7 | 128 : s >>> 7 & 127; case 1: this.view[n] = 1 !== i ? 128 | s : 127 & s }return r ? (this.offset += i, this) : i }, s.writeVarint64ZigZag = function (e, t) { return this.writeVarint64(o.zigZagEncode64(e), t) }, s.readVarint64 = function (t) { var n = void 0 === t; if (n && (t = this.offset), !this.noAssert) { if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: " + t + " (not an integer)"); if ((t >>>= 0) < 0 || t + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + t + " (+1) <= " + this.buffer.byteLength) } var r = t, i = 0, o = 0, s = 0, a = 0; if (a = this.view[t++], i = 127 & a, 128 & a && (a = this.view[t++], i |= (127 & a) << 7, (128 & a || this.noAssert && void 0 === a) && (a = this.view[t++], i |= (127 & a) << 14, (128 & a || this.noAssert && void 0 === a) && (a = this.view[t++], i |= (127 & a) << 21, (128 & a || this.noAssert && void 0 === a) && (a = this.view[t++], o = 127 & a, (128 & a || this.noAssert && void 0 === a) && (a = this.view[t++], o |= (127 & a) << 7, (128 & a || this.noAssert && void 0 === a) && (a = this.view[t++], o |= (127 & a) << 14, (128 & a || this.noAssert && void 0 === a) && (a = this.view[t++], o |= (127 & a) << 21, (128 & a || this.noAssert && void 0 === a) && (a = this.view[t++], s = 127 & a, (128 & a || this.noAssert && void 0 === a) && (a = this.view[t++], s |= (127 & a) << 7, 128 & a || this.noAssert && void 0 === a)))))))))) throw Error("Buffer overrun"); var u = e.fromBits(i | o << 28, o >>> 4 | s << 24, !1); return n ? (this.offset = t, u) : { value: u, length: t - r } }, s.readVarint64ZigZag = function (t) { var n = this.readVarint64(t); return n && n.value instanceof e ? n.value = o.zigZagDecode64(n.value) : n = o.zigZagDecode64(n), n }), s.writeCString = function (e, n) { var r = void 0 === n; r && (n = this.offset); var i, o = e.length; if (!this.noAssert) { if ("string" != typeof e) throw TypeError("Illegal str: Not a string"); for (i = 0; i < o; ++i)if (0 === e.charCodeAt(i)) throw RangeError("Illegal str: Contains NULL-characters"); if ("number" != typeof n || n % 1 != 0) throw TypeError("Illegal offset: " + n + " (not an integer)"); if ((n >>>= 0) < 0 || n + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength) } o = c.calculateUTF16asUTF8(t(e))[1], n += o + 1; var s = this.buffer.byteLength; return n > s && this.resize((s *= 2) > n ? s : n), n -= o + 1, c.encodeUTF16toUTF8(t(e), function (e) { this.view[n++] = e }.bind(this)), this.view[n++] = 0, r ? (this.offset = n, this) : o }, s.readCString = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength) } var r, i = e, o = -1; return c.decodeUTF8toUTF16(function () { if (0 === o) return null; if (e >= this.limit) throw RangeError("Illegal range: Truncated data, " + e + " < " + this.limit); return 0 === (o = this.view[e++]) ? null : o }.bind(this), r = n(), !0), t ? (this.offset = e, r()) : { string: r(), length: e - i } }, s.writeIString = function (e, n) { var r = void 0 === n; if (r && (n = this.offset), !this.noAssert) { if ("string" != typeof e) throw TypeError("Illegal str: Not a string"); if ("number" != typeof n || n % 1 != 0) throw TypeError("Illegal offset: " + n + " (not an integer)"); if ((n >>>= 0) < 0 || n + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength) } var i, o = n; i = c.calculateUTF16asUTF8(t(e), this.noAssert)[1], n += 4 + i; var s = this.buffer.byteLength; if (n > s && this.resize((s *= 2) > n ? s : n), n -= 4 + i, this.littleEndian ? (this.view[n + 3] = i >>> 24 & 255, this.view[n + 2] = i >>> 16 & 255, this.view[n + 1] = i >>> 8 & 255, this.view[n] = 255 & i) : (this.view[n] = i >>> 24 & 255, this.view[n + 1] = i >>> 16 & 255, this.view[n + 2] = i >>> 8 & 255, this.view[n + 3] = 255 & i), n += 4, c.encodeUTF16toUTF8(t(e), function (e) { this.view[n++] = e }.bind(this)), n !== o + 4 + i) throw RangeError("Illegal range: Truncated data, " + n + " == " + (n + 4 + i)); return r ? (this.offset = n, this) : n - o }, s.readIString = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 4 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+4) <= " + this.buffer.byteLength) } var n = e, r = this.readUint32(e), i = this.readUTF8String(r, o.METRICS_BYTES, e += 4); return e += i.length, t ? (this.offset = e, i.string) : { string: i.string, length: e - n } }, o.METRICS_CHARS = "c", o.METRICS_BYTES = "b", s.writeUTF8String = function (e, n) { var r = void 0 === n; if (r && (n = this.offset), !this.noAssert) { if ("number" != typeof n || n % 1 != 0) throw TypeError("Illegal offset: " + n + " (not an integer)"); if ((n >>>= 0) < 0 || n + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength) } var i, o = n; i = c.calculateUTF16asUTF8(t(e))[1], n += i; var s = this.buffer.byteLength; return n > s && this.resize((s *= 2) > n ? s : n), n -= i, c.encodeUTF16toUTF8(t(e), function (e) { this.view[n++] = e }.bind(this)), r ? (this.offset = n, this) : n - o }, s.writeString = s.writeUTF8String, o.calculateUTF8Chars = function (e) { return c.calculateUTF16asUTF8(t(e))[0] }, o.calculateUTF8Bytes = function (e) { return c.calculateUTF16asUTF8(t(e))[1] }, o.calculateString = o.calculateUTF8Bytes, s.readUTF8String = function (e, t, r) { "number" == typeof t && (r = t, t = void 0); var i = void 0 === r; if (i && (r = this.offset), void 0 === t && (t = o.METRICS_CHARS), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal length: " + e + " (not an integer)"); if (e |= 0, "number" != typeof r || r % 1 != 0) throw TypeError("Illegal offset: " + r + " (not an integer)"); if ((r >>>= 0) < 0 || r + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + r + " (+0) <= " + this.buffer.byteLength) } var s, a = 0, u = r; if (t === o.METRICS_CHARS) { if (s = n(), c.decodeUTF8(function () { return a < e && r < this.limit ? this.view[r++] : null }.bind(this), function (e) { ++a, c.UTF8toUTF16(e, s) }), a !== e) throw RangeError("Illegal range: Truncated data, " + a + " == " + e); return i ? (this.offset = r, s()) : { string: s(), length: r - u } } if (t === o.METRICS_BYTES) { if (!this.noAssert) { if ("number" != typeof r || r % 1 != 0) throw TypeError("Illegal offset: " + r + " (not an integer)"); if ((r >>>= 0) < 0 || r + e > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + r + " (+" + e + ") <= " + this.buffer.byteLength) } var f = r + e; if (c.decodeUTF8toUTF16(function () { return r < f ? this.view[r++] : null }.bind(this), s = n(), this.noAssert), r !== f) throw RangeError("Illegal range: Truncated data, " + r + " == " + f); return i ? (this.offset = r, s()) : { string: s(), length: r - u } } throw TypeError("Unsupported metrics: " + t) }, s.readString = s.readUTF8String, s.writeVString = function (e, n) { var r = void 0 === n; if (r && (n = this.offset), !this.noAssert) { if ("string" != typeof e) throw TypeError("Illegal str: Not a string"); if ("number" != typeof n || n % 1 != 0) throw TypeError("Illegal offset: " + n + " (not an integer)"); if ((n >>>= 0) < 0 || n + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength) } var i, s, a = n; i = c.calculateUTF16asUTF8(t(e), this.noAssert)[1], s = o.calculateVarint32(i), n += s + i; var u = this.buffer.byteLength; if (n > u && this.resize((u *= 2) > n ? u : n), n -= s + i, n += this.writeVarint32(i, n), c.encodeUTF16toUTF8(t(e), function (e) { this.view[n++] = e }.bind(this)), n !== a + i + s) throw RangeError("Illegal range: Truncated data, " + n + " == " + (n + i + s)); return r ? (this.offset = n, this) : n - a }, s.readVString = function (e) { var t = void 0 === e; if (t && (e = this.offset), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 1 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+1) <= " + this.buffer.byteLength) } var n = e, r = this.readVarint32(e), i = this.readUTF8String(r.value, o.METRICS_BYTES, e += r.length); return e += i.length, t ? (this.offset = e, i.string) : { string: i.string, length: e - n } }, s.append = function (e, t, n) { "number" != typeof t && "string" == typeof t || (n = t, t = void 0); var r = void 0 === n; if (r && (n = this.offset), !this.noAssert) { if ("number" != typeof n || n % 1 != 0) throw TypeError("Illegal offset: " + n + " (not an integer)"); if ((n >>>= 0) < 0 || n + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength) } e instanceof o || (e = o.wrap(e, t)); var i = e.limit - e.offset; if (i <= 0) return this; n += i; var s = this.buffer.byteLength; return n > s && this.resize((s *= 2) > n ? s : n), n -= i, this.view.set(e.view.subarray(e.offset, e.limit), n), e.offset += i, r && (this.offset += i), this }, s.appendTo = function (e, t) { return e.append(this, t), this }, s.assert = function (e) { return this.noAssert = !e, this }, s.capacity = function () { return this.buffer.byteLength }, s.clear = function () { return this.offset = 0, this.limit = this.buffer.byteLength, this.markedOffset = -1, this }, s.clone = function (e) { var t = new o(0, this.littleEndian, this.noAssert); return e ? (t.buffer = new ArrayBuffer(this.buffer.byteLength), t.view = new Uint8Array(t.buffer)) : (t.buffer = this.buffer, t.view = this.view), t.offset = this.offset, t.markedOffset = this.markedOffset, t.limit = this.limit, t }, s.compact = function (e, t) { if (void 0 === e && (e = this.offset), void 0 === t && (t = this.limit), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal begin: Not an integer"); if (e >>>= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal end: Not an integer"); if (t >>>= 0, e < 0 || e > t || t > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength) } if (0 === e && t === this.buffer.byteLength) return this; var n = t - e; if (0 === n) return this.buffer = a, this.view = null, this.markedOffset >= 0 && (this.markedOffset -= e), this.offset = 0, this.limit = 0, this; var r = new ArrayBuffer(n), i = new Uint8Array(r); return i.set(this.view.subarray(e, t)), this.buffer = r, this.view = i, this.markedOffset >= 0 && (this.markedOffset -= e), this.offset = 0, this.limit = n, this }, s.copy = function (e, t) { if (void 0 === e && (e = this.offset), void 0 === t && (t = this.limit), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal begin: Not an integer"); if (e >>>= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal end: Not an integer"); if (t >>>= 0, e < 0 || e > t || t > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength) } if (e === t) return new o(0, this.littleEndian, this.noAssert); var n = t - e, r = new o(n, this.littleEndian, this.noAssert); return r.offset = 0, r.limit = n, r.markedOffset >= 0 && (r.markedOffset -= e), this.copyTo(r, 0, e, t), r }, s.copyTo = function (e, t, n, r) { var i, s; if (!this.noAssert && !o.isByteBuffer(e)) throw TypeError("Illegal target: Not a ByteBuffer"); if (t = (s = void 0 === t) ? e.offset : 0 | t, n = (i = void 0 === n) ? this.offset : 0 | n, r = void 0 === r ? this.limit : 0 | r, t < 0 || t > e.buffer.byteLength) throw RangeError("Illegal target range: 0 <= " + t + " <= " + e.buffer.byteLength); if (n < 0 || r > this.buffer.byteLength) throw RangeError("Illegal source range: 0 <= " + n + " <= " + this.buffer.byteLength); var a = r - n; return 0 === a ? e : (e.ensureCapacity(t + a), e.view.set(this.view.subarray(n, r), t), i && (this.offset += a), s && (e.offset += a), this) }, s.ensureCapacity = function (e) { var t = this.buffer.byteLength; return t < e ? this.resize((t *= 2) > e ? t : e) : this }, s.fill = function (e, t, n) { var r = void 0 === t; if (r && (t = this.offset), "string" == typeof e && e.length > 0 && (e = e.charCodeAt(0)), void 0 === t && (t = this.offset), void 0 === n && (n = this.limit), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal value: " + e + " (not an integer)"); if (e |= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal begin: Not an integer"); if (t >>>= 0, "number" != typeof n || n % 1 != 0) throw TypeError("Illegal end: Not an integer"); if (n >>>= 0, t < 0 || t > n || n > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + t + " <= " + n + " <= " + this.buffer.byteLength) } if (t >= n) return this; for (; t < n;)this.view[t++] = e; return r && (this.offset = t), this }, s.flip = function () { return this.limit = this.offset, this.offset = 0, this }, s.mark = function (e) { if (e = void 0 === e ? this.offset : e, !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal offset: " + e + " (not an integer)"); if ((e >>>= 0) < 0 || e + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + e + " (+0) <= " + this.buffer.byteLength) } return this.markedOffset = e, this }, s.order = function (e) { if (!this.noAssert && "boolean" != typeof e) throw TypeError("Illegal littleEndian: Not a boolean"); return this.littleEndian = !!e, this }, s.LE = function (e) { return this.littleEndian = void 0 === e || !!e, this }, s.BE = function (e) { return this.littleEndian = void 0 !== e && !e, this }, s.prepend = function (e, t, n) { "number" != typeof t && "string" == typeof t || (n = t, t = void 0); var r = void 0 === n; if (r && (n = this.offset), !this.noAssert) { if ("number" != typeof n || n % 1 != 0) throw TypeError("Illegal offset: " + n + " (not an integer)"); if ((n >>>= 0) < 0 || n + 0 > this.buffer.byteLength) throw RangeError("Illegal offset: 0 <= " + n + " (+0) <= " + this.buffer.byteLength) } e instanceof o || (e = o.wrap(e, t)); var i = e.limit - e.offset; if (i <= 0) return this; var s = i - n; if (s > 0) { var a = new ArrayBuffer(this.buffer.byteLength + s), u = new Uint8Array(a); u.set(this.view.subarray(n, this.buffer.byteLength), i), this.buffer = a, this.view = u, this.offset += s, this.markedOffset >= 0 && (this.markedOffset += s), this.limit += s, n += s } else new Uint8Array(this.buffer); return this.view.set(e.view.subarray(e.offset, e.limit), n - i), e.offset = e.limit, r && (this.offset -= i), this }, s.prependTo = function (e, t) { return e.prepend(this, t), this }, s.printDebug = function (e) { "function" != typeof e && (e = console.log.bind(console)), e(this.toString() + "\n-------------------------------------------------------------------\n" + this.toDebug(!0)) }, s.remaining = function () { return this.limit - this.offset }, s.reset = function () { return this.markedOffset >= 0 ? (this.offset = this.markedOffset, this.markedOffset = -1) : this.offset = 0, this }, s.resize = function (e) { if (!this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal capacity: " + e + " (not an integer)"); if ((e |= 0) < 0) throw RangeError("Illegal capacity: 0 <= " + e) } if (this.buffer.byteLength < e) { var t = new ArrayBuffer(e), n = new Uint8Array(t); n.set(this.view), this.buffer = t, this.view = n } return this }, s.reverse = function (e, t) { if (void 0 === e && (e = this.offset), void 0 === t && (t = this.limit), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal begin: Not an integer"); if (e >>>= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal end: Not an integer"); if (t >>>= 0, e < 0 || e > t || t > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength) } return e === t ? this : (Array.prototype.reverse.call(this.view.subarray(e, t)), this) }, s.skip = function (e) { if (!this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal length: " + e + " (not an integer)"); e |= 0 } var t = this.offset + e; if (!this.noAssert && (t < 0 || t > this.buffer.byteLength)) throw RangeError("Illegal length: 0 <= " + this.offset + " + " + e + " <= " + this.buffer.byteLength); return this.offset = t, this }, s.slice = function (e, t) { if (void 0 === e && (e = this.offset), void 0 === t && (t = this.limit), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal begin: Not an integer"); if (e >>>= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal end: Not an integer"); if (t >>>= 0, e < 0 || e > t || t > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength) } var n = this.clone(); return n.offset = e, n.limit = t, n }, s.toBuffer = function (e) { var t = this.offset, n = this.limit; if (!this.noAssert) { if ("number" != typeof t || t % 1 != 0) throw TypeError("Illegal offset: Not an integer"); if (t >>>= 0, "number" != typeof n || n % 1 != 0) throw TypeError("Illegal limit: Not an integer"); if (n >>>= 0, t < 0 || t > n || n > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + t + " <= " + n + " <= " + this.buffer.byteLength) } if (!e && 0 === t && n === this.buffer.byteLength) return this.buffer; if (t === n) return a; var r = new ArrayBuffer(n - t); return new Uint8Array(r).set(new Uint8Array(this.buffer).subarray(t, n), 0), r }, s.toArrayBuffer = s.toBuffer, s.toString = function (e, t, n) { if (void 0 === e) return "ByteBufferAB(offset=" + this.offset + ",markedOffset=" + this.markedOffset + ",limit=" + this.limit + ",capacity=" + this.capacity() + ")"; switch ("number" == typeof e && (e = "utf8", t = e, n = t), e) { case "utf8": return this.toUTF8(t, n); case "base64": return this.toBase64(t, n); case "hex": return this.toHex(t, n); case "binary": return this.toBinary(t, n); case "debug": return this.toDebug(); case "columns": return this.toColumns(); default: throw Error("Unsupported encoding: " + e) } }; var f = function () { for (var e = {}, t = [65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 43, 47], n = [], r = 0, i = t.length; r < i; ++r)n[t[r]] = r; return e.encode = function (e, n) { for (var r, i; null !== (r = e());)n(t[r >> 2 & 63]), i = (3 & r) << 4, null !== (r = e()) ? (n(t[63 & ((i |= r >> 4 & 15) | r >> 4 & 15)]), i = (15 & r) << 2, null !== (r = e()) ? (n(t[63 & (i | r >> 6 & 3)]), n(t[63 & r])) : (n(t[63 & i]), n(61))) : (n(t[63 & i]), n(61), n(61)) }, e.decode = function (e, t) { function r(e) { throw Error("Illegal character code: " + e) } for (var i, o, s; null !== (i = e());)if (void 0 === (o = n[i]) && r(i), null !== (i = e()) && (void 0 === (s = n[i]) && r(i), t(o << 2 >>> 0 | (48 & s) >> 4), null !== (i = e()))) { if (void 0 === (o = n[i])) { if (61 === i) break; r(i) } if (t((15 & s) << 4 >>> 0 | (60 & o) >> 2), null !== (i = e())) { if (void 0 === (s = n[i])) { if (61 === i) break; r(i) } t((3 & o) << 6 >>> 0 | s) } } }, e.test = function (e) { return /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e) }, e }(); s.toBase64 = function (e, t) { if (void 0 === e && (e = this.offset), void 0 === t && (t = this.limit), e |= 0, t |= 0, e < 0 || t > this.capacity || e > t) throw RangeError("begin, end"); var r; return f.encode(function () { return e < t ? this.view[e++] : null }.bind(this), r = n()), r() }, o.fromBase64 = function (e, n) { if ("string" != typeof e) throw TypeError("str"); var r = new o(e.length / 4 * 3, n), i = 0; return f.decode(t(e), function (e) { r.view[i++] = e }), r.limit = i, r }, o.btoa = function (e) { return o.fromBinary(e).toBase64() }, o.atob = function (e) { return o.fromBase64(e).toBinary() }, s.toBinary = function (e, t) { if (void 0 === e && (e = this.offset), void 0 === t && (t = this.limit), e |= 0, t |= 0, e < 0 || t > this.capacity() || e > t) throw RangeError("begin, end"); if (e === t) return ""; for (var n = [], r = []; e < t;)n.push(this.view[e++]), n.length >= 1024 && (r.push(String.fromCharCode.apply(String, n)), n = []); return r.join("") + String.fromCharCode.apply(String, n) }, o.fromBinary = function (e, t) { if ("string" != typeof e) throw TypeError("str"); for (var n, r = 0, i = e.length, s = new o(i, t); r < i;) { if ((n = e.charCodeAt(r)) > 255) throw RangeError("illegal char code: " + n); s.view[r++] = n } return s.limit = i, s }, s.toDebug = function (e) { for (var t, n = -1, r = this.buffer.byteLength, i = "", o = "", s = ""; n < r;) { if (-1 !== n && (i += (t = this.view[n]) < 16 ? "0" + t.toString(16).toUpperCase() : t.toString(16).toUpperCase(), e && (o += t > 32 && t < 127 ? String.fromCharCode(t) : ".")), ++n, e && n > 0 && n % 16 == 0 && n !== r) { for (; i.length < 51;)i += " "; s += i + o + "\n", i = o = "" } n === this.offset && n === this.limit ? i += n === this.markedOffset ? "!" : "|" : n === this.offset ? i += n === this.markedOffset ? "[" : "<" : n === this.limit ? i += n === this.markedOffset ? "]" : ">" : i += n === this.markedOffset ? "'" : e || 0 !== n && n !== r ? " " : "" } if (e && " " !== i) { for (; i.length < 51;)i += " "; s += i + o + "\n" } return e ? s : i }, o.fromDebug = function (e, t, n) { for (var r, i, s = e.length, a = new o((s + 1) / 3 | 0, t, n), u = 0, f = 0, c = !1, l = !1, h = !1, p = !1, d = !1; u < s;) { switch (r = e.charAt(u++)) { case "!": if (!n) { if (l || h || p) { d = !0; break } l = h = p = !0 } a.offset = a.markedOffset = a.limit = f, c = !1; break; case "|": if (!n) { if (l || p) { d = !0; break } l = p = !0 } a.offset = a.limit = f, c = !1; break; case "[": if (!n) { if (l || h) { d = !0; break } l = h = !0 } a.offset = a.markedOffset = f, c = !1; break; case "<": if (!n) { if (l) { d = !0; break } l = !0 } a.offset = f, c = !1; break; case "]": if (!n) { if (p || h) { d = !0; break } p = h = !0 } a.limit = a.markedOffset = f, c = !1; break; case ">": if (!n) { if (p) { d = !0; break } p = !0 } a.limit = f, c = !1; break; case "'": if (!n) { if (h) { d = !0; break } h = !0 } a.markedOffset = f, c = !1; break; case " ": c = !1; break; default: if (!n && c) { d = !0; break } if (i = parseInt(r + e.charAt(u++), 16), !n && (isNaN(i) || i < 0 || i > 255)) throw TypeError("Illegal str: Not a debug encoded string"); a.view[f++] = i, c = !0 }if (d) throw TypeError("Illegal str: Invalid symbol at " + u) } if (!n) { if (!l || !p) throw TypeError("Illegal str: Missing offset or limit"); if (f < a.buffer.byteLength) throw TypeError("Illegal str: Not a debug encoded string (is it hex?) " + f + " < " + s) } return a }, s.toHex = function (e, t) { if (e = void 0 === e ? this.offset : e, t = void 0 === t ? this.limit : t, !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal begin: Not an integer"); if (e >>>= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal end: Not an integer"); if (t >>>= 0, e < 0 || e > t || t > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength) } for (var n, r = new Array(t - e); e < t;)(n = this.view[e++]) < 16 ? r.push("0", n.toString(16)) : r.push(n.toString(16)); return r.join("") }, o.fromHex = function (e, t, n) { if (!n) { if ("string" != typeof e) throw TypeError("Illegal str: Not a string"); if (e.length % 2 != 0) throw TypeError("Illegal str: Length not a multiple of 2") } for (var r, i = e.length, s = new o(i / 2 | 0, t), a = 0, u = 0; a < i; a += 2) { if (r = parseInt(e.substring(a, a + 2), 16), !n && (!isFinite(r) || r < 0 || r > 255)) throw TypeError("Illegal str: Contains non-hex characters"); s.view[u++] = r } return s.limit = u, s }; var c = function () { var e = {}; return e.MAX_CODEPOINT = 1114111, e.encodeUTF8 = function (e, t) { var n = null; for ("number" == typeof e && (n = e, e = function () { return null }); null !== n || null !== (n = e());)n < 128 ? t(127 & n) : n < 2048 ? (t(n >> 6 & 31 | 192), t(63 & n | 128)) : n < 65536 ? (t(n >> 12 & 15 | 224), t(n >> 6 & 63 | 128), t(63 & n | 128)) : (t(n >> 18 & 7 | 240), t(n >> 12 & 63 | 128), t(n >> 6 & 63 | 128), t(63 & n | 128)), n = null }, e.decodeUTF8 = function (e, t) { for (var n, r, i, o, s = function (e) { e = e.slice(0, e.indexOf(null)); var t = Error(e.toString()); throw t.name = "TruncatedError", t.bytes = e, t }; null !== (n = e());)if (0 == (128 & n)) t(n); else if (192 == (224 & n)) null === (r = e()) && s([n, r]), t((31 & n) << 6 | 63 & r); else if (224 == (240 & n)) (null === (r = e()) || null === (i = e())) && s([n, r, i]), t((15 & n) << 12 | (63 & r) << 6 | 63 & i); else { if (240 != (248 & n)) throw RangeError("Illegal starting byte: " + n); (null === (r = e()) || null === (i = e()) || null === (o = e())) && s([n, r, i, o]), t((7 & n) << 18 | (63 & r) << 12 | (63 & i) << 6 | 63 & o) } }, e.UTF16toUTF8 = function (e, t) { for (var n, r = null; ;) { if (null === (n = null !== r ? r : e())) break; n >= 55296 && n <= 57343 && null !== (r = e()) && r >= 56320 && r <= 57343 ? (t(1024 * (n - 55296) + r - 56320 + 65536), r = null) : t(n) } null !== r && t(r) }, e.UTF8toUTF16 = function (e, t) { var n = null; for ("number" == typeof e && (n = e, e = function () { return null }); null !== n || null !== (n = e());)n <= 65535 ? t(n) : (n -= 65536, t(55296 + (n >> 10)), t(n % 1024 + 56320)), n = null }, e.encodeUTF16toUTF8 = function (t, n) { e.UTF16toUTF8(t, function (t) { e.encodeUTF8(t, n) }) }, e.decodeUTF8toUTF16 = function (t, n) { e.decodeUTF8(t, function (t) { e.UTF8toUTF16(t, n) }) }, e.calculateCodePoint = function (e) { return e < 128 ? 1 : e < 2048 ? 2 : e < 65536 ? 3 : 4 }, e.calculateUTF8 = function (e) { for (var t, n = 0; null !== (t = e());)n += t < 128 ? 1 : t < 2048 ? 2 : t < 65536 ? 3 : 4; return n }, e.calculateUTF16asUTF8 = function (t) { var n = 0, r = 0; return e.UTF16toUTF8(t, function (e) { ++n, r += e < 128 ? 1 : e < 2048 ? 2 : e < 65536 ? 3 : 4 }), [n, r] }, e }(); return s.toUTF8 = function (e, t) { if (void 0 === e && (e = this.offset), void 0 === t && (t = this.limit), !this.noAssert) { if ("number" != typeof e || e % 1 != 0) throw TypeError("Illegal begin: Not an integer"); if (e >>>= 0, "number" != typeof t || t % 1 != 0) throw TypeError("Illegal end: Not an integer"); if (t >>>= 0, e < 0 || e > t || t > this.buffer.byteLength) throw RangeError("Illegal range: 0 <= " + e + " <= " + t + " <= " + this.buffer.byteLength) } var r; try { c.decodeUTF8toUTF16(function () { return e < t ? this.view[e++] : null }.bind(this), r = n()) } catch (n) { if (e !== t) throw RangeError("Illegal range: Truncated data, " + e + " != " + t) } return r() }, o.fromUTF8 = function (e, n, r) { if (!r && "string" != typeof e) throw TypeError("Illegal str: Not a string"); var i = new o(c.calculateUTF16asUTF8(t(e), !0)[1], n, r), s = 0; return c.encodeUTF16toUTF8(t(e), function (e) { i.view[s++] = e }), i.limit = s, i }, o }) }), Mi = {}, Pi = Object.freeze({ default: Mi }), Ri = Pi && Mi || Pi, Li = r(function (e) { !function (n, r) { "function" == typeof t && e && e.exports ? e.exports = r(xi, !0) : (n.dcodeIO = n.dcodeIO || {}).ProtoBuf = r(n.dcodeIO.ByteBuffer) }(z, function (e, t) { var n = {}; return n.ByteBuffer = e, n.Long = e.Long || null, n.VERSION = "5.0.2", n.WIRE_TYPES = {}, n.WIRE_TYPES.VARINT = 0, n.WIRE_TYPES.BITS64 = 1, n.WIRE_TYPES.LDELIM = 2, n.WIRE_TYPES.STARTGROUP = 3, n.WIRE_TYPES.ENDGROUP = 4, n.WIRE_TYPES.BITS32 = 5, n.PACKABLE_WIRE_TYPES = [n.WIRE_TYPES.VARINT, n.WIRE_TYPES.BITS64, n.WIRE_TYPES.BITS32], n.TYPES = { int32: { name: "int32", wireType: n.WIRE_TYPES.VARINT, defaultValue: 0 }, uint32: { name: "uint32", wireType: n.WIRE_TYPES.VARINT, defaultValue: 0 }, sint32: { name: "sint32", wireType: n.WIRE_TYPES.VARINT, defaultValue: 0 }, int64: { name: "int64", wireType: n.WIRE_TYPES.VARINT, defaultValue: n.Long ? n.Long.ZERO : void 0 }, uint64: { name: "uint64", wireType: n.WIRE_TYPES.VARINT, defaultValue: n.Long ? n.Long.UZERO : void 0 }, sint64: { name: "sint64", wireType: n.WIRE_TYPES.VARINT, defaultValue: n.Long ? n.Long.ZERO : void 0 }, bool: { name: "bool", wireType: n.WIRE_TYPES.VARINT, defaultValue: !1 }, double: { name: "double", wireType: n.WIRE_TYPES.BITS64, defaultValue: 0 }, string: { name: "string", wireType: n.WIRE_TYPES.LDELIM, defaultValue: "" }, bytes: { name: "bytes", wireType: n.WIRE_TYPES.LDELIM, defaultValue: null }, fixed32: { name: "fixed32", wireType: n.WIRE_TYPES.BITS32, defaultValue: 0 }, sfixed32: { name: "sfixed32", wireType: n.WIRE_TYPES.BITS32, defaultValue: 0 }, fixed64: { name: "fixed64", wireType: n.WIRE_TYPES.BITS64, defaultValue: n.Long ? n.Long.UZERO : void 0 }, sfixed64: { name: "sfixed64", wireType: n.WIRE_TYPES.BITS64, defaultValue: n.Long ? n.Long.ZERO : void 0 }, float: { name: "float", wireType: n.WIRE_TYPES.BITS32, defaultValue: 0 }, enum: { name: "enum", wireType: n.WIRE_TYPES.VARINT, defaultValue: 0 }, message: { name: "message", wireType: n.WIRE_TYPES.LDELIM, defaultValue: null }, group: { name: "group", wireType: n.WIRE_TYPES.STARTGROUP, defaultValue: null } }, n.MAP_KEY_TYPES = [n.TYPES.int32, n.TYPES.sint32, n.TYPES.sfixed32, n.TYPES.uint32, n.TYPES.fixed32, n.TYPES.int64, n.TYPES.sint64, n.TYPES.sfixed64, n.TYPES.uint64, n.TYPES.fixed64, n.TYPES.bool, n.TYPES.string, n.TYPES.bytes], n.ID_MIN = 1, n.ID_MAX = 536870911, n.convertFieldsToCamelCase = !1, n.populateAccessors = !0, n.populateDefaults = !0, n.Util = function () { var e = {}; return e.IS_NODE = !("object" != typeof Y || Y + "" != "[object process]" || Y.browser), e.XHR = function () { for (var e = [function () { return new XMLHttpRequest }, function () { return new ActiveXObject("Msxml2.XMLHTTP") }, function () { return new ActiveXObject("Msxml3.XMLHTTP") }, function () { return new ActiveXObject("Microsoft.XMLHTTP") }], t = null, n = 0; n < e.length; n++) { try { t = e[n]() } catch (e) { continue } break } if (!t) throw Error("XMLHttpRequest is not supported"); return t }, e.fetch = function (t, n) { if (n && "function" != typeof n && (n = null), e.IS_NODE) { var r = Ri; if (n) r.readFile(t, function (e, t) { n(e ? null : "" + t) }); else try { return r.readFileSync(t) } catch (e) { return null } } else { var i = e.XHR(); if (i.open("GET", t, !!n), i.setRequestHeader("Accept", "text/plain"), "function" == typeof i.overrideMimeType && i.overrideMimeType("text/plain"), !n) return i.send(null), 200 == i.status || 0 == i.status && "string" == typeof i.responseText ? i.responseText : null; if (i.onreadystatechange = function () { 4 == i.readyState && n(200 == i.status || 0 == i.status && "string" == typeof i.responseText ? i.responseText : null) }, 4 == i.readyState) return; i.send(null) } }, e.toCamelCase = function (e) { return e.replace(/_([a-zA-Z])/g, function (e, t) { return t.toUpperCase() }) }, e }(), n.Lang = { DELIM: /[\s\{\}=;:\[\],'"\(\)<>]/g, RULE: /^(?:required|optional|repeated|map)$/, TYPE: /^(?:double|float|int32|uint32|sint32|int64|uint64|sint64|fixed32|sfixed32|fixed64|sfixed64|bool|string|bytes)$/, NAME: /^[a-zA-Z_][a-zA-Z_0-9]*$/, TYPEDEF: /^[a-zA-Z][a-zA-Z_0-9]*$/, TYPEREF: /^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)+$/, FQTYPEREF: /^(?:\.[a-zA-Z][a-zA-Z_0-9]*)+$/, NUMBER: /^-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+|([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?)|inf|nan)$/, NUMBER_DEC: /^(?:[1-9][0-9]*|0)$/, NUMBER_HEX: /^0[xX][0-9a-fA-F]+$/, NUMBER_OCT: /^0[0-7]+$/, NUMBER_FLT: /^([0-9]*(\.[0-9]*)?([Ee][+-]?[0-9]+)?|inf|nan)$/, BOOL: /^(?:true|false)$/i, ID: /^(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/, NEGID: /^\-?(?:[1-9][0-9]*|0|0[xX][0-9a-fA-F]+|0[0-7]+)$/, WHITESPACE: /\s/, STRING: /(?:"([^"\\]*(?:\\.[^"\\]*)*)")|(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g, STRING_DQ: /(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g, STRING_SQ: /(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g }, n.Reflect = function (t) { function n(e, n) { if (e && "number" == typeof e.low && "number" == typeof e.high && "boolean" == typeof e.unsigned && e.low === e.low && e.high === e.high) return new t.Long(e.low, e.high, void 0 === n ? e.unsigned : n); if ("string" == typeof e) return t.Long.fromString(e, n || !1, 10); if ("number" == typeof e) return t.Long.fromNumber(e, n || !1); throw Error("not convertible to Long") } function r(e, n) { var i = n.readVarint32(), o = 7 & i, s = i >>> 3; switch (o) { case t.WIRE_TYPES.VARINT: do { i = n.readUint8() } while (128 == (128 & i)); break; case t.WIRE_TYPES.BITS64: n.offset += 8; break; case t.WIRE_TYPES.LDELIM: i = n.readVarint32(), n.offset += i; break; case t.WIRE_TYPES.STARTGROUP: r(s, n); break; case t.WIRE_TYPES.ENDGROUP: if (s === e) return !1; throw Error("Illegal GROUPEND after unknown group: " + s + " (" + e + " expected)"); case t.WIRE_TYPES.BITS32: n.offset += 4; break; default: throw Error("Illegal wire type in unknown group " + e + ": " + o) }return !0 } var i = {}, o = function (e, t, n) { this.builder = e, this.parent = t, this.name = n, this.className }, s = o.prototype; s.fqn = function () { for (var e = this.name, t = this; ;) { if (null == (t = t.parent)) break; e = t.name + "." + e } return e }, s.toString = function (e) { return (e ? this.className + " " : "") + this.fqn() }, s.build = function () { throw Error(this.toString(!0) + " cannot be built directly") }, i.T = o; var a = function (e, t, n, r, i) { o.call(this, e, t, n), this.className = "Namespace", this.children = [], this.options = r || {}, this.syntax = i || "proto2" }, u = a.prototype = Object.create(o.prototype); u.getChildren = function (e) { if (null == (e = e || null)) return this.children.slice(); for (var t = [], n = 0, r = this.children.length; n < r; ++n)this.children[n] instanceof e && t.push(this.children[n]); return t }, u.addChild = function (e) { var t; if (t = this.getChild(e.name)) if (t instanceof l.Field && t.name !== t.originalName && null === this.getChild(t.originalName)) t.name = t.originalName; else { if (!(e instanceof l.Field && e.name !== e.originalName && null === this.getChild(e.originalName))) throw Error("Duplicate name in namespace " + this.toString(!0) + ": " + e.name); e.name = e.originalName } this.children.push(e) }, u.getChild = function (e) { for (var t = "number" == typeof e ? "id" : "name", n = 0, r = this.children.length; n < r; ++n)if (this.children[n][t] === e) return this.children[n]; return null }, u.resolve = function (e, t) { var n = "string" == typeof e ? e.split(".") : e, r = this, o = 0; if ("" === n[o]) { for (; null !== r.parent;)r = r.parent; o++ } var s; do { do { if (!(r instanceof i.Namespace)) { r = null; break } if (!(s = r.getChild(n[o])) || !(s instanceof i.T) || t && !(s instanceof i.Namespace)) { r = null; break } r = s, o++ } while (o < n.length); if (null != r) break; if (null !== this.parent) return this.parent.resolve(e, t) } while (null != r); return r }, u.qn = function (e) { var t = [], n = e; do { t.unshift(n.name), n = n.parent } while (null !== n); for (var r = 1; r <= t.length; r++) { var o = t.slice(t.length - r); if (e === this.resolve(o, e instanceof i.Namespace)) return o.join(".") } return e.fqn() }, u.build = function () { for (var e, t = {}, n = this.children, r = 0, i = n.length; r < i; ++r)(e = n[r]) instanceof a && (t[e.name] = e.build()); return Object.defineProperty && Object.defineProperty(t, "$options", { value: this.buildOpt() }), t }, u.buildOpt = function () { for (var e = {}, t = Object.keys(this.options), n = 0, r = t.length; n < r; ++n) { var i = t[n], o = this.options[t[n]]; e[i] = o } return e }, u.getOption = function (e) { return void 0 === e ? this.options : void 0 !== this.options[e] ? this.options[e] : null }, i.Namespace = a; var f = function (e, n, r, i, o) { if (this.type = e, this.resolvedType = n, this.isMapKey = r, this.syntax = i, this.name = o, r && t.MAP_KEY_TYPES.indexOf(e) < 0) throw Error("Invalid map key type: " + e.name) }, c = f.prototype; f.defaultFieldValue = function (n) { if ("string" == typeof n && (n = t.TYPES[n]), void 0 === n.defaultValue) throw Error("default value for type " + n.name + " is not supported"); return n == t.TYPES.bytes ? new e(0) : n.defaultValue }, c.toString = function () { return (this.name || "") + (this.isMapKey ? "map" : "value") + " element" }, c.verifyValue = function (r) { function i(e, t) { throw Error("Illegal value for " + o.toString(!0) + " of type " + o.type.name + ": " + e + " (" + t + ")") } var o = this; switch (this.type) { case t.TYPES.int32: case t.TYPES.sint32: case t.TYPES.sfixed32: return ("number" != typeof r || r === r && r % 1 != 0) && i(typeof r, "not an integer"), r > 4294967295 ? 0 | r : r; case t.TYPES.uint32: case t.TYPES.fixed32: return ("number" != typeof r || r === r && r % 1 != 0) && i(typeof r, "not an integer"), r < 0 ? r >>> 0 : r; case t.TYPES.int64: case t.TYPES.sint64: case t.TYPES.sfixed64: if (t.Long) try { return n(r, !1) } catch (e) { i(typeof r, e.message) } else i(typeof r, "requires Long.js"); case t.TYPES.uint64: case t.TYPES.fixed64: if (t.Long) try { return n(r, !0) } catch (e) { i(typeof r, e.message) } else i(typeof r, "requires Long.js"); case t.TYPES.bool: return "boolean" != typeof r && i(typeof r, "not a boolean"), r; case t.TYPES.float: case t.TYPES.double: return "number" != typeof r && i(typeof r, "not a number"), r; case t.TYPES.string: return "string" == typeof r || r && r instanceof String || i(typeof r, "not a string"), "" + r; case t.TYPES.bytes: return e.isByteBuffer(r) ? r : e.wrap(r, "base64"); case t.TYPES.enum: var s = this.resolvedType.getChildren(t.Reflect.Enum.Value); for (u = 0; u < s.length; u++) { if (s[u].name == r) return s[u].id; if (s[u].id == r) return s[u].id } if ("proto3" === this.syntax) return ("number" != typeof r || r === r && r % 1 != 0) && i(typeof r, "not an integer"), (r > 4294967295 || r < 0) && i(typeof r, "not in range for uint32"), r; i(r, "not a valid enum value"); case t.TYPES.group: case t.TYPES.message: if (r && "object" == typeof r || i(typeof r, "object expected"), r instanceof this.resolvedType.clazz) return r; if (r instanceof t.Builder.Message) { var a = {}; for (var u in r) r.hasOwnProperty(u) && (a[u] = r[u]); r = a } return new this.resolvedType.clazz(r) }throw Error("[INTERNAL] Illegal value for " + this.toString(!0) + ": " + r + " (undefined type " + this.type + ")") }, c.calculateLength = function (n, r) { if (null === r) return 0; var i; switch (this.type) { case t.TYPES.int32: return r < 0 ? e.calculateVarint64(r) : e.calculateVarint32(r); case t.TYPES.uint32: return e.calculateVarint32(r); case t.TYPES.sint32: return e.calculateVarint32(e.zigZagEncode32(r)); case t.TYPES.fixed32: case t.TYPES.sfixed32: case t.TYPES.float: return 4; case t.TYPES.int64: case t.TYPES.uint64: return e.calculateVarint64(r); case t.TYPES.sint64: return e.calculateVarint64(e.zigZagEncode64(r)); case t.TYPES.fixed64: case t.TYPES.sfixed64: return 8; case t.TYPES.bool: return 1; case t.TYPES.enum: return e.calculateVarint32(r); case t.TYPES.double: return 8; case t.TYPES.string: return i = e.calculateUTF8Bytes(r), e.calculateVarint32(i) + i; case t.TYPES.bytes: if (r.remaining() < 0) throw Error("Illegal value for " + this.toString(!0) + ": " + r.remaining() + " bytes remaining"); return e.calculateVarint32(r.remaining()) + r.remaining(); case t.TYPES.message: return i = this.resolvedType.calculate(r), e.calculateVarint32(i) + i; case t.TYPES.group: return (i = this.resolvedType.calculate(r)) + e.calculateVarint32(n << 3 | t.WIRE_TYPES.ENDGROUP) }throw Error("[INTERNAL] Illegal value to encode in " + this.toString(!0) + ": " + r + " (unknown type)") }, c.encodeValue = function (n, r, i) { if (null === r) return i; switch (this.type) { case t.TYPES.int32: r < 0 ? i.writeVarint64(r) : i.writeVarint32(r); break; case t.TYPES.uint32: i.writeVarint32(r); break; case t.TYPES.sint32: i.writeVarint32ZigZag(r); break; case t.TYPES.fixed32: i.writeUint32(r); break; case t.TYPES.sfixed32: i.writeInt32(r); break; case t.TYPES.int64: case t.TYPES.uint64: i.writeVarint64(r); break; case t.TYPES.sint64: i.writeVarint64ZigZag(r); break; case t.TYPES.fixed64: i.writeUint64(r); break; case t.TYPES.sfixed64: i.writeInt64(r); break; case t.TYPES.bool: "string" == typeof r ? i.writeVarint32("false" === r.toLowerCase() ? 0 : !!r) : i.writeVarint32(r ? 1 : 0); break; case t.TYPES.enum: i.writeVarint32(r); break; case t.TYPES.float: i.writeFloat32(r); break; case t.TYPES.double: i.writeFloat64(r); break; case t.TYPES.string: i.writeVString(r); break; case t.TYPES.bytes: if (r.remaining() < 0) throw Error("Illegal value for " + this.toString(!0) + ": " + r.remaining() + " bytes remaining"); var o = r.offset; i.writeVarint32(r.remaining()), i.append(r), r.offset = o; break; case t.TYPES.message: var s = (new e).LE(); this.resolvedType.encode(r, s), i.writeVarint32(s.offset), i.append(s.flip()); break; case t.TYPES.group: this.resolvedType.encode(r, i), i.writeVarint32(n << 3 | t.WIRE_TYPES.ENDGROUP); break; default: throw Error("[INTERNAL] Illegal value to encode in " + this.toString(!0) + ": " + r + " (unknown type)") }return i }, c.decode = function (e, n, r) { if (n != this.type.wireType) throw Error("Unexpected wire type for element"); var i, o; switch (this.type) { case t.TYPES.int32: return 0 | e.readVarint32(); case t.TYPES.uint32: return e.readVarint32() >>> 0; case t.TYPES.sint32: return 0 | e.readVarint32ZigZag(); case t.TYPES.fixed32: return e.readUint32() >>> 0; case t.TYPES.sfixed32: return 0 | e.readInt32(); case t.TYPES.int64: return e.readVarint64(); case t.TYPES.uint64: return e.readVarint64().toUnsigned(); case t.TYPES.sint64: return e.readVarint64ZigZag(); case t.TYPES.fixed64: return e.readUint64(); case t.TYPES.sfixed64: return e.readInt64(); case t.TYPES.bool: return !!e.readVarint32(); case t.TYPES.enum: return e.readVarint32(); case t.TYPES.float: return e.readFloat(); case t.TYPES.double: return e.readDouble(); case t.TYPES.string: return e.readVString(); case t.TYPES.bytes: if (o = e.readVarint32(), e.remaining() < o) throw Error("Illegal number of bytes for " + this.toString(!0) + ": " + o + " required but got only " + e.remaining()); return i = e.clone(), i.limit = i.offset + o, e.offset += o, i; case t.TYPES.message: return o = e.readVarint32(), this.resolvedType.decode(e, o); case t.TYPES.group: return this.resolvedType.decode(e, -1, r) }throw Error("[INTERNAL] Illegal decode type") }, c.valueFromString = function (n) { if (!this.isMapKey) throw Error("valueFromString() called on non-map-key element"); switch (this.type) { case t.TYPES.int32: case t.TYPES.sint32: case t.TYPES.sfixed32: case t.TYPES.uint32: case t.TYPES.fixed32: return this.verifyValue(parseInt(n)); case t.TYPES.int64: case t.TYPES.sint64: case t.TYPES.sfixed64: case t.TYPES.uint64: case t.TYPES.fixed64: return this.verifyValue(n); case t.TYPES.bool: return "true" === n; case t.TYPES.string: return this.verifyValue(n); case t.TYPES.bytes: return e.fromBinary(n) } }, c.valueToString = function (e) { if (!this.isMapKey) throw Error("valueToString() called on non-map-key element"); return this.type === t.TYPES.bytes ? e.toString("binary") : e.toString() }, i.Element = f; var l = function (e, t, n, r, i, o) { a.call(this, e, t, n, r, o), this.className = "Message", this.extensions = void 0, this.clazz = null, this.isGroup = !!i, this._fields = null, this._fieldsById = null, this._fieldsByName = null }, h = l.prototype = Object.create(a.prototype); h.build = function (n) { if (this.clazz && !n) return this.clazz; var r = function (t, n) { function r(n, i, o, s) { if (null === n || "object" != typeof n) { if (s && s instanceof t.Reflect.Enum) { var a = t.Reflect.Enum.getName(s.object, n); if (null !== a) return a } return n } if (e.isByteBuffer(n)) return i ? n.toBase64() : n.toBuffer(); if (t.Long.isLong(n)) return o ? n.toString() : t.Long.fromValue(n); var u; if (Array.isArray(n)) return u = [], n.forEach(function (e, t) { u[t] = r(e, i, o, s) }), u; if (u = {}, n instanceof t.Map) { for (var f = n.entries(), c = f.next(); !c.done; c = f.next())u[n.keyElem.valueToString(c.value[0])] = r(c.value[1], i, o, n.valueElem.resolvedType); return u } var l = n.$type, h = void 0; for (var p in n) n.hasOwnProperty(p) && (l && (h = l.getChild(p)) ? u[p] = r(n[p], i, o, h.resolvedType) : u[p] = r(n[p], i, o)); return u } var i = n.getChildren(t.Reflect.Message.Field), o = n.getChildren(t.Reflect.Message.OneOf), s = function (r, a) { t.Builder.Message.call(this); for (var u = 0, f = o.length; u < f; ++u)this[o[u].name] = null; for (u = 0, f = i.length; u < f; ++u) { var c = i[u]; this[c.name] = c.repeated ? [] : c.map ? new t.Map(c) : null, !c.required && "proto3" !== n.syntax || null === c.defaultValue || (this[c.name] = c.defaultValue) } if (arguments.length > 0) { var l; if (1 !== arguments.length || null === r || "object" != typeof r || !("function" != typeof r.encode || r instanceof s) || Array.isArray(r) || r instanceof t.Map || e.isByteBuffer(r) || r instanceof ArrayBuffer || t.Long && r instanceof t.Long) for (u = 0, f = arguments.length; u < f; ++u)void 0 !== (l = arguments[u]) && this.$set(i[u].name, l); else this.$set(r) } }, a = s.prototype = Object.create(t.Builder.Message.prototype); a.add = function (e, r, i) { var o = n._fieldsByName[e]; if (!i) { if (!o) throw Error(this + "#" + e + " is undefined"); if (!(o instanceof t.Reflect.Message.Field)) throw Error(this + "#" + e + " is not a field: " + o.toString(!0)); if (!o.repeated) throw Error(this + "#" + e + " is not a repeated field"); r = o.verifyValue(r, !0) } return null === this[e] && (this[e] = []), this[e].push(r), this }, a.$add = a.add, a.set = function (e, r, i) { if (e && "object" == typeof e) { i = r; for (var o in e) e.hasOwnProperty(o) && void 0 !== (r = e[o]) && void 0 === n._oneofsByName[o] && this.$set(o, r, i); return this } var s = n._fieldsByName[e]; if (i) this[e] = r; else { if (!s) throw Error(this + "#" + e + " is not a field: undefined"); if (!(s instanceof t.Reflect.Message.Field)) throw Error(this + "#" + e + " is not a field: " + s.toString(!0)); this[s.name] = r = s.verifyValue(r) } if (s && s.oneof) { var a = this[s.oneof.name]; null !== r ? (null !== a && a !== s.name && (this[a] = null), this[s.oneof.name] = s.name) : a === e && (this[s.oneof.name] = null) } return this }, a.$set = a.set, a.get = function (e, r) { if (r) return this[e]; var i = n._fieldsByName[e]; if (!(i && i instanceof t.Reflect.Message.Field)) throw Error(this + "#" + e + " is not a field: undefined"); if (!(i instanceof t.Reflect.Message.Field)) throw Error(this + "#" + e + " is not a field: " + i.toString(!0)); return this[i.name] }, a.$get = a.get; for (var u = 0; u < i.length; u++) { var f = i[u]; f instanceof t.Reflect.Message.ExtensionField || n.builder.options.populateAccessors && function (e) { var t = e.originalName.replace(/(_[a-zA-Z])/g, function (e) { return e.toUpperCase().replace("_", "") }); t = t.substring(0, 1).toUpperCase() + t.substring(1); var r = e.originalName.replace(/([A-Z])/g, function (e) { return "_" + e }), i = function (t, n) { return this[e.name] = n ? t : e.verifyValue(t), this }, o = function () { return this[e.name] }; null === n.getChild("set" + t) && (a["set" + t] = i), null === n.getChild("set_" + r) && (a["set_" + r] = i), null === n.getChild("get" + t) && (a["get" + t] = o), null === n.getChild("get_" + r) && (a["get_" + r] = o) }(f) } a.encode = function (t, r) { "boolean" == typeof t && (r = t, t = void 0); var i = !1; t || (t = new e, i = !0); var o = t.littleEndian; try { return n.encode(this, t.LE(), r), (i ? t.flip() : t).LE(o) } catch (e) { throw t.LE(o), e } }, s.encode = function (e, t, n) { return new s(e).encode(t, n) }, a.calculate = function () { return n.calculate(this) }, a.encodeDelimited = function (t, r) { var i = !1; t || (t = new e, i = !0); var o = (new e).LE(); return n.encode(this, o, r).flip(), t.writeVarint32(o.remaining()), t.append(o), i ? t.flip() : t }, a.encodeAB = function () { try { return this.encode().toArrayBuffer() } catch (e) { throw e.encoded && (e.encoded = e.encoded.toArrayBuffer()), e } }, a.toArrayBuffer = a.encodeAB, a.encodeNB = function () { try { return this.encode().toBuffer() } catch (e) { throw e.encoded && (e.encoded = e.encoded.toBuffer()), e } }, a.toBuffer = a.encodeNB, a.encode64 = function () { try { return this.encode().toBase64() } catch (e) { throw e.encoded && (e.encoded = e.encoded.toBase64()), e } }, a.toBase64 = a.encode64, a.encodeHex = function () { try { return this.encode().toHex() } catch (e) { throw e.encoded && (e.encoded = e.encoded.toHex()), e } }, a.toHex = a.encodeHex, a.toRaw = function (e, t) { return r(this, !!e, !!t, this.$type) }, a.encodeJSON = function () { return JSON.stringify(r(this, !0, !0, this.$type)) }, s.decode = function (t, r, i) { "string" == typeof r && (i = r, r = -1), "string" == typeof t ? t = e.wrap(t, i || "base64") : e.isByteBuffer(t) || (t = e.wrap(t)); var o = t.littleEndian; try { var s = n.decode(t.LE(), r); return t.LE(o), s } catch (e) { throw t.LE(o), e } }, s.decodeDelimited = function (t, r) { if ("string" == typeof t ? t = e.wrap(t, r || "base64") : e.isByteBuffer(t) || (t = e.wrap(t)), t.remaining() < 1) return null; var i = t.offset, o = t.readVarint32(); if (t.remaining() < o) return t.offset = i, null; try { var s = n.decode(t.slice(t.offset, t.offset + o).LE()); return t.offset += o, s } catch (e) { throw t.offset += o, e } }, s.decode64 = function (e) { return s.decode(e, "base64") }, s.decodeHex = function (e) { return s.decode(e, "hex") }, s.decodeJSON = function (e) { return new s(JSON.parse(e)) }, a.toString = function () { return n.toString() }; return Object.defineProperty && (Object.defineProperty(s, "$options", { value: n.buildOpt() }), Object.defineProperty(a, "$options", { value: s.$options }), Object.defineProperty(s, "$type", { value: n }), Object.defineProperty(a, "$type", { value: n })), s }(t, this); this._fields = [], this._fieldsById = {}, this._fieldsByName = {}, this._oneofsByName = {}; for (var i, o = 0, s = this.children.length; o < s; o++)if ((i = this.children[o]) instanceof y || i instanceof l || i instanceof b) { if (r.hasOwnProperty(i.name)) throw Error("Illegal reflect child of " + this.toString(!0) + ": " + i.toString(!0) + " cannot override static property '" + i.name + "'"); r[i.name] = i.build() } else if (i instanceof l.Field) i.build(), this._fields.push(i), this._fieldsById[i.id] = i, this._fieldsByName[i.name] = i; else if (i instanceof l.OneOf) this._oneofsByName[i.name] = i; else if (!(i instanceof l.OneOf || i instanceof v)) throw Error("Illegal reflect child of " + this.toString(!0) + ": " + this.children[o].toString(!0)); return this.clazz = r }, h.encode = function (e, t, n) { for (var r, i, o = null, s = 0, a = this._fields.length; s < a; ++s)i = e[(r = this._fields[s]).name], r.required && null === i ? null === o && (o = r) : r.encode(n ? i : r.verifyValue(i), t, e); if (null !== o) { var u = Error("Missing at least one required field for " + this.toString(!0) + ": " + o); throw u.encoded = t, u } return t }, h.calculate = function (e) { for (var t, n, r = 0, i = 0, o = this._fields.length; i < o; ++i) { if (t = this._fields[i], n = e[t.name], t.required && null === n) throw Error("Missing at least one required field for " + this.toString(!0) + ": " + t); r += t.calculate(n, e) } return r }, h.decode = function (e, n, i) { "number" != typeof n && (n = -1); for (var o, s, a, u, f = e.offset, c = new this.clazz; e.offset < f + n || -1 === n && e.remaining() > 0;) { if (o = e.readVarint32(), s = 7 & o, a = o >>> 3, s === t.WIRE_TYPES.ENDGROUP) { if (a !== i) throw Error("Illegal group end indicator for " + this.toString(!0) + ": " + a + " (" + (i ? i + " expected" : "not a group") + ")"); break } if (u = this._fieldsById[a]) { if (u.repeated && !u.options.packed) c[u.name].push(u.decode(s, e)); else if (u.map) { var l = u.decode(s, e); c[u.name].set(l[0], l[1]) } else if (c[u.name] = u.decode(s, e), u.oneof) { var h = c[u.oneof.name]; null !== h && h !== u.name && (c[h] = null), c[u.oneof.name] = u.name } } else switch (s) { case t.WIRE_TYPES.VARINT: e.readVarint32(); break; case t.WIRE_TYPES.BITS32: e.offset += 4; break; case t.WIRE_TYPES.BITS64: e.offset += 8; break; case t.WIRE_TYPES.LDELIM: var p = e.readVarint32(); e.offset += p; break; case t.WIRE_TYPES.STARTGROUP: for (; r(a, e);); break; default: throw Error("Illegal wire type for unknown field " + a + " in " + this.toString(!0) + "#decode: " + s) } } for (var d = 0, m = this._fields.length; d < m; ++d)if (u = this._fields[d], null === c[u.name]) if ("proto3" === this.syntax) c[u.name] = u.defaultValue; else { if (u.required) { var y = Error("Missing at least one required field for " + this.toString(!0) + ": " + u.name); throw y.decoded = c, y } t.populateDefaults && null !== u.defaultValue && (c[u.name] = u.defaultValue) } return c }, i.Message = l; var p = function (e, n, r, i, s, a, u, f, c, h) { o.call(this, e, n, a), this.className = "Message.Field", this.required = "required" === r, this.repeated = "repeated" === r, this.map = "map" === r, this.keyType = i || null, this.type = s, this.resolvedType = null, this.id = u, this.options = f || {}, this.defaultValue = null, this.oneof = c || null, this.syntax = h || "proto2", this.originalName = this.name, this.element = null, this.keyElement = null, !this.builder.options.convertFieldsToCamelCase || this instanceof l.ExtensionField || (this.name = t.Util.toCamelCase(this.name)) }, d = p.prototype = Object.create(o.prototype); d.build = function () { this.element = new f(this.type, this.resolvedType, !1, this.syntax, this.name), this.map && (this.keyElement = new f(this.keyType, void 0, !0, this.syntax, this.name)), "proto3" !== this.syntax || this.repeated || this.map ? void 0 !== this.options.default && (this.defaultValue = this.verifyValue(this.options.default)) : this.defaultValue = f.defaultFieldValue(this.type) }, d.verifyValue = function (e, n) { function r(e, t) { throw Error("Illegal value for " + i.toString(!0) + " of type " + i.type.name + ": " + e + " (" + t + ")") } n = n || !1; var i = this; if (null === e) return this.required && r(typeof e, "required"), "proto3" === this.syntax && this.type !== t.TYPES.message && r(typeof e, "proto3 field without field presence cannot be null"), null; var o; if (this.repeated && !n) { Array.isArray(e) || (e = [e]); var s = []; for (o = 0; o < e.length; o++)s.push(this.element.verifyValue(e[o])); return s } return this.map && !n ? e instanceof t.Map ? e : (e instanceof Object || r(typeof e, "expected ProtoBuf.Map or raw object for map field"), new t.Map(this, e)) : (!this.repeated && Array.isArray(e) && r(typeof e, "no array expected"), this.element.verifyValue(e)) }, d.hasWirePresence = function (e, n) { if ("proto3" !== this.syntax) return null !== e; if (this.oneof && n[this.oneof.name] === this.name) return !0; switch (this.type) { case t.TYPES.int32: case t.TYPES.sint32: case t.TYPES.sfixed32: case t.TYPES.uint32: case t.TYPES.fixed32: return 0 !== e; case t.TYPES.int64: case t.TYPES.sint64: case t.TYPES.sfixed64: case t.TYPES.uint64: case t.TYPES.fixed64: return 0 !== e.low || 0 !== e.high; case t.TYPES.bool: return e; case t.TYPES.float: case t.TYPES.double: return 0 !== e; case t.TYPES.string: return e.length > 0; case t.TYPES.bytes: return e.remaining() > 0; case t.TYPES.enum: return 0 !== e; case t.TYPES.message: return null !== e; default: return !0 } }, d.encode = function (n, r, i) { if (null === this.type || "object" != typeof this.type) throw Error("[INTERNAL] Unresolved type in " + this.toString(!0) + ": " + this.type); if (null === n || this.repeated && 0 == n.length) return r; try { if (this.repeated) { var o; if (this.options.packed && t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType) >= 0) { r.writeVarint32(this.id << 3 | t.WIRE_TYPES.LDELIM), r.ensureCapacity(r.offset += 1); var s = r.offset; for (o = 0; o < n.length; o++)this.element.encodeValue(this.id, n[o], r); var a = r.offset - s, u = e.calculateVarint32(a); if (u > 1) { var f = r.slice(s, r.offset); s += u - 1, r.offset = s, r.append(f) } r.writeVarint32(a, s - u) } else for (o = 0; o < n.length; o++)r.writeVarint32(this.id << 3 | this.type.wireType), this.element.encodeValue(this.id, n[o], r) } else this.map ? n.forEach(function (n, i, o) { var s = e.calculateVarint32(8 | this.keyType.wireType) + this.keyElement.calculateLength(1, i) + e.calculateVarint32(16 | this.type.wireType) + this.element.calculateLength(2, n); r.writeVarint32(this.id << 3 | t.WIRE_TYPES.LDELIM), r.writeVarint32(s), r.writeVarint32(8 | this.keyType.wireType), this.keyElement.encodeValue(1, i, r), r.writeVarint32(16 | this.type.wireType), this.element.encodeValue(2, n, r) }, this) : this.hasWirePresence(n, i) && (r.writeVarint32(this.id << 3 | this.type.wireType), this.element.encodeValue(this.id, n, r)) } catch (e) { throw Error("Illegal value for " + this.toString(!0) + ": " + n + " (" + e + ")") } return r }, d.calculate = function (n, r) { if (n = this.verifyValue(n), null === this.type || "object" != typeof this.type) throw Error("[INTERNAL] Unresolved type in " + this.toString(!0) + ": " + this.type); if (null === n || this.repeated && 0 == n.length) return 0; var i = 0; try { if (this.repeated) { var o, s; if (this.options.packed && t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType) >= 0) { for (i += e.calculateVarint32(this.id << 3 | t.WIRE_TYPES.LDELIM), s = 0, o = 0; o < n.length; o++)s += this.element.calculateLength(this.id, n[o]); i += e.calculateVarint32(s), i += s } else for (o = 0; o < n.length; o++)i += e.calculateVarint32(this.id << 3 | this.type.wireType), i += this.element.calculateLength(this.id, n[o]) } else this.map ? n.forEach(function (n, r, o) { var s = e.calculateVarint32(8 | this.keyType.wireType) + this.keyElement.calculateLength(1, r) + e.calculateVarint32(16 | this.type.wireType) + this.element.calculateLength(2, n); i += e.calculateVarint32(this.id << 3 | t.WIRE_TYPES.LDELIM), i += e.calculateVarint32(s), i += s }, this) : this.hasWirePresence(n, r) && (i += e.calculateVarint32(this.id << 3 | this.type.wireType), i += this.element.calculateLength(this.id, n)) } catch (e) { throw Error("Illegal value for " + this.toString(!0) + ": " + n + " (" + e + ")") } return i }, d.decode = function (e, n, r) { var i, o; if (!(!this.map && e == this.type.wireType || !r && this.repeated && this.options.packed && e == t.WIRE_TYPES.LDELIM || this.map && e == t.WIRE_TYPES.LDELIM)) throw Error("Illegal wire type for field " + this.toString(!0) + ": " + e + " (" + this.type.wireType + " expected)"); if (e == t.WIRE_TYPES.LDELIM && this.repeated && this.options.packed && t.PACKABLE_WIRE_TYPES.indexOf(this.type.wireType) >= 0 && !r) { o = n.readVarint32(), o = n.offset + o; for (var s = []; n.offset < o;)s.push(this.decode(this.type.wireType, n, !0)); return s } if (this.map) { var a = f.defaultFieldValue(this.keyType); if (i = f.defaultFieldValue(this.type), o = n.readVarint32(), n.remaining() < o) throw Error("Illegal number of bytes for " + this.toString(!0) + ": " + o + " required but got only " + n.remaining()); var u = n.clone(); for (u.limit = u.offset + o, n.offset += o; u.remaining() > 0;) { var c = u.readVarint32(); e = 7 & c; var l = c >>> 3; if (1 === l) a = this.keyElement.decode(u, e, l); else { if (2 !== l) throw Error("Unexpected tag in map field key/value submessage"); i = this.element.decode(u, e, l) } } return [a, i] } return this.element.decode(n, e, this.id) }, i.Message.Field = p; var m = function (e, t, n, r, i, o, s) { p.call(this, e, t, n, null, r, i, o, s), this.extension }; m.prototype = Object.create(p.prototype), i.Message.ExtensionField = m; i.Message.OneOf = function (e, t, n) { o.call(this, e, t, n), this.fields = [] }; var y = function (e, t, n, r, i) { a.call(this, e, t, n, r, i), this.className = "Enum", this.object = null }; y.getName = function (e, t) { for (var n, r = Object.keys(e), i = 0; i < r.length; ++i)if (e[n = r[i]] === t) return n; return null }, (y.prototype = Object.create(a.prototype)).build = function (e) { if (this.object && !e) return this.object; for (var n = new t.Builder.Enum, r = this.getChildren(y.Value), i = 0, o = r.length; i < o; ++i)n[r[i].name] = r[i].id; return Object.defineProperty && Object.defineProperty(n, "$options", { value: this.buildOpt(), enumerable: !1 }), this.object = n }, i.Enum = y; var g = function (e, t, n, r) { o.call(this, e, t, n), this.className = "Enum.Value", this.id = r }; g.prototype = Object.create(o.prototype), i.Enum.Value = g; var v = function (e, t, n, r) { o.call(this, e, t, n), this.field = r }; v.prototype = Object.create(o.prototype), i.Extension = v; var b = function (e, t, n, r) { a.call(this, e, t, n, r), this.className = "Service", this.clazz = null }; (b.prototype = Object.create(a.prototype)).build = function (n) { return this.clazz && !n ? this.clazz : this.clazz = function (t, n) { for (var r = function (e) { t.Builder.Service.call(this), this.rpcImpl = e || function (e, t, n) { setTimeout(n.bind(this, Error("Not implemented, see: https://github.com/dcodeIO/ProtoBuf.js/wiki/Services")), 0) } }, i = r.prototype = Object.create(t.Builder.Service.prototype), o = n.getChildren(t.Reflect.Service.RPCMethod), s = 0; s < o.length; s++)!function (t) { i[t.name] = function (r, i) { try { try { r = t.resolvedRequestType.clazz.decode(e.wrap(r)) } catch (e) { if (!(e instanceof TypeError)) throw e } if (null === r || "object" != typeof r) throw Error("Illegal arguments"); r instanceof t.resolvedRequestType.clazz || (r = new t.resolvedRequestType.clazz(r)), this.rpcImpl(t.fqn(), r, function (e, r) { if (e) i(e); else { null === r && (r = ""); try { r = t.resolvedResponseType.clazz.decode(r) } catch (e) { } r && r instanceof t.resolvedResponseType.clazz ? i(null, r) : i(Error("Illegal response type received in service method " + n.name + "#" + t.name)) } }) } catch (e) { setTimeout(i.bind(this, e), 0) } }, r[t.name] = function (e, n, i) { new r(e)[t.name](n, i) }, Object.defineProperty && (Object.defineProperty(r[t.name], "$options", { value: t.buildOpt() }), Object.defineProperty(i[t.name], "$options", { value: r[t.name].$options })) }(o[s]); return Object.defineProperty && (Object.defineProperty(r, "$options", { value: n.buildOpt() }), Object.defineProperty(i, "$options", { value: r.$options }), Object.defineProperty(r, "$type", { value: n }), Object.defineProperty(i, "$type", { value: n })), r }(t, this) }, i.Service = b; var w = function (e, t, n, r) { o.call(this, e, t, n), this.className = "Service.Method", this.options = r || {} }; (w.prototype = Object.create(o.prototype)).buildOpt = u.buildOpt, i.Service.Method = w; var _ = function (e, t, n, r, i, o, s, a) { w.call(this, e, t, n, a), this.className = "Service.RPCMethod", this.requestName = r, this.responseName = i, this.requestStream = o, this.responseStream = s, this.resolvedRequestType = null, this.resolvedResponseType = null }; return _.prototype = Object.create(w.prototype), i.Service.RPCMethod = _, i }(n), n.Builder = function (e, t, n) { function r(e) { e.messages && e.messages.forEach(function (t) { t.syntax = e.syntax, r(t) }), e.enums && e.enums.forEach(function (t) { t.syntax = e.syntax }) } var i = function (e) { this.ns = new n.Namespace(this, null, ""), this.ptr = this.ns, this.resolved = !1, this.result = null, this.files = {}, this.importRoot = null, this.options = e || {} }, o = i.prototype; return i.isMessage = function (e) { return "string" == typeof e.name && (void 0 === e.values && void 0 === e.rpc) }, i.isMessageField = function (e) { return "string" == typeof e.rule && "string" == typeof e.name && "string" == typeof e.type && void 0 !== e.id }, i.isEnum = function (e) { return "string" == typeof e.name && !(void 0 === e.values || !Array.isArray(e.values) || 0 === e.values.length) }, i.isService = function (e) { return !("string" != typeof e.name || "object" != typeof e.rpc || !e.rpc) }, i.isExtend = function (e) { return "string" == typeof e.ref }, o.reset = function () { return this.ptr = this.ns, this }, o.define = function (e) { if ("string" != typeof e || !t.TYPEREF.test(e)) throw Error("illegal namespace: " + e); return e.split(".").forEach(function (e) { var t = this.ptr.getChild(e); null === t && this.ptr.addChild(t = new n.Namespace(this, this.ptr, e)), this.ptr = t }, this), this }, o.create = function (t) { if (!t) return this; if (Array.isArray(t)) { if (0 === t.length) return this; t = t.slice() } else t = [t]; for (var r = [t]; r.length > 0;) { if (t = r.pop(), !Array.isArray(t)) throw Error("not a valid namespace: " + JSON.stringify(t)); for (; t.length > 0;) { var o = t.shift(); if (i.isMessage(o)) { var s = new n.Message(this, this.ptr, o.name, o.options, o.isGroup, o.syntax), a = {}; o.oneofs && Object.keys(o.oneofs).forEach(function (e) { s.addChild(a[e] = new n.Message.OneOf(this, s, e)) }, this), o.fields && o.fields.forEach(function (e) { if (null !== s.getChild(0 | e.id)) throw Error("duplicate or invalid field id in " + s.name + ": " + e.id); if (e.options && "object" != typeof e.options) throw Error("illegal field options in " + s.name + "#" + e.name); var t = null; if ("string" == typeof e.oneof && !(t = a[e.oneof])) throw Error("illegal oneof in " + s.name + "#" + e.name + ": " + e.oneof); e = new n.Message.Field(this, s, e.rule, e.keytype, e.type, e.name, e.id, e.options, t, o.syntax), t && t.fields.push(e), s.addChild(e) }, this); var u = []; if (o.enums && o.enums.forEach(function (e) { u.push(e) }), o.messages && o.messages.forEach(function (e) { u.push(e) }), o.services && o.services.forEach(function (e) { u.push(e) }), o.extensions && ("number" == typeof o.extensions[0] ? s.extensions = [o.extensions] : s.extensions = o.extensions), this.ptr.addChild(s), u.length > 0) { r.push(t), t = u, u = null, this.ptr = s, s = null; continue } u = null } else if (i.isEnum(o)) s = new n.Enum(this, this.ptr, o.name, o.options, o.syntax), o.values.forEach(function (e) { s.addChild(new n.Enum.Value(this, s, e.name, e.id)) }, this), this.ptr.addChild(s); else if (i.isService(o)) s = new n.Service(this, this.ptr, o.name, o.options), Object.keys(o.rpc).forEach(function (e) { var t = o.rpc[e]; s.addChild(new n.Service.RPCMethod(this, s, e, t.request, t.response, !!t.request_stream, !!t.response_stream, t.options)) }, this), this.ptr.addChild(s); else { if (!i.isExtend(o)) throw Error("not a valid definition: " + JSON.stringify(o)); if (s = this.ptr.resolve(o.ref, !0)) o.fields.forEach(function (t) { if (null !== s.getChild(0 | t.id)) throw Error("duplicate extended field id in " + s.name + ": " + t.id); if (s.extensions) { var r = !1; if (s.extensions.forEach(function (e) { t.id >= e[0] && t.id <= e[1] && (r = !0) }), !r) throw Error("illegal extended field id in " + s.name + ": " + t.id + " (not within valid ranges)") } var i = t.name; this.options.convertFieldsToCamelCase && (i = e.Util.toCamelCase(i)); var o = new n.Message.ExtensionField(this, s, t.rule, t.type, this.ptr.fqn() + "." + i, t.id, t.options), a = new n.Extension(this, this.ptr, t.name, o); o.extension = a, this.ptr.addChild(a), s.addChild(o) }, this); else if (!/\.?google\.protobuf\./.test(o.ref)) throw Error("extended message " + o.ref + " is not defined") } o = null, s = null } t = null, this.ptr = this.ptr.parent } return this.resolved = !1, this.result = null, this }, o.import = function (t, n) { var i = "/"; if ("string" == typeof n) { if (e.Util.IS_NODE && (n = Ri.resolve(n)), !0 === this.files[n]) return this.reset(); this.files[n] = !0 } else if ("object" == typeof n) { var o = n.root; e.Util.IS_NODE && (o = Ri.resolve(o)), (o.indexOf("\\") >= 0 || n.file.indexOf("\\") >= 0) && (i = "\\"); var s; if (s = e.Util.IS_NODE ? Ri.join(o, n.file) : o + i + n.file, !0 === this.files[s]) return this.reset(); this.files[s] = !0 } if (t.imports && t.imports.length > 0) { var a, u = !1; "object" == typeof n ? (this.importRoot = n.root, u = !0, a = this.importRoot, n = n.file, (a.indexOf("\\") >= 0 || n.indexOf("\\") >= 0) && (i = "\\")) : "string" == typeof n ? this.importRoot ? a = this.importRoot : n.indexOf("/") >= 0 ? "" === (a = n.replace(/\/[^\/]*$/, "")) && (a = "/") : n.indexOf("\\") >= 0 ? (a = n.replace(/\\[^\\]*$/, ""), i = "\\") : a = "." : a = null; for (var f = 0; f < t.imports.length; f++)if ("string" == typeof t.imports[f]) { if (!a) throw Error("cannot determine import root"); var c = t.imports[f]; if ("google/protobuf/descriptor.proto" === c) continue; if (c = e.Util.IS_NODE ? Ri.join(a, c) : a + i + c, !0 === this.files[c]) continue; /\.proto$/i.test(c) && !e.DotProto && (c = c.replace(/\.proto$/, ".json")); var l = e.Util.fetch(c); if (null === l) throw Error("failed to import '" + c + "' in '" + n + "': file not found"); /\.json$/i.test(c) ? this.import(JSON.parse(l + ""), c) : this.import(e.DotProto.Parser.parse(l), c) } else n ? /\.(\w+)$/.test(n) ? this.import(t.imports[f], n.replace(/^(.+)\.(\w+)$/, function (e, t, n) { return t + "_import" + f + "." + n })) : this.import(t.imports[f], n + "_import" + f) : this.import(t.imports[f]); u && (this.importRoot = null) } t.package && this.define(t.package), t.syntax && r(t); var h = this.ptr; return t.options && Object.keys(t.options).forEach(function (e) { h.options[e] = t.options[e] }), t.messages && (this.create(t.messages), this.ptr = h), t.enums && (this.create(t.enums), this.ptr = h), t.services && (this.create(t.services), this.ptr = h), t.extends && this.create(t.extends), this.reset() }, o.resolveAll = function () { var r; if (null == this.ptr || "object" == typeof this.ptr.type) return this; if (this.ptr instanceof n.Namespace) this.ptr.children.forEach(function (e) { this.ptr = e, this.resolveAll() }, this); else if (this.ptr instanceof n.Message.Field) { if (t.TYPE.test(this.ptr.type)) this.ptr.type = e.TYPES[this.ptr.type]; else { if (!t.TYPEREF.test(this.ptr.type)) throw Error("illegal type reference in " + this.ptr.toString(!0) + ": " + this.ptr.type); if (!(r = (this.ptr instanceof n.Message.ExtensionField ? this.ptr.extension.parent : this.ptr.parent).resolve(this.ptr.type, !0))) throw Error("unresolvable type reference in " + this.ptr.toString(!0) + ": " + this.ptr.type); if (this.ptr.resolvedType = r, r instanceof n.Enum) { if (this.ptr.type = e.TYPES.enum, "proto3" === this.ptr.syntax && "proto3" !== r.syntax) throw Error("proto3 message cannot reference proto2 enum") } else { if (!(r instanceof n.Message)) throw Error("illegal type reference in " + this.ptr.toString(!0) + ": " + this.ptr.type); this.ptr.type = r.isGroup ? e.TYPES.group : e.TYPES.message } } if (this.ptr.map) { if (!t.TYPE.test(this.ptr.keyType)) throw Error("illegal key type for map field in " + this.ptr.toString(!0) + ": " + this.ptr.keyType); this.ptr.keyType = e.TYPES[this.ptr.keyType] } "proto3" === this.ptr.syntax && this.ptr.repeated && void 0 === this.ptr.options.packed && -1 !== e.PACKABLE_WIRE_TYPES.indexOf(this.ptr.type.wireType) && (this.ptr.options.packed = !0) } else if (this.ptr instanceof e.Reflect.Service.Method) { if (!(this.ptr instanceof e.Reflect.Service.RPCMethod)) throw Error("illegal service type in " + this.ptr.toString(!0)); if (!((r = this.ptr.parent.resolve(this.ptr.requestName, !0)) && r instanceof e.Reflect.Message)) throw Error("Illegal type reference in " + this.ptr.toString(!0) + ": " + this.ptr.requestName); if (this.ptr.resolvedRequestType = r, !((r = this.ptr.parent.resolve(this.ptr.responseName, !0)) && r instanceof e.Reflect.Message)) throw Error("Illegal type reference in " + this.ptr.toString(!0) + ": " + this.ptr.responseName); this.ptr.resolvedResponseType = r } else if (!(this.ptr instanceof e.Reflect.Message.OneOf || this.ptr instanceof e.Reflect.Extension || this.ptr instanceof e.Reflect.Enum.Value)) throw Error("illegal object in namespace: " + typeof this.ptr + ": " + this.ptr); return this.reset() }, o.build = function (e) { if (this.reset(), this.resolved || (this.resolveAll(), this.resolved = !0, this.result = null), null === this.result && (this.result = this.ns.build()), !e) return this.result; for (var t = "string" == typeof e ? e.split(".") : e, n = this.result, r = 0; r < t.length; r++) { if (!n[t[r]]) { n = null; break } n = n[t[r]] } return n }, o.lookup = function (e, t) { return e ? this.ns.resolve(e, t) : this.ns }, o.toString = function () { return "Builder" }, i.Message = function () { }, i.Enum = function () { }, i.Service = function () { }, i }(n, n.Lang, n.Reflect), n.Map = function (e, t) { function n(e) { var t = 0; return { next: function () { return t < e.length ? { done: !1, value: e[t++] } : { done: !0 } } } } var r = function (e, n) { if (!e.map) throw Error("field is not a map"); if (this.field = e, this.keyElem = new t.Element(e.keyType, null, !0, e.syntax), this.valueElem = new t.Element(e.type, e.resolvedType, !1, e.syntax), this.map = {}, Object.defineProperty(this, "size", { get: function () { return Object.keys(this.map).length } }), n) for (var r = Object.keys(n), i = 0; i < r.length; i++) { var o = this.keyElem.valueFromString(r[i]), s = this.valueElem.verifyValue(n[r[i]]); this.map[this.keyElem.valueToString(o)] = { key: o, value: s } } }, i = r.prototype; return i.clear = function () { this.map = {} }, i.delete = function (e) { var t = this.keyElem.valueToString(this.keyElem.verifyValue(e)), n = t in this.map; return delete this.map[t], n }, i.entries = function () { for (var e, t = [], r = Object.keys(this.map), i = 0; i < r.length; i++)t.push([(e = this.map[r[i]]).key, e.value]); return n(t) }, i.keys = function () { for (var e = [], t = Object.keys(this.map), r = 0; r < t.length; r++)e.push(this.map[t[r]].key); return n(e) }, i.values = function () { for (var e = [], t = Object.keys(this.map), r = 0; r < t.length; r++)e.push(this.map[t[r]].value); return n(e) }, i.forEach = function (e, t) { for (var n, r = Object.keys(this.map), i = 0; i < r.length; i++)e.call(t, (n = this.map[r[i]]).value, n.key, this) }, i.set = function (e, t) { var n = this.keyElem.verifyValue(e), r = this.valueElem.verifyValue(t); return this.map[this.keyElem.valueToString(n)] = { key: n, value: r }, this }, i.get = function (e) { var t = this.keyElem.valueToString(this.keyElem.verifyValue(e)); if (t in this.map) return this.map[t].value }, i.has = function (e) { return this.keyElem.valueToString(this.keyElem.verifyValue(e)) in this.map }, r }(0, n.Reflect), n.newBuilder = function (e) { return void 0 === (e = e || {}).convertFieldsToCamelCase && (e.convertFieldsToCamelCase = n.convertFieldsToCamelCase), void 0 === e.populateAccessors && (e.populateAccessors = n.populateAccessors), new n.Builder(e) }, n.loadJson = function (e, t, r) { return ("string" == typeof t || t && "string" == typeof t.file && "string" == typeof t.root) && (r = t, t = null), t && "object" == typeof t || (t = n.newBuilder()), "string" == typeof e && (e = JSON.parse(e)), t.import(e, r), t.resolveAll(), t }, n.loadJsonFile = function (e, t, r) { if (t && "object" == typeof t ? (r = t, t = null) : t && "function" == typeof t || (t = null), t) return n.Util.fetch("string" == typeof e ? e : e.root + "/" + e.file, function (i) { if (null !== i) try { t(null, n.loadJson(JSON.parse(i), r, e)) } catch (e) { t(e) } else t(Error("Failed to fetch file")) }); var i = n.Util.fetch("object" == typeof e ? e.root + "/" + e.file : e); return null === i ? null : n.loadJson(JSON.parse(i), r, e) }, n }) }).newBuilder({}).import({ package: "push_server.messages2", syntax: "proto2", options: { objc_class_prefix: "AVIM" }, messages: [{ name: "JsonObjectMessage", syntax: "proto2", fields: [{ rule: "required", type: "string", name: "data", id: 1 }] }, { name: "UnreadTuple", syntax: "proto2", fields: [{ rule: "required", type: "string", name: "cid", id: 1 }, { rule: "required", type: "int32", name: "unread", id: 2 }, { rule: "optional", type: "string", name: "mid", id: 3 }, { rule: "optional", type: "int64", name: "timestamp", id: 4 }, { rule: "optional", type: "string", name: "from", id: 5 }, { rule: "optional", type: "string", name: "data", id: 6 }, { rule: "optional", type: "int64", name: "patchTimestamp", id: 7 }, { rule: "optional", type: "bool", name: "mentioned", id: 8 }, { rule: "optional", type: "bytes", name: "binaryMsg", id: 9 }] }, { name: "LogItem", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "from", id: 1 }, { rule: "optional", type: "string", name: "data", id: 2 }, { rule: "optional", type: "int64", name: "timestamp", id: 3 }, { rule: "optional", type: "string", name: "msgId", id: 4 }, { rule: "optional", type: "int64", name: "ackAt", id: 5 }, { rule: "optional", type: "int64", name: "readAt", id: 6 }, { rule: "optional", type: "int64", name: "patchTimestamp", id: 7 }, { rule: "optional", type: "bool", name: "mentionAll", id: 8 }, { rule: "repeated", type: "string", name: "mentionPids", id: 9 }, { rule: "optional", type: "bool", name: "bin", id: 10 }] }, { name: "ConvProperty", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "pid", id: 1 }, { rule: "optional", type: "string", name: "role", id: 2 }, { rule: "optional", type: "string", name: "propertyId", id: 3 }] }, { name: "DataCommand", syntax: "proto2", fields: [{ rule: "repeated", type: "string", name: "ids", id: 1 }, { rule: "repeated", type: "JsonObjectMessage", name: "msg", id: 2 }, { rule: "optional", type: "bool", name: "offline", id: 3 }] }, { name: "SessionCommand", syntax: "proto2", fields: [{ rule: "optional", type: "int64", name: "t", id: 1 }, { rule: "optional", type: "string", name: "n", id: 2 }, { rule: "optional", type: "string", name: "s", id: 3 }, { rule: "optional", type: "string", name: "ua", id: 4 }, { rule: "optional", type: "bool", name: "r", id: 5 }, { rule: "optional", type: "string", name: "tag", id: 6 }, { rule: "optional", type: "string", name: "deviceId", id: 7 }, { rule: "repeated", type: "string", name: "sessionPeerIds", id: 8 }, { rule: "repeated", type: "string", name: "onlineSessionPeerIds", id: 9 }, { rule: "optional", type: "string", name: "st", id: 10 }, { rule: "optional", type: "int32", name: "stTtl", id: 11 }, { rule: "optional", type: "int32", name: "code", id: 12 }, { rule: "optional", type: "string", name: "reason", id: 13 }, { rule: "optional", type: "string", name: "deviceToken", id: 14 }, { rule: "optional", type: "bool", name: "sp", id: 15 }, { rule: "optional", type: "string", name: "detail", id: 16 }, { rule: "optional", type: "int64", name: "lastUnreadNotifTime", id: 17 }, { rule: "optional", type: "int64", name: "lastPatchTime", id: 18 }, { rule: "optional", type: "int64", name: "configBitmap", id: 19 }] }, { name: "ErrorCommand", syntax: "proto2", fields: [{ rule: "required", type: "int32", name: "code", id: 1 }, { rule: "required", type: "string", name: "reason", id: 2 }, { rule: "optional", type: "int32", name: "appCode", id: 3 }, { rule: "optional", type: "string", name: "detail", id: 4 }] }, { name: "DirectCommand", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "msg", id: 1 }, { rule: "optional", type: "string", name: "uid", id: 2 }, { rule: "optional", type: "string", name: "fromPeerId", id: 3 }, { rule: "optional", type: "int64", name: "timestamp", id: 4 }, { rule: "optional", type: "bool", name: "offline", id: 5 }, { rule: "optional", type: "bool", name: "hasMore", id: 6 }, { rule: "repeated", type: "string", name: "toPeerIds", id: 7 }, { rule: "optional", type: "bool", name: "r", id: 10 }, { rule: "optional", type: "string", name: "cid", id: 11 }, { rule: "optional", type: "string", name: "id", id: 12 }, { rule: "optional", type: "bool", name: "transient", id: 13 }, { rule: "optional", type: "string", name: "dt", id: 14 }, { rule: "optional", type: "string", name: "roomId", id: 15 }, { rule: "optional", type: "string", name: "pushData", id: 16 }, { rule: "optional", type: "bool", name: "will", id: 17 }, { rule: "optional", type: "int64", name: "patchTimestamp", id: 18 }, { rule: "optional", type: "bytes", name: "binaryMsg", id: 19 }, { rule: "repeated", type: "string", name: "mentionPids", id: 20 }, { rule: "optional", type: "bool", name: "mentionAll", id: 21 }] }, { name: "AckCommand", syntax: "proto2", fields: [{ rule: "optional", type: "int32", name: "code", id: 1 }, { rule: "optional", type: "string", name: "reason", id: 2 }, { rule: "optional", type: "string", name: "mid", id: 3 }, { rule: "optional", type: "string", name: "cid", id: 4 }, { rule: "optional", type: "int64", name: "t", id: 5 }, { rule: "optional", type: "string", name: "uid", id: 6 }, { rule: "optional", type: "int64", name: "fromts", id: 7 }, { rule: "optional", type: "int64", name: "tots", id: 8 }, { rule: "optional", type: "string", name: "type", id: 9 }, { rule: "repeated", type: "string", name: "ids", id: 10 }, { rule: "optional", type: "int32", name: "appCode", id: 11 }] }, { name: "UnreadCommand", syntax: "proto2", fields: [{ rule: "repeated", type: "UnreadTuple", name: "convs", id: 1 }, { rule: "optional", type: "int64", name: "notifTime", id: 2 }] }, { name: "ConvCommand", syntax: "proto2", fields: [{ rule: "repeated", type: "string", name: "m", id: 1 }, { rule: "optional", type: "bool", name: "transient", id: 2 }, { rule: "optional", type: "bool", name: "unique", id: 3 }, { rule: "optional", type: "string", name: "cid", id: 4 }, { rule: "optional", type: "string", name: "cdate", id: 5 }, { rule: "optional", type: "string", name: "initBy", id: 6 }, { rule: "optional", type: "string", name: "sort", id: 7 }, { rule: "optional", type: "int32", name: "limit", id: 8 }, { rule: "optional", type: "int32", name: "skip", id: 9 }, { rule: "optional", type: "int32", name: "flag", id: 10 }, { rule: "optional", type: "int32", name: "count", id: 11 }, { rule: "optional", type: "string", name: "udate", id: 12 }, { rule: "optional", type: "int64", name: "t", id: 13 }, { rule: "optional", type: "string", name: "n", id: 14 }, { rule: "optional", type: "string", name: "s", id: 15 }, { rule: "optional", type: "bool", name: "statusSub", id: 16 }, { rule: "optional", type: "bool", name: "statusPub", id: 17 }, { rule: "optional", type: "int32", name: "statusTTL", id: 18 }, { rule: "optional", type: "string", name: "uniqueId", id: 19 }, { rule: "optional", type: "string", name: "targetClientId", id: 20 }, { rule: "optional", type: "int64", name: "maxReadTimestamp", id: 21 }, { rule: "optional", type: "int64", name: "maxAckTimestamp", id: 22 }, { rule: "optional", type: "bool", name: "queryAllMembers", id: 23 }, { rule: "repeated", type: "MaxReadTuple", name: "maxReadTuples", id: 24 }, { rule: "repeated", type: "string", name: "cids", id: 25 }, { rule: "optional", type: "ConvProperty", name: "property", id: 26 }, { rule: "optional", type: "bool", name: "tempConv", id: 27 }, { rule: "optional", type: "int32", name: "tempConvTTL", id: 28 }, { rule: "optional", type: "string", name: "tempConvId", id: 29 }, { rule: "repeated", type: "string", name: "convBlockedPids", id: 30 }, { rule: "repeated", type: "string", name: "clientBlockedPids", id: 31 }, { rule: "repeated", type: "string", name: "allowedPids", id: 32 }, { rule: "optional", type: "JsonObjectMessage", name: "results", id: 100 }, { rule: "optional", type: "JsonObjectMessage", name: "where", id: 101 }, { rule: "optional", type: "JsonObjectMessage", name: "attr", id: 103 }] }, { name: "RoomCommand", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "roomId", id: 1 }, { rule: "optional", type: "string", name: "s", id: 2 }, { rule: "optional", type: "int64", name: "t", id: 3 }, { rule: "optional", type: "string", name: "n", id: 4 }, { rule: "optional", type: "bool", name: "transient", id: 5 }, { rule: "repeated", type: "string", name: "roomPeerIds", id: 6 }, { rule: "optional", type: "string", name: "byPeerId", id: 7 }] }, { name: "LogsCommand", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "cid", id: 1 }, { rule: "optional", type: "int32", name: "l", id: 2 }, { rule: "optional", type: "int32", name: "limit", id: 3 }, { rule: "optional", type: "int64", name: "t", id: 4 }, { rule: "optional", type: "int64", name: "tt", id: 5 }, { rule: "optional", type: "string", name: "tmid", id: 6 }, { rule: "optional", type: "string", name: "mid", id: 7 }, { rule: "optional", type: "string", name: "checksum", id: 8 }, { rule: "optional", type: "bool", name: "stored", id: 9 }, { rule: "optional", type: "QueryDirection", name: "direction", id: 10, options: { default: "OLD" } }, { rule: "optional", type: "bool", name: "tIncluded", id: 11 }, { rule: "optional", type: "bool", name: "ttIncluded", id: 12 }, { rule: "repeated", type: "LogItem", name: "logs", id: 105 }], enums: [{ name: "QueryDirection", syntax: "proto2", values: [{ name: "OLD", id: 1 }, { name: "NEW", id: 2 }] }] }, { name: "RcpCommand", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "id", id: 1 }, { rule: "optional", type: "string", name: "cid", id: 2 }, { rule: "optional", type: "int64", name: "t", id: 3 }, { rule: "optional", type: "bool", name: "read", id: 4 }, { rule: "optional", type: "string", name: "from", id: 5 }] }, { name: "ReadTuple", syntax: "proto2", fields: [{ rule: "required", type: "string", name: "cid", id: 1 }, { rule: "optional", type: "int64", name: "timestamp", id: 2 }, { rule: "optional", type: "string", name: "mid", id: 3 }] }, { name: "MaxReadTuple", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "pid", id: 1 }, { rule: "optional", type: "int64", name: "maxAckTimestamp", id: 2 }, { rule: "optional", type: "int64", name: "maxReadTimestamp", id: 3 }] }, { name: "ReadCommand", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "cid", id: 1 }, { rule: "repeated", type: "string", name: "cids", id: 2 }, { rule: "repeated", type: "ReadTuple", name: "convs", id: 3 }] }, { name: "PresenceCommand", syntax: "proto2", fields: [{ rule: "optional", type: "StatusType", name: "status", id: 1 }, { rule: "repeated", type: "string", name: "sessionPeerIds", id: 2 }, { rule: "optional", type: "string", name: "cid", id: 3 }] }, { name: "ReportCommand", syntax: "proto2", fields: [{ rule: "optional", type: "bool", name: "initiative", id: 1 }, { rule: "optional", type: "string", name: "type", id: 2 }, { rule: "optional", type: "string", name: "data", id: 3 }] }, { name: "PatchItem", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "cid", id: 1 }, { rule: "optional", type: "string", name: "mid", id: 2 }, { rule: "optional", type: "int64", name: "timestamp", id: 3 }, { rule: "optional", type: "bool", name: "recall", id: 4 }, { rule: "optional", type: "string", name: "data", id: 5 }, { rule: "optional", type: "int64", name: "patchTimestamp", id: 6 }, { rule: "optional", type: "string", name: "from", id: 7 }, { rule: "optional", type: "bytes", name: "binaryMsg", id: 8 }, { rule: "optional", type: "bool", name: "mentionAll", id: 9 }, { rule: "repeated", type: "string", name: "mentionPids", id: 10 }] }, { name: "PatchCommand", syntax: "proto2", fields: [{ rule: "repeated", type: "PatchItem", name: "patches", id: 1 }, { rule: "optional", type: "int64", name: "lastPatchTime", id: 2 }] }, { name: "PubsubCommand", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "cid", id: 1 }, { rule: "repeated", type: "string", name: "cids", id: 2 }, { rule: "optional", type: "string", name: "topic", id: 3 }, { rule: "optional", type: "string", name: "subtopic", id: 4 }, { rule: "repeated", type: "string", name: "topics", id: 5 }, { rule: "repeated", type: "string", name: "subtopics", id: 6 }, { rule: "optional", type: "JsonObjectMessage", name: "results", id: 7 }] }, { name: "BlacklistCommand", syntax: "proto2", fields: [{ rule: "optional", type: "string", name: "srcCid", id: 1 }, { rule: "repeated", type: "string", name: "toPids", id: 2 }, { rule: "optional", type: "string", name: "srcPid", id: 3 }, { rule: "repeated", type: "string", name: "toCids", id: 4 }, { rule: "optional", type: "int32", name: "limit", id: 5, options: { default: 100 } }, { rule: "optional", type: "int32", name: "offset", id: 6, options: { default: 0 } }, { rule: "optional", type: "string", name: "lastRk", id: 7 }, { rule: "repeated", type: "string", name: "blockedPids", id: 8 }, { rule: "repeated", type: "string", name: "blockedCids", id: 9 }] }, { name: "GenericCommand", syntax: "proto2", fields: [{ rule: "optional", type: "CommandType", name: "cmd", id: 1 }, { rule: "optional", type: "OpType", name: "op", id: 2 }, { rule: "optional", type: "string", name: "appId", id: 3 }, { rule: "optional", type: "string", name: "peerId", id: 4 }, { rule: "optional", type: "int32", name: "i", id: 5 }, { rule: "optional", type: "string", name: "installationId", id: 6 }, { rule: "optional", type: "int32", name: "priority", id: 7 }, { rule: "optional", type: "int32", name: "service", id: 8 }, { rule: "optional", type: "DataCommand", name: "dataMessage", id: 101 }, { rule: "optional", type: "SessionCommand", name: "sessionMessage", id: 102 }, { rule: "optional", type: "ErrorCommand", name: "errorMessage", id: 103 }, { rule: "optional", type: "DirectCommand", name: "directMessage", id: 104 }, { rule: "optional", type: "AckCommand", name: "ackMessage", id: 105 }, { rule: "optional", type: "UnreadCommand", name: "unreadMessage", id: 106 }, { rule: "optional", type: "ReadCommand", name: "readMessage", id: 107 }, { rule: "optional", type: "RcpCommand", name: "rcpMessage", id: 108 }, { rule: "optional", type: "LogsCommand", name: "logsMessage", id: 109 }, { rule: "optional", type: "ConvCommand", name: "convMessage", id: 110 }, { rule: "optional", type: "RoomCommand", name: "roomMessage", id: 111 }, { rule: "optional", type: "PresenceCommand", name: "presenceMessage", id: 112 }, { rule: "optional", type: "ReportCommand", name: "reportMessage", id: 113 }, { rule: "optional", type: "PatchCommand", name: "patchMessage", id: 114 }, { rule: "optional", type: "PubsubCommand", name: "pubsubMessage", id: 115 }, { rule: "optional", type: "BlacklistCommand", name: "blacklistMessage", id: 116 }] }], enums: [{ name: "CommandType", syntax: "proto2", values: [{ name: "session", id: 0 }, { name: "conv", id: 1 }, { name: "direct", id: 2 }, { name: "ack", id: 3 }, { name: "rcp", id: 4 }, { name: "unread", id: 5 }, { name: "logs", id: 6 }, { name: "error", id: 7 }, { name: "login", id: 8 }, { name: "data", id: 9 }, { name: "room", id: 10 }, { name: "read", id: 11 }, { name: "presence", id: 12 }, { name: "report", id: 13 }, { name: "echo", id: 14 }, { name: "loggedin", id: 15 }, { name: "logout", id: 16 }, { name: "loggedout", id: 17 }, { name: "patch", id: 18 }, { name: "pubsub", id: 19 }, { name: "blacklist", id: 20 }] }, { name: "OpType", syntax: "proto2", values: [{ name: "open", id: 1 }, { name: "add", id: 2 }, { name: "remove", id: 3 }, { name: "close", id: 4 }, { name: "opened", id: 5 }, { name: "closed", id: 6 }, { name: "query", id: 7 }, { name: "query_result", id: 8 }, { name: "conflict", id: 9 }, { name: "added", id: 10 }, { name: "removed", id: 11 }, { name: "refresh", id: 12 }, { name: "refreshed", id: 13 }, { name: "start", id: 30 }, { name: "started", id: 31 }, { name: "joined", id: 32 }, { name: "members_joined", id: 33 }, { name: "left", id: 39 }, { name: "members_left", id: 40 }, { name: "results", id: 42 }, { name: "count", id: 43 }, { name: "result", id: 44 }, { name: "update", id: 45 }, { name: "updated", id: 46 }, { name: "mute", id: 47 }, { name: "unmute", id: 48 }, { name: "status", id: 49 }, { name: "members", id: 50 }, { name: "max_read", id: 51 }, { name: "is_member", id: 52 }, { name: "property_update", id: 53 }, { name: "property_updated", id: 54 }, { name: "property_changed", id: 55 }, { name: "join", id: 80 }, { name: "invite", id: 81 }, { name: "leave", id: 82 }, { name: "kick", id: 83 }, { name: "reject", id: 84 }, { name: "invited", id: 85 }, { name: "kicked", id: 86 }, { name: "upload", id: 100 }, { name: "uploaded", id: 101 }, { name: "subscribe", id: 120 }, { name: "subscribed", id: 121 }, { name: "unsubscribe", id: 122 }, { name: "unsubscribed", id: 123 }, { name: "is_subscribed", id: 124 }, { name: "modify", id: 150 }, { name: "modified", id: 151 }, { name: "block", id: 170 }, { name: "unblock", id: 171 }] }, { name: "StatusType", syntax: "proto2", values: [{ name: "on", id: 1 }, { name: "off", id: 2 }] }], isNamespace: !0 }).build().push_server.messages2, ki = Li.JsonObjectMessage, Ni = Li.UnreadTuple, ji = Li.LogItem, Fi = Li.DataCommand, Ui = Li.SessionCommand, Di = Li.ErrorCommand, Bi = Li.DirectCommand, Vi = Li.AckCommand, Yi = Li.UnreadCommand, zi = Li.ConvCommand, qi = Li.RoomCommand, Wi = Li.LogsCommand, $i = Li.RcpCommand, Gi = Li.ReadTuple, Ji = Li.MaxReadTuple, Zi = Li.ReadCommand, Hi = Li.PresenceCommand, Xi = Li.ReportCommand, Ki = Li.GenericCommand, Qi = Li.PatchCommand, eo = Li.PatchItem, to = Li.CommandType, no = Li.OpType, ro = Li.StatusType, io = Object.freeze({ JsonObjectMessage: ki, UnreadTuple: Ni, LogItem: ji, DataCommand: Fi, SessionCommand: Ui, ErrorCommand: Di, DirectCommand: Bi, AckCommand: Vi, UnreadCommand: Yi, ConvCommand: zi, RoomCommand: qi, LogsCommand: Wi, RcpCommand: $i, ReadTuple: Gi, MaxReadTuple: Ji, ReadCommand: Zi, PresenceCommand: Hi, ReportCommand: Xi, GenericCommand: Ki, PatchCommand: Qi, PatchItem: eo, CommandType: to, OpType: no, StatusType: ro }), oo = r(function (e) { function t() { } function n(e, t, n) { this.fn = e, this.context = t, this.once = n || !1 } function r() { this._events = new t, this._eventsCount = 0 } var i = Object.prototype.hasOwnProperty, o = "~"; Object.create && (t.prototype = Object.create(null), (new t).__proto__ || (o = !1)), r.prototype.eventNames = function () { var e, t, n = []; if (0 === this._eventsCount) return n; for (t in e = this._events) i.call(e, t) && n.push(o ? t.slice(1) : t); return Object.getOwnPropertySymbols ? n.concat(Object.getOwnPropertySymbols(e)) : n }, r.prototype.listeners = function (e, t) { var n = o ? o + e : e, r = this._events[n]; if (t) return !!r; if (!r) return []; if (r.fn) return [r.fn]; for (var i = 0, s = r.length, a = new Array(s); i < s; i++)a[i] = r[i].fn; return a }, r.prototype.emit = function (e, t, n, r, i, s) { var a = o ? o + e : e; if (!this._events[a]) return !1; var u, f, c = this._events[a], l = arguments.length; if (c.fn) { switch (c.once && this.removeListener(e, c.fn, void 0, !0), l) { case 1: return c.fn.call(c.context), !0; case 2: return c.fn.call(c.context, t), !0; case 3: return c.fn.call(c.context, t, n), !0; case 4: return c.fn.call(c.context, t, n, r), !0; case 5: return c.fn.call(c.context, t, n, r, i), !0; case 6: return c.fn.call(c.context, t, n, r, i, s), !0 }for (f = 1, u = new Array(l - 1); f < l; f++)u[f - 1] = arguments[f]; c.fn.apply(c.context, u) } else { var h, p = c.length; for (f = 0; f < p; f++)switch (c[f].once && this.removeListener(e, c[f].fn, void 0, !0), l) { case 1: c[f].fn.call(c[f].context); break; case 2: c[f].fn.call(c[f].context, t); break; case 3: c[f].fn.call(c[f].context, t, n); break; case 4: c[f].fn.call(c[f].context, t, n, r); break; default: if (!u) for (h = 1, u = new Array(l - 1); h < l; h++)u[h - 1] = arguments[h]; c[f].fn.apply(c[f].context, u) } } return !0 }, r.prototype.on = function (e, t, r) { var i = new n(t, r || this), s = o ? o + e : e; return this._events[s] ? this._events[s].fn ? this._events[s] = [this._events[s], i] : this._events[s].push(i) : (this._events[s] = i, this._eventsCount++), this }, r.prototype.once = function (e, t, r) { var i = new n(t, r || this, !0), s = o ? o + e : e; return this._events[s] ? this._events[s].fn ? this._events[s] = [this._events[s], i] : this._events[s].push(i) : (this._events[s] = i, this._eventsCount++), this }, r.prototype.removeListener = function (e, n, r, i) { var s = o ? o + e : e; if (!this._events[s]) return this; if (!n) return 0 == --this._eventsCount ? this._events = new t : delete this._events[s], this; var a = this._events[s]; if (a.fn) a.fn !== n || i && !a.once || r && a.context !== r || (0 == --this._eventsCount ? this._events = new t : delete this._events[s]); else { for (var u = 0, f = [], c = a.length; u < c; u++)(a[u].fn !== n || i && !a[u].once || r && a[u].context !== r) && f.push(a[u]); f.length ? this._events[s] = 1 === f.length ? f[0] : f : 0 == --this._eventsCount ? this._events = new t : delete this._events[s] } return this }, r.prototype.removeAllListeners = function (e) { var n; return e ? (n = o ? o + e : e, this._events[n] && (0 == --this._eventsCount ? this._events = new t : delete this._events[n])) : (this._events = new t, this._eventsCount = 0), this }, r.prototype.off = r.prototype.removeListener, r.prototype.addListener = r.prototype.on, r.prototype.setMaxListeners = function () { return this }, r.prefixed = o, r.EventEmitter = r, e.exports = r }), so = r(function (e) { !function (t) { function n(e, t, n, r) { var o = t && t.prototype instanceof i ? t : i, s = Object.create(o.prototype), a = new p(r || []); return s._invoke = f(e, n, a), s } function r(e, t, n) { try { return { type: "normal", arg: e.call(t, n) } } catch (e) { return { type: "throw", arg: e } } } function i() { } function o() { } function s() { } function a(e) { ["next", "throw", "return"].forEach(function (t) { e[t] = function (e) { return this._invoke(t, e) } }) } function u(e) { function t(n, i, o, s) { var a = r(e[n], e, i); if ("throw" !== a.type) { var u = a.arg, f = u.value; return f && "object" == typeof f && v.call(f, "__await") ? Promise.resolve(f.__await).then(function (e) { t("next", e, o, s) }, function (e) { t("throw", e, o, s) }) : Promise.resolve(f).then(function (e) { u.value = e, o(u) }, s) } s(a.arg) } var n; this._invoke = function (e, r) { function i() { return new Promise(function (n, i) { t(e, r, n, i) }) } return n = n ? n.then(i, i) : i() } } function f(e, t, n) { var i = S; return function (o, s) { if (i === I) throw new Error("Generator is already running"); if (i === C) { if ("throw" === o) throw s; return m() } for (n.method = o, n.arg = s; ;) { var a = n.delegate; if (a) { var u = c(a, n); if (u) { if (u === O) continue; return u } } if ("next" === n.method) n.sent = n._sent = n.arg; else if ("throw" === n.method) { if (i === S) throw i = C, n.arg; n.dispatchException(n.arg) } else "return" === n.method && n.abrupt("return", n.arg); i = I; var f = r(e, t, n); if ("normal" === f.type) { if (i = n.done ? C : A, f.arg === O) continue; return { value: f.arg, done: n.done } } "throw" === f.type && (i = C, n.method = "throw", n.arg = f.arg) } } } function c(e, t) { var n = e.iterator[t.method]; if (n === y) { if (t.delegate = null, "throw" === t.method) { if (e.iterator.return && (t.method = "return", t.arg = y, c(e, t), "throw" === t.method)) return O; t.method = "throw", t.arg = new TypeError("The iterator does not provide a 'throw' method") } return O } var i = r(n, e.iterator, t.arg); if ("throw" === i.type) return t.method = "throw", t.arg = i.arg, t.delegate = null, O; var o = i.arg; return o ? o.done ? (t[e.resultName] = o.value, t.next = e.nextLoc, "return" !== t.method && (t.method = "next", t.arg = y), t.delegate = null, O) : o : (t.method = "throw", t.arg = new TypeError("iterator result is not an object"), t.delegate = null, O) } function l(e) { var t = { tryLoc: e[0] }; 1 in e && (t.catchLoc = e[1]), 2 in e && (t.finallyLoc = e[2], t.afterLoc = e[3]), this.tryEntries.push(t) } function h(e) { var t = e.completion || {}; t.type = "normal", delete t.arg, e.completion = t } function p(e) { this.tryEntries = [{ tryLoc: "root" }], e.forEach(l, this), this.reset(!0) } function d(e) { if (e) { var t = e[w]; if (t) return t.call(e); if ("function" == typeof e.next) return e; if (!isNaN(e.length)) { var n = -1, r = function t() { for (; ++n < e.length;)if (v.call(e, n)) return t.value = e[n], t.done = !1, t; return t.value = y, t.done = !0, t }; return r.next = r } } return { next: m } } function m() { return { value: y, done: !0 } } var y, g = Object.prototype, v = g.hasOwnProperty, b = "function" == typeof Symbol ? Symbol : {}, w = b.iterator || "@@iterator", _ = b.asyncIterator || "@@asyncIterator", E = b.toStringTag || "@@toStringTag", T = t.regeneratorRuntime; if (T) e.exports = T; else { (T = t.regeneratorRuntime = e.exports).wrap = n; var S = "suspendedStart", A = "suspendedYield", I = "executing", C = "completed", O = {}, x = {}; x[w] = function () { return this }; var M = Object.getPrototypeOf, P = M && M(M(d([]))); P && P !== g && v.call(P, w) && (x = P); var R = s.prototype = i.prototype = Object.create(x); o.prototype = R.constructor = s, s.constructor = o, s[E] = o.displayName = "GeneratorFunction", T.isGeneratorFunction = function (e) { var t = "function" == typeof e && e.constructor; return !!t && (t === o || "GeneratorFunction" === (t.displayName || t.name)) }, T.mark = function (e) { return Object.setPrototypeOf ? Object.setPrototypeOf(e, s) : (e.__proto__ = s, E in e || (e[E] = "GeneratorFunction")), e.prototype = Object.create(R), e }, T.awrap = function (e) { return { __await: e } }, a(u.prototype), u.prototype[_] = function () { return this }, T.AsyncIterator = u, T.async = function (e, t, r, i) { var o = new u(n(e, t, r, i)); return T.isGeneratorFunction(t) ? o : o.next().then(function (e) { return e.done ? e.value : o.next() }) }, a(R), R[E] = "Generator", R[w] = function () { return this }, R.toString = function () { return "[object Generator]" }, T.keys = function (e) { var t = []; for (var n in e) t.push(n); return t.reverse(), function n() { for (; t.length;) { var r = t.pop(); if (r in e) return n.value = r, n.done = !1, n } return n.done = !0, n } }, T.values = d, p.prototype = { constructor: p, reset: function (e) { if (this.prev = 0, this.next = 0, this.sent = this._sent = y, this.done = !1, this.delegate = null, this.method = "next", this.arg = y, this.tryEntries.forEach(h), !e) for (var t in this) "t" === t.charAt(0) && v.call(this, t) && !isNaN(+t.slice(1)) && (this[t] = y) }, stop: function () { this.done = !0; var e = this.tryEntries[0].completion; if ("throw" === e.type) throw e.arg; return this.rval }, dispatchException: function (e) { function t(t, r) { return o.type = "throw", o.arg = e, n.next = t, r && (n.method = "next", n.arg = y), !!r } if (this.done) throw e; for (var n = this, r = this.tryEntries.length - 1; r >= 0; --r) { var i = this.tryEntries[r], o = i.completion; if ("root" === i.tryLoc) return t("end"); if (i.tryLoc <= this.prev) { var s = v.call(i, "catchLoc"), a = v.call(i, "finallyLoc"); if (s && a) { if (this.prev < i.catchLoc) return t(i.catchLoc, !0); if (this.prev < i.finallyLoc) return t(i.finallyLoc) } else if (s) { if (this.prev < i.catchLoc) return t(i.catchLoc, !0) } else { if (!a) throw new Error("try statement without catch or finally"); if (this.prev < i.finallyLoc) return t(i.finallyLoc) } } } }, abrupt: function (e, t) { for (var n = this.tryEntries.length - 1; n >= 0; --n) { var r = this.tryEntries[n]; if (r.tryLoc <= this.prev && v.call(r, "finallyLoc") && this.prev < r.finallyLoc) { var i = r; break } } i && ("break" === e || "continue" === e) && i.tryLoc <= t && t <= i.finallyLoc && (i = null); var o = i ? i.completion : {}; return o.type = e, o.arg = t, i ? (this.method = "next", this.next = i.finallyLoc, O) : this.complete(o) }, complete: function (e, t) { if ("throw" === e.type) throw e.arg; return "break" === e.type || "continue" === e.type ? this.next = e.arg : "return" === e.type ? (this.rval = this.arg = e.arg, this.method = "return", this.next = "end") : "normal" === e.type && t && (this.next = t), O }, finish: function (e) { for (var t = this.tryEntries.length - 1; t >= 0; --t) { var n = this.tryEntries[t]; if (n.finallyLoc === e) return this.complete(n.completion, n.afterLoc), h(n), O } }, catch: function (e) { for (var t = this.tryEntries.length - 1; t >= 0; --t) { var n = this.tryEntries[t]; if (n.tryLoc === e) { var r = n.completion; if ("throw" === r.type) { var i = r.arg; h(n) } return i } } throw new Error("illegal catch attempt") }, delegateYield: function (e, t, n) { return this.delegate = { iterator: d(e), resultName: t, nextLoc: n }, "next" === this.method && (this.arg = y), O } } } }(function () { return this }() || Function("return this")()) }), ao = function () { return this }() || Function("return this")(), uo = ao.regeneratorRuntime && Object.getOwnPropertyNames(ao).indexOf("regeneratorRuntime") >= 0, fo = uo && ao.regeneratorRuntime; ao.regeneratorRuntime = void 0; var co = so; if (uo) ao.regeneratorRuntime = fo; else try { delete ao.regeneratorRuntime } catch (e) { ao.regeneratorRuntime = void 0 } var lo = co, ho = Object.assign, po = !ho || ee(function () { var e = {}, t = {}, n = Symbol(), r = "abcdefghijklmnopqrst"; return e[n] = 7, r.split("").forEach(function (e) { t[e] = e }), 7 != ho({}, e)[n] || Object.keys(ho({}, t)).join("") != r }) ? function (e, t) { for (var n = Xe(e), r = arguments.length, i = 1, o = Ln.f, s = kn.f; r > i;)for (var a, u = be(arguments[i++]), f = o ? Fe(u).concat(o(u)) : Fe(u), c = f.length, l = 0; c > l;)s.call(u, a = f[l++]) && (n[a] = u[a]); return n } : ho; he(he.S + he.F, "Object", { assign: po }); var mo = Z.Object.assign, yo = r(function (e) { e.exports = { default: mo, __esModule: !0 } }), go = n(yo), vo = n(r(function (e, t) { t.__esModule = !0; var n = function (e) { return e && e.__esModule ? e : { default: e } }(yo); t.default = n.default || function (e) { for (var t = 1; t < arguments.length; t++) { var n = arguments[t]; for (var r in n) Object.prototype.hasOwnProperty.call(n, r) && (e[r] = n[r]) } return e } })), bo = n(r(function (e, t) { t.__esModule = !0; var n = function (e) { return e && e.__esModule ? e : { default: e } }(An); t.default = function (e) { return function () { var t = e.apply(this, arguments); return new n.default(function (e, r) { function i(o, s) { try { var a = t[o](s), u = a.value } catch (e) { return void r(e) } if (!a.done) return n.default.resolve(u).then(function (e) { i("next", e) }, function (e) { i("throw", e) }); e(u) } return i("next") }) } } })), wo = function (e, t, n) { t in e ? ue.f(e, t, fe(0, n)) : e[t] = n }; he(he.S + he.F * !an(function (e) { Array.from(e) }), "Array", { from: function (e) { var t, n, r, i, o = Xe(e), s = "function" == typeof this ? this : Array, a = arguments.length, u = a > 1 ? arguments[1] : void 0, f = void 0 !== u, c = 0, l = Ct(o); if (f && (u = X(u, a > 2 ? arguments[2] : void 0, 2)), void 0 == l || s == Array && At(l)) for (n = new s(t = Ee(o.length)); t > c; c++)wo(n, c, f ? u(o[c], c) : o[c]); else for (i = l.call(o), n = new s; !(r = i.next()).done; c++)wo(n, c, f ? Et(i, u, [r.value, c], !0) : r.value); return n.length = c, n } }); var _o = Z.Array.from, Eo = r(function (e) { e.exports = { default: _o, __esModule: !0 } }), To = n(Eo), So = n(r(function (e, t) { t.__esModule = !0; var n = function (e) { return e && e.__esModule ? e : { default: e } }(Eo); t.default = function (e) { if (Array.isArray(e)) { for (var t = 0, r = Array(e.length); t < e.length; t++)r[t] = e[t]; return r } return (0, n.default)(e) } })), Ao = function (e, t) { if (!K(e) || e._t !== t) throw TypeError("Incompatible receiver, " + t + " required!"); return e }, Io = ue.f, Co = Mn.fastKey, Oo = te ? "_s" : "size", xo = function (e, t) { var n, r = Co(t); if ("F" !== r) return e._i[r]; for (n = e._f; n; n = n.n)if (n.k == t) return n }, Mo = { getConstructor: function (e, t, n, r) { var i = e(function (e, o) { _t(e, i, t, "_i"), e._t = t, e._i = qe(null), e._f = void 0, e._l = void 0, e[Oo] = 0, void 0 != o && Ot(o, n, e[r], e) }); return Ht(i.prototype, { clear: function () { for (var e = Ao(this, t), n = e._i, r = e._f; r; r = r.n)r.r = !0, r.p && (r.p = r.p.n = void 0), delete n[r.i]; e._f = e._l = void 0, e[Oo] = 0 }, delete: function (e) { var n = Ao(this, t), r = xo(n, e); if (r) { var i = r.n, o = r.p; delete n._i[r.i], r.r = !0, o && (o.n = i), i && (i.p = o), n._f == r && (n._f = i), n._l == r && (n._l = o), n[Oo]-- } return !!r }, forEach: function (e) { Ao(this, t); for (var n, r = X(e, arguments.length > 1 ? arguments[1] : void 0, 3); n = n ? n.n : this._f;)for (r(n.v, n.k, this); n && n.r;)n = n.p }, has: function (e) { return !!xo(Ao(this, t), e) } }), te && Io(i.prototype, "size", { get: function () { return Ao(this, t)[Oo] } }), i }, def: function (e, t, n) { var r, i, o = xo(e, t); return o ? o.v = n : (e._l = o = { i: i = Co(t, !0), k: t, v: n, p: r = e._l, n: void 0, r: !1 }, e._f || (e._f = o), r && (r.n = o), e[Oo]++ , "F" !== i && (e._i[i] = o)), e }, getEntry: xo, setStrong: function (e, t, n) { it(e, t, function (e, n) { this._t = Ao(e, t), this._k = n, this._l = void 0 }, function () { for (var e = this, t = e._k, n = e._l; n && n.r;)n = n.p; return e._t && (e._l = n = n ? n.n : e._t._f) ? "keys" == t ? at(0, n.k) : "values" == t ? at(0, n.v) : at(0, [n.k, n.v]) : (e._t = void 0, at(1)) }, n ? "entries" : "values", !n, !0), Kt(t) } }, Po = We("species"), Ro = function (e) { var t; return jn(e) && ("function" != typeof (t = e.constructor) || t !== Array && !jn(t.prototype) || (t = void 0), K(t) && null === (t = t[Po]) && (t = void 0)), void 0 === t ? Array : t }, Lo = function (e, t) { return new (Ro(e))(t) }, ko = function (e, t) { var n = 1 == e, r = 2 == e, i = 3 == e, o = 4 == e, s = 6 == e, a = 5 == e || s, u = t || Lo; return function (t, f, c) { for (var l, h, p = Xe(t), d = be(p), m = X(f, c, 3), y = Ee(d.length), g = 0, v = n ? u(t, y) : r ? u(t, 0) : void 0; y > g; g++)if ((a || g in d) && (l = d[g], h = m(l, g, p), e)) if (n) v[g] = h; else if (h) switch (e) { case 3: return !0; case 5: return l; case 6: return g; case 2: v.push(l) } else if (o) return !1; return s ? -1 : i || o ? o : v } }, No = ue.f, jo = ko(0), Fo = function (e, t, n, r, i, o) { var s = J[e], a = s, u = i ? "set" : "add", f = a && a.prototype, c = {}; return te && "function" == typeof a && (o || f.forEach && !ee(function () { (new a).entries().next() })) ? (a = t(function (t, n) { _t(t, a, e, "_c"), t._c = new s, void 0 != n && Ot(n, i, t[u], t) }), jo("add,clear,delete,forEach,get,has,set,keys,values,entries,toJSON".split(","), function (e) { var t = "add" == e || "set" == e; e in f && (!o || "clear" != e) && ce(a.prototype, e, function (n, r) { if (_t(this, a, e), !t && o && !K(n)) return "get" == e && void 0; var i = this._c[e](0 === n ? 0 : n, r); return t ? this : i }) }), o || No(a.prototype, "size", { get: function () { return this._c.size } })) : (a = r.getConstructor(t, e, i, u), Ht(a.prototype, n), Mn.NEED = !0), Je(a, e), c[e] = a, he(he.G + he.W + he.F, c), o || r.setStrong(a, e, i), a }, Uo = (Fo("Set", function (e) { return function () { return e(this, arguments.length > 0 ? arguments[0] : void 0) } }, { add: function (e) { return Mo.def(Ao(this, "Set"), e = 0 === e ? 0 : e, e) } }, Mo), function (e, t) { var n = []; return Ot(e, !1, n.push, n, t), n }); he(he.P + he.R, "Set", { toJSON: function (e) { return function () { if (wt(this) != e) throw TypeError(e + "#toJSON isn't generic"); return Uo(this) } }("Set") }); var Do = function (e) { he(he.S, e, { of: function () { for (var e = arguments.length, t = Array(e); e--;)t[e] = arguments[e]; return new this(t) } }) }; Do("Set"); var Bo = function (e) { he(he.S, e, { from: function (e) { var t, n, r, i, o = arguments[1]; return H(this), (t = void 0 !== o) && H(o), void 0 == e ? new this : (n = [], t ? (r = 0, i = X(o, arguments[2], 2), Ot(e, !1, function (e) { n.push(i(e, r++)) })) : Ot(e, !1, n.push, n), new this(n)) } }) }; Bo("Set"); var Vo = Z.Set, Yo = n(r(function (e) { e.exports = { default: Vo, __esModule: !0 } })), zo = 1e3, qo = 60 * zo, Wo = 60 * qo, $o = 24 * Wo, Go = 365.25 * $o, Jo = function (e, t) { t = t || {}; var n = typeof e; if ("string" === n && e.length > 0) return c(e); if ("number" === n && !1 === isNaN(e)) return t.long ? h(e) : l(e); throw new Error("val is not a non-empty string or a valid number. val=" + JSON.stringify(e)) }, Zo = r(function (e, t) { function n(e) { var n, r = 0; for (n in e) r = (r << 5) - r + e.charCodeAt(n), r |= 0; return t.colors[Math.abs(r) % t.colors.length] } function r(e) { function r() { if (r.enabled) { var e = r, n = +new Date, i = n - (o || n); e.diff = i, e.prev = o, e.curr = n, o = n; for (var s = new Array(arguments.length), a = 0; a < s.length; a++)s[a] = arguments[a]; s[0] = t.coerce(s[0]), "string" != typeof s[0] && s.unshift("%O"); var u = 0; s[0] = s[0].replace(/%([a-zA-Z%])/g, function (n, r) { if ("%%" === n) return n; u++; var i = t.formatters[r]; if ("function" == typeof i) { var o = s[u]; n = i.call(e, o), s.splice(u, 1), u-- } return n }), t.formatArgs.call(e, s), (r.log || t.log || console.log.bind(console)).apply(e, s) } } var o; return r.namespace = e, r.enabled = t.enabled(e), r.useColors = t.useColors(), r.color = n(e), r.destroy = i, "function" == typeof t.init && t.init(r), t.instances.push(r), r } function i() { var e = t.instances.indexOf(this); return -1 !== e && (t.instances.splice(e, 1), !0) } (t = e.exports = r.debug = r.default = r).coerce = function (e) { return e instanceof Error ? e.stack || e.message : e }, t.disable = function () { t.enable("") }, t.enable = function (e) { t.save(e), t.names = [], t.skips = []; var n, r = ("string" == typeof e ? e : "").split(/[\s,]+/), i = r.length; for (n = 0; n < i; n++)r[n] && ("-" === (e = r[n].replace(/\*/g, ".*?"))[0] ? t.skips.push(new RegExp("^" + e.substr(1) + "$")) : t.names.push(new RegExp("^" + e + "$"))); for (n = 0; n < t.instances.length; n++) { var o = t.instances[n]; o.enabled = t.enabled(o.namespace) } }, t.enabled = function (e) { if ("*" === e[e.length - 1]) return !0; var n, r; for (n = 0, r = t.skips.length; n < r; n++)if (t.skips[n].test(e)) return !1; for (n = 0, r = t.names.length; n < r; n++)if (t.names[n].test(e)) return !0; return !1 }, t.humanize = Jo, t.instances = [], t.names = [], t.skips = [], t.formatters = {} }), Ho = r(function (e, t) { function n() { var e; try { e = t.storage.debug } catch (e) { } return !e && void 0 !== Y && "env" in Y && (e = Y.env.DEBUG), e } (t = e.exports = Zo).log = function () { return "object" == typeof console && console.log && Function.prototype.apply.call(console.log, console, arguments) }, t.formatArgs = function (e) { var n = this.useColors; if (e[0] = (n ? "%c" : "") + this.namespace + (n ? " %c" : " ") + e[0] + (n ? "%c " : " ") + "+" + t.humanize(this.diff), n) { var r = "color: " + this.color; e.splice(1, 0, r, "color: inherit"); var i = 0, o = 0; e[0].replace(/%[a-zA-Z%]/g, function (e) { "%%" !== e && (i++ , "%c" === e && (o = i)) }), e.splice(o, 0, r) } }, t.save = function (e) { try { null == e ? t.storage.removeItem("debug") : t.storage.debug = e } catch (e) { } }, t.load = n, t.useColors = function () { return !("undefined" == typeof window || !window.process || "renderer" !== window.process.type) || ("undefined" == typeof navigator || !navigator.userAgent || !navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/)) && ("undefined" != typeof document && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance || "undefined" != typeof window && window.console && (window.console.firebug || window.console.exception && window.console.table) || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/) && parseInt(RegExp.$1, 10) >= 31 || "undefined" != typeof navigator && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)) }, t.storage = "undefined" != typeof chrome && void 0 !== chrome.storage ? chrome.storage.local : function () { try { return window.localStorage } catch (e) { } }(), t.colors = ["#0000CC", "#0000FF", "#0033CC", "#0033FF", "#0066CC", "#0066FF", "#0099CC", "#0099FF", "#00CC00", "#00CC33", "#00CC66", "#00CC99", "#00CCCC", "#00CCFF", "#3300CC", "#3300FF", "#3333CC", "#3333FF", "#3366CC", "#3366FF", "#3399CC", "#3399FF", "#33CC00", "#33CC33", "#33CC66", "#33CC99", "#33CCCC", "#33CCFF", "#6600CC", "#6600FF", "#6633CC", "#6633FF", "#66CC00", "#66CC33", "#9900CC", "#9900FF", "#9933CC", "#9933FF", "#99CC00", "#99CC33", "#CC0000", "#CC0033", "#CC0066", "#CC0099", "#CC00CC", "#CC00FF", "#CC3300", "#CC3333", "#CC3366", "#CC3399", "#CC33CC", "#CC33FF", "#CC6600", "#CC6633", "#CC9900", "#CC9933", "#CCCC00", "#CCCC33", "#FF0000", "#FF0033", "#FF0066", "#FF0099", "#FF00CC", "#FF00FF", "#FF3300", "#FF3333", "#FF3366", "#FF3399", "#FF33CC", "#FF33FF", "#FF6600", "#FF6633", "#FF9900", "#FF9933", "#FFCC00", "#FFCC33"], t.formatters.j = function (e) { try { return JSON.stringify(e) } catch (e) { return "[UnexpectedJSONParseError]: " + e.message } }, t.enable(n()) }), Xo = function (e, t) { return function () { for (var n = new Array(arguments.length), r = 0; r < n.length; r++)n[r] = arguments[r]; return e.apply(t, n) } }, Ko = Object.prototype.toString, Qo = { isArray: y, isArrayBuffer: function (e) { return "[object ArrayBuffer]" === Ko.call(e) }, isBuffer: function (e) { return null != e && (d(e) || m(e) || !!e._isBuffer) }, isFormData: function (e) { return "undefined" != typeof FormData && e instanceof FormData }, isArrayBufferView: function (e) { return "undefined" != typeof ArrayBuffer && ArrayBuffer.isView ? ArrayBuffer.isView(e) : e && e.buffer && e.buffer instanceof ArrayBuffer }, isString: function (e) { return "string" == typeof e }, isNumber: function (e) { return "number" == typeof e }, isObject: g, isUndefined: function (e) { return void 0 === e }, isDate: function (e) { return "[object Date]" === Ko.call(e) }, isFile: function (e) { return "[object File]" === Ko.call(e) }, isBlob: function (e) { return "[object Blob]" === Ko.call(e) }, isFunction: v, isStream: function (e) { return g(e) && v(e.pipe) }, isURLSearchParams: function (e) { return "undefined" != typeof URLSearchParams && e instanceof URLSearchParams }, isStandardBrowserEnv: function () { return ("undefined" == typeof navigator || "ReactNative" !== navigator.product) && "undefined" != typeof window && "undefined" != typeof document }, forEach: b, merge: w, extend: function (e, t, n) { return b(t, function (t, r) { e[r] = n && "function" == typeof t ? Xo(t, n) : t }), e }, trim: function (e) { return e.replace(/^\s*/, "").replace(/\s*$/, "") } }, es = function (e, t) { Qo.forEach(e, function (n, r) { r !== t && r.toUpperCase() === t.toUpperCase() && (e[t] = n, delete e[r]) }) }, ts = function (e, t, n, r, i) { return e.config = t, n && (e.code = n), e.request = r, e.response = i, e }, ns = function (e, t, n, r, i) { var o = new Error(e); return ts(o, t, n, r, i) }, rs = function (e, t, n) { var r = n.config.validateStatus; n.status && r && !r(n.status) ? t(ns("Request failed with status code " + n.status, n.config, null, n.request, n)) : e(n) }, is = function (e, t, n) { if (!t) return e; var r; if (n) r = n(t); else if (Qo.isURLSearchParams(t)) r = t.toString(); else { var i = []; Qo.forEach(t, function (e, t) { null !== e && void 0 !== e && (Qo.isArray(e) && (t += "[]"), Qo.isArray(e) || (e = [e]), Qo.forEach(e, function (e) { Qo.isDate(e) ? e = e.toISOString() : Qo.isObject(e) && (e = Wr(e)), i.push(_(t) + "=" + _(e)) })) }), r = i.join("&") } return r && (e += (-1 === e.indexOf("?") ? "?" : "&") + r), e }, os = function (e) { var t, n, r, i = {}; return e ? (Qo.forEach(e.split("\n"), function (e) { r = e.indexOf(":"), t = Qo.trim(e.substr(0, r)).toLowerCase(), n = Qo.trim(e.substr(r + 1)), t && (i[t] = i[t] ? i[t] + ", " + n : n) }), i) : i }, ss = Qo.isStandardBrowserEnv() ? function () { function e(e) { var t = e; return n && (r.setAttribute("href", t), t = r.href), r.setAttribute("href", t), { href: r.href, protocol: r.protocol ? r.protocol.replace(/:$/, "") : "", host: r.host, search: r.search ? r.search.replace(/^\?/, "") : "", hash: r.hash ? r.hash.replace(/^#/, "") : "", hostname: r.hostname, port: r.port, pathname: "/" === r.pathname.charAt(0) ? r.pathname : "/" + r.pathname } } var t, n = /(msie|trident)/i.test(navigator.userAgent), r = document.createElement("a"); return t = e(window.location.href), function (n) { var r = Qo.isString(n) ? e(n) : n; return r.protocol === t.protocol && r.host === t.host } }() : function () { return !0 }, as = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="; E.prototype = new Error, E.prototype.code = 5, E.prototype.name = "InvalidCharacterError"; var us = Qo.isStandardBrowserEnv() ? { write: function (e, t, n, r, i, o) { var s = []; s.push(e + "=" + encodeURIComponent(t)), Qo.isNumber(n) && s.push("expires=" + new Date(n).toGMTString()), Qo.isString(r) && s.push("path=" + r), Qo.isString(i) && s.push("domain=" + i), !0 === o && s.push("secure"), document.cookie = s.join("; ") }, read: function (e) { var t = document.cookie.match(new RegExp("(^|;\\s*)(" + e + ")=([^;]*)")); return t ? decodeURIComponent(t[3]) : null }, remove: function (e) { this.write(e, "", Date.now() - 864e5) } } : { write: function () { }, read: function () { return null }, remove: function () { } }, fs = "undefined" != typeof window && window.btoa && window.btoa.bind(window) || function (e) { for (var t, n, r = String(e), i = "", o = 0, s = as; r.charAt(0 | o) || (s = "=", o % 1); i += s.charAt(63 & t >> 8 - o % 1 * 8)) { if ((n = r.charCodeAt(o += .75)) > 255) throw new E; t = t << 8 | n } return i }, cs = function (e) { return new In(function (t, n) { var r = e.data, i = e.headers; Qo.isFormData(r) && delete i["Content-Type"]; var o = new XMLHttpRequest, s = "onreadystatechange", a = !1; if ("test" === Y.env.NODE_ENV || "undefined" == typeof window || !window.XDomainRequest || "withCredentials" in o || ss(e.url) || (o = new window.XDomainRequest, s = "onload", a = !0, o.onprogress = function () { }, o.ontimeout = function () { }), e.auth) { var u = e.auth.username || "", f = e.auth.password || ""; i.Authorization = "Basic " + fs(u + ":" + f) } if (o.open(e.method.toUpperCase(), is(e.url, e.params, e.paramsSerializer), !0), o.timeout = e.timeout, o[s] = function () { if (o && (4 === o.readyState || a) && (0 !== o.status || o.responseURL && 0 === o.responseURL.indexOf("file:"))) { var r = "getAllResponseHeaders" in o ? os(o.getAllResponseHeaders()) : null, i = { data: e.responseType && "text" !== e.responseType ? o.response : o.responseText, status: 1223 === o.status ? 204 : o.status, statusText: 1223 === o.status ? "No Content" : o.statusText, headers: r, config: e, request: o }; rs(t, n, i), o = null } }, o.onerror = function () { n(ns("Network Error", e, null, o)), o = null }, o.ontimeout = function () { n(ns("timeout of " + e.timeout + "ms exceeded", e, "ECONNABORTED", o)), o = null }, Qo.isStandardBrowserEnv()) { var c = us, l = (e.withCredentials || ss(e.url)) && e.xsrfCookieName ? c.read(e.xsrfCookieName) : void 0; l && (i[e.xsrfHeaderName] = l) } if ("setRequestHeader" in o && Qo.forEach(i, function (e, t) { void 0 === r && "content-type" === t.toLowerCase() ? delete i[t] : o.setRequestHeader(t, e) }), e.withCredentials && (o.withCredentials = !0), e.responseType) try { o.responseType = e.responseType } catch (t) { if ("json" !== e.responseType) throw t } "function" == typeof e.onDownloadProgress && o.addEventListener("progress", e.onDownloadProgress), "function" == typeof e.onUploadProgress && o.upload && o.upload.addEventListener("progress", e.onUploadProgress), e.cancelToken && e.cancelToken.promise.then(function (e) { o && (o.abort(), n(e), o = null) }), void 0 === r && (r = null), o.send(r) }) }, ls = { "Content-Type": "application/x-www-form-urlencoded" }, hs = { adapter: function () { var e; return "undefined" != typeof XMLHttpRequest ? e = cs : void 0 !== Y && (e = cs), e }(), transformRequest: [function (e, t) { return es(t, "Content-Type"), Qo.isFormData(e) || Qo.isArrayBuffer(e) || Qo.isBuffer(e) || Qo.isStream(e) || Qo.isFile(e) || Qo.isBlob(e) ? e : Qo.isArrayBufferView(e) ? e.buffer : Qo.isURLSearchParams(e) ? (T(t, "application/x-www-form-urlencoded;charset=utf-8"), e.toString()) : Qo.isObject(e) ? (T(t, "application/json;charset=utf-8"), Wr(e)) : e }], transformResponse: [function (e) { if ("string" == typeof e) try { e = JSON.parse(e) } catch (e) { } return e }], timeout: 0, xsrfCookieName: "XSRF-TOKEN", xsrfHeaderName: "X-XSRF-TOKEN", maxContentLength: -1, validateStatus: function (e) { return e >= 200 && e < 300 } }; hs.headers = { common: { Accept: "application/json, text/plain, */*" } }, Qo.forEach(["delete", "get", "head"], function (e) { hs.headers[e] = {} }), Qo.forEach(["post", "put", "patch"], function (e) { hs.headers[e] = Qo.merge(ls) }); var ps = hs; S.prototype.use = function (e, t) { return this.handlers.push({ fulfilled: e, rejected: t }), this.handlers.length - 1 }, S.prototype.eject = function (e) { this.handlers[e] && (this.handlers[e] = null) }, S.prototype.forEach = function (e) { Qo.forEach(this.handlers, function (t) { null !== t && e(t) }) }; var ds = S, ms = function (e, t, n) { return Qo.forEach(n, function (n) { e = n(e, t) }), e }, ys = function (e) { return !(!e || !e.__CANCEL__) }, gs = function (e) { return A(e), e.headers = e.headers || {}, e.data = ms(e.data, e.headers, e.transformRequest), e.headers = Qo.merge(e.headers.common || {}, e.headers[e.method] || {}, e.headers || {}), Qo.forEach(["delete", "get", "head", "post", "put", "patch", "common"], function (t) { delete e.headers[t] }), (e.adapter || ps.adapter)(e).then(function (t) { return A(e), t.data = ms(t.data, t.headers, e.transformResponse), t }, function (t) { return ys(t) || (A(e), t && t.response && (t.response.data = ms(t.response.data, t.response.headers, e.transformResponse))), In.reject(t) }) }, vs = function (e) { return /^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e) }, bs = function (e, t) { return t ? e.replace(/\/+$/, "") + "/" + t.replace(/^\/+/, "") : e }; I.prototype.request = function (e) { "string" == typeof e && (e = Qo.merge({ url: arguments[0] }, arguments[1])), (e = Qo.merge(ps, this.defaults, { method: "get" }, e)).method = e.method.toLowerCase(), e.baseURL && !vs(e.url) && (e.url = bs(e.baseURL, e.url)); var t = [gs, void 0], n = In.resolve(e); for (this.interceptors.request.forEach(function (e) { t.unshift(e.fulfilled, e.rejected) }), this.interceptors.response.forEach(function (e) { t.push(e.fulfilled, e.rejected) }); t.length;)n = n.then(t.shift(), t.shift()); return n }, Qo.forEach(["delete", "get", "head", "options"], function (e) { I.prototype[e] = function (t, n) { return this.request(Qo.merge(n || {}, { method: e, url: t })) } }), Qo.forEach(["post", "put", "patch"], function (e) { I.prototype[e] = function (t, n, r) { return this.request(Qo.merge(r || {}, { method: e, url: t, data: n })) } }); var ws = I; C.prototype.toString = function () { return "Cancel" + (this.message ? ": " + this.message : "") }, C.prototype.__CANCEL__ = !0; var _s = C; O.prototype.throwIfRequested = function () { if (this.reason) throw this.reason }, O.source = function () { var e; return { token: new O(function (t) { e = t }), cancel: e } }; var Es = O, Ts = x(ps); Ts.Axios = ws, Ts.create = function (e) { return x(Qo.merge(ps, e)) }, Ts.Cancel = _s, Ts.CancelToken = Es, Ts.isCancel = ys, Ts.all = function (e) { return In.all(e) }, Ts.spread = function (e) { return function (t) { return e.apply(null, t) } }; var Ss = Ts, As = Ts; Ss.default = As; var Is = Ss, Cs = function (e, t) { var n = -1, r = e.length; for (t || (t = Array(r)); ++n < r;)t[n] = e[n]; return t }, Os = Math.floor, xs = Math.random, Ms = function (e, t) { return e + Os(xs() * (t - e + 1)) }, Ps = function (e, t) { var n = -1, r = e.length, i = r - 1; for (t = void 0 === t ? r : t; ++n < t;) { var o = Ms(n, i), s = e[o]; e[o] = e[n], e[n] = s } return e.length = t, e }, Rs = function (e) { return Ps(Cs(e)) }, Ls = function (e, t) { for (var n = -1, r = null == e ? 0 : e.length, i = Array(r); ++n < r;)i[n] = t(e[n], n, e); return i }, ks = function (e, t) { return Ls(t, function (t) { return e[t] }) }, Ns = function (e, t) { for (var n = -1, r = Array(e); ++n < e;)r[n] = t(n); return r }, js = "object" == typeof z && z && z.Object === Object && z, Fs = "object" == typeof self && self && self.Object === Object && self, Us = js || Fs || Function("return this")(), Ds = Us.Symbol, Bs = Object.prototype, Vs = Bs.hasOwnProperty, Ys = Bs.toString, zs = Ds ? Ds.toStringTag : void 0, qs = function (e) { var t = Vs.call(e, zs), n = e[zs]; try { e[zs] = void 0; var r = !0 } catch (e) { } var i = Ys.call(e); return r && (t ? e[zs] = n : delete e[zs]), i }, Ws = Object.prototype.toString, $s = function (e) { return Ws.call(e) }, Gs = "[object Null]", Js = "[object Undefined]", Zs = Ds ? Ds.toStringTag : void 0, Hs = function (e) { return null == e ? void 0 === e ? Js : Gs : Zs && Zs in Object(e) ? qs(e) : $s(e) }, Xs = function (e) { return null != e && "object" == typeof e }, Ks = "[object Arguments]", Qs = function (e) { return Xs(e) && Hs(e) == Ks }, ea = Object.prototype, ta = ea.hasOwnProperty, na = ea.propertyIsEnumerable, ra = Qs(function () { return arguments }()) ? Qs : function (e) { return Xs(e) && ta.call(e, "callee") && !na.call(e, "callee") }, ia = Array.isArray, oa = function () { return !1 }, sa = r(function (e, t) { var n = t && !t.nodeType && t, r = n && !0 && e && !e.nodeType && e, i = r && r.exports === n ? Us.Buffer : void 0, o = (i ? i.isBuffer : void 0) || oa; e.exports = o }), aa = 9007199254740991, ua = /^(?:0|[1-9]\d*)$/, fa = function (e, t) { return !!(t = null == t ? aa : t) && ("number" == typeof e || ua.test(e)) && e > -1 && e % 1 == 0 && e < t }, ca = 9007199254740991, la = function (e) { return "number" == typeof e && e > -1 && e % 1 == 0 && e <= ca }, ha = {}; ha["[object Float32Array]"] = ha["[object Float64Array]"] = ha["[object Int8Array]"] = ha["[object Int16Array]"] = ha["[object Int32Array]"] = ha["[object Uint8Array]"] = ha["[object Uint8ClampedArray]"] = ha["[object Uint16Array]"] = ha["[object Uint32Array]"] = !0, ha["[object Arguments]"] = ha["[object Array]"] = ha["[object ArrayBuffer]"] = ha["[object Boolean]"] = ha["[object DataView]"] = ha["[object Date]"] = ha["[object Error]"] = ha["[object Function]"] = ha["[object Map]"] = ha["[object Number]"] = ha["[object Object]"] = ha["[object RegExp]"] = ha["[object Set]"] = ha["[object String]"] = ha["[object WeakMap]"] = !1; var pa = function (e) { return function (t) { return e(t) } }, da = r(function (e, t) { var n = t && !t.nodeType && t, r = n && !0 && e && !e.nodeType && e, i = r && r.exports === n && js.process, o = function () { try { return i && i.binding && i.binding("util") } catch (e) { } }(); e.exports = o }), ma = da && da.isTypedArray, ya = ma ? pa(ma) : function (e) { return Xs(e) && la(e.length) && !!ha[Hs(e)] }, ga = Object.prototype.hasOwnProperty, va = function (e, t) { var n = ia(e), r = !n && ra(e), i = !n && !r && sa(e), o = !n && !r && !i && ya(e), s = n || r || i || o, a = s ? Ns(e.length, String) : [], u = a.length; for (var f in e) !t && !ga.call(e, f) || s && ("length" == f || i && ("offset" == f || "parent" == f) || o && ("buffer" == f || "byteLength" == f || "byteOffset" == f) || fa(f, u)) || a.push(f); return a }, ba = Object.prototype, wa = function (e) { var t = e && e.constructor; return e === ("function" == typeof t && t.prototype || ba) }, _a = function (e, t) { return function (n) { return e(t(n)) } }, Ea = _a(Object.keys, Object), Ta = Object.prototype.hasOwnProperty, Sa = function (e) { if (!wa(e)) return Ea(e); var t = []; for (var n in Object(e)) Ta.call(e, n) && "constructor" != n && t.push(n); return t }, Aa = function (e) { var t = typeof e; return null != e && ("object" == t || "function" == t) }, Ia = "[object AsyncFunction]", Ca = "[object Function]", Oa = "[object GeneratorFunction]", xa = "[object Proxy]", Ma = function (e) { if (!Aa(e)) return !1; var t = Hs(e); return t == Ca || t == Oa || t == Ia || t == xa }, Pa = function (e) { return null != e && la(e.length) && !Ma(e) }, Ra = function (e) { return Pa(e) ? va(e) : Sa(e) }, La = function (e) { return null == e ? [] : ks(e, Ra(e)) }, ka = function (e) { return Ps(La(e)) }, Na = function (e) { return (ia(e) ? Rs : ka)(e) }, ja = Wn.f; $r("getOwnPropertyDescriptor", function () { return function (e, t) { return ja(we(e), t) } }); var Fa = Z.Object, Ua = function (e, t) { return Fa.getOwnPropertyDescriptor(e, t) }, Da = n(r(function (e) { e.exports = { default: Ua, __esModule: !0 } })), Ba = r(function (e, t) { !function () { var n = { VERSION: "2.4.0", Result: { SUCCEEDED: 1, NOTRANSITION: 2, CANCELLED: 3, PENDING: 4 }, Error: { INVALID_TRANSITION: 100, PENDING_TRANSITION: 200, INVALID_CALLBACK: 300 }, WILDCARD: "*", ASYNC: "async", create: function (e, t) { var r = "string" == typeof e.initial ? { state: e.initial } : e.initial, i = e.terminal || e.final, o = t || e.target || {}, s = e.events || [], a = e.callbacks || {}, u = {}, f = {}, c = function (e) { var t = Array.isArray(e.from) ? e.from : e.from ? [e.from] : [n.WILDCARD]; u[e.name] = u[e.name] || {}; for (var r = 0; r < t.length; r++)f[t[r]] = f[t[r]] || [], f[t[r]].push(e.name), u[e.name][t[r]] = e.to || t[r]; e.to && (f[e.to] = f[e.to] || []) }; r && (r.event = r.event || "startup", c({ name: r.event, from: "none", to: r.state })); for (var l = 0; l < s.length; l++)c(s[l]); for (var h in u) u.hasOwnProperty(h) && (o[h] = n.buildEvent(h, u[h])); for (var h in a) a.hasOwnProperty(h) && (o[h] = a[h]); return o.current = "none", o.is = function (e) { return Array.isArray(e) ? e.indexOf(this.current) >= 0 : this.current === e }, o.can = function (e) { return !this.transition && void 0 !== u[e] && (u[e].hasOwnProperty(this.current) || u[e].hasOwnProperty(n.WILDCARD)) }, o.cannot = function (e) { return !this.can(e) }, o.transitions = function () { return (f[this.current] || []).concat(f[n.WILDCARD] || []) }, o.isFinished = function () { return this.is(i) }, o.error = e.error || function (e, t, n, r, i, o, s) { throw s || o }, o.states = function () { return Object.keys(f).sort() }, r && !r.defer && o[r.event](), o }, doCallback: function (e, t, r, i, o, s) { if (t) try { return t.apply(e, [r, i, o].concat(s)) } catch (t) { return e.error(r, i, o, s, n.Error.INVALID_CALLBACK, "an exception occurred in a caller-provided callback function", t) } }, beforeAnyEvent: function (e, t, r, i, o) { return n.doCallback(e, e.onbeforeevent, t, r, i, o) }, afterAnyEvent: function (e, t, r, i, o) { return n.doCallback(e, e.onafterevent || e.onevent, t, r, i, o) }, leaveAnyState: function (e, t, r, i, o) { return n.doCallback(e, e.onleavestate, t, r, i, o) }, enterAnyState: function (e, t, r, i, o) { return n.doCallback(e, e.onenterstate || e.onstate, t, r, i, o) }, changeState: function (e, t, r, i, o) { return n.doCallback(e, e.onchangestate, t, r, i, o) }, beforeThisEvent: function (e, t, r, i, o) { return n.doCallback(e, e["onbefore" + t], t, r, i, o) }, afterThisEvent: function (e, t, r, i, o) { return n.doCallback(e, e["onafter" + t] || e["on" + t], t, r, i, o) }, leaveThisState: function (e, t, r, i, o) { return n.doCallback(e, e["onleave" + r], t, r, i, o) }, enterThisState: function (e, t, r, i, o) { return n.doCallback(e, e["onenter" + i] || e["on" + i], t, r, i, o) }, beforeEvent: function (e, t, r, i, o) { if (!1 === n.beforeThisEvent(e, t, r, i, o) || !1 === n.beforeAnyEvent(e, t, r, i, o)) return !1 }, afterEvent: function (e, t, r, i, o) { n.afterThisEvent(e, t, r, i, o), n.afterAnyEvent(e, t, r, i, o) }, leaveState: function (e, t, r, i, o) { var s = n.leaveThisState(e, t, r, i, o), a = n.leaveAnyState(e, t, r, i, o); return !1 !== s && !1 !== a && (n.ASYNC === s || n.ASYNC === a ? n.ASYNC : void 0) }, enterState: function (e, t, r, i, o) { n.enterThisState(e, t, r, i, o), n.enterAnyState(e, t, r, i, o) }, buildEvent: function (e, t) { return function () { var r = this.current, i = t[r] || (t[n.WILDCARD] != n.WILDCARD ? t[n.WILDCARD] : r) || r, o = Array.prototype.slice.call(arguments); if (this.transition) return this.error(e, r, i, o, n.Error.PENDING_TRANSITION, "event " + e + " inappropriate because previous transition did not complete"); if (this.cannot(e)) return this.error(e, r, i, o, n.Error.INVALID_TRANSITION, "event " + e + " inappropriate in current state " + this.current); if (!1 === n.beforeEvent(this, e, r, i, o)) return n.Result.CANCELLED; if (r === i) return n.afterEvent(this, e, r, i, o), n.Result.NOTRANSITION; var s = this; this.transition = function () { return s.transition = null, s.current = i, n.enterState(s, e, r, i, o), n.changeState(s, e, r, i, o), n.afterEvent(s, e, r, i, o), n.Result.SUCCEEDED }, this.transition.cancel = function () { s.transition = null, n.afterEvent(s, e, r, i, o) }; var a = n.leaveState(this, e, r, i, o); return !1 === a ? (this.transition = null, n.Result.CANCELLED) : n.ASYNC === a ? n.Result.PENDING : this.transition ? this.transition() : void 0 } } }; e.exports && (t = e.exports = n), t.StateMachine = n }() }), Va = Mn.getWeak, Ya = ko(5), za = ko(6), qa = 0, Wa = function (e) { return e._l || (e._l = new $a) }, $a = function () { this.a = [] }, Ga = function (e, t) { return Ya(e.a, function (e) { return e[0] === t }) }; $a.prototype = { get: function (e) { var t = Ga(this, e); if (t) return t[1] }, has: function (e) { return !!Ga(this, e) }, set: function (e, t) { var n = Ga(this, e); n ? n[1] = t : this.a.push([e, t]) }, delete: function (e) { var t = za(this.a, function (t) { return t[0] === e }); return ~t && this.a.splice(t, 1), !!~t } }; var Ja = { getConstructor: function (e, t, n, r) { var i = e(function (e, o) { _t(e, i, t, "_i"), e._t = t, e._i = qa++ , e._l = void 0, void 0 != o && Ot(o, n, e[r], e) }); return Ht(i.prototype, { delete: function (e) { if (!K(e)) return !1; var n = Va(e); return !0 === n ? Wa(Ao(this, t)).delete(e) : n && me(n, this._i) && delete n[this._i] }, has: function (e) { if (!K(e)) return !1; var n = Va(e); return !0 === n ? Wa(Ao(this, t)).has(e) : n && me(n, this._i) } }), i }, def: function (e, t, n) { var r = Va(Q(t), !0); return !0 === r ? Wa(e).set(t, n) : r[e._i] = n, e }, ufstore: Wa }; r(function (e) { var t, n = ko(0), r = Mn.getWeak, i = Object.isExtensible, o = Ja.ufstore, s = {}, a = function (e) { return function () { return e(this, arguments.length > 0 ? arguments[0] : void 0) } }, u = { get: function (e) { if (K(e)) { var t = r(e); return !0 === t ? o(Ao(this, "WeakMap")).get(e) : t ? t[this._i] : void 0 } }, set: function (e, t) { return Ja.def(Ao(this, "WeakMap"), e, t) } }, f = e.exports = Fo("WeakMap", a, u, Ja, !0, !0); ee(function () { return 7 != (new f).set((Object.freeze || Object)(s), 7).get(s) }) && (t = Ja.getConstructor(a, "WeakMap"), po(t.prototype, u), Mn.NEED = !0, n(["delete", "has", "get", "set"], function (e) { var n = f.prototype, r = n[e]; pe(n, e, function (n, o) { if (K(n) && !i(n)) { this._f || (this._f = new t); var s = this._f[e](n, o); return "set" == e ? this : s } return r.call(this, n, o) }) })) }); Do("WeakMap"), Bo("WeakMap"); var Za = Z.WeakMap, Ha = n(r(function (e) { e.exports = { default: Za, __esModule: !0 } })), Xa = _a(Object.getPrototypeOf, Object), Ka = "[object Object]", Qa = Function.prototype, eu = Object.prototype, tu = Qa.toString, nu = eu.hasOwnProperty, ru = tu.call(Object), iu = function (e) { if (!Xs(e) || Hs(e) != Ka) return !1; var t = Xa(e); if (null === t) return !0; var n = nu.call(t, "constructor") && t.constructor; return "function" == typeof n && n instanceof n && tu.call(n) == ru }, ou = "undefined" != typeof global ? global : "undefined" != typeof window ? window : {}, su = Sr("expired"), au = Ho("LC:Expirable"), uu = function () { function e(t, n) { Cr(this, e), this._value = t, "number" == typeof n && (this.expiredAt = Date.now() + n) } return vi(e, [{ key: "value", get: function () { var e = this.expiredAt && this.expiredAt < Date.now(); return e && au("expired: " + this._value), e ? su : this._value } }]), e }(); uu.EXPIRED = su; var fu, cu = Ho("LC:Cache"), lu = function () { function e() { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : "anonymous"; Cr(this, e), this.name = t, this._map = {} } return e.prototype.get = function (e) { var t = this._map[e]; if (t) { var n = t.value; if (n !== uu.EXPIRED) return cu("[%s] hit: %s %O", this.name, e, n), n; delete this._map[e] } return cu("[" + this.name + "] missed: " + e), null }, e.prototype.set = function (e, t, n) { cu("[%s] set: %s %O %d", this.name, e, t, n), this._map[e] = new uu(t, n) }, e }(), hu = function e(t) { var n = new In(t[0]); return 1 === t.length ? n : n.catch(function () { return e(t.slice(1)) }) }, pu = function (e) { return function (t) { return e(t), t } }, du = function (e) { return e ? "string" == typeof e || "number" == typeof e ? new Date(e) : "Date" === e.__type && e.iso ? new Date(e.iso) : "function" == typeof e.toNumber ? new Date(e.toNumber()) : e : e }, mu = function (e) { return e && e.getTime ? e.getTime() : void 0 }, yu = function e(t) { return t ? "Date" === t.__type && t.iso ? new Date(t.iso) : iu(t) ? Jr(t).reduce(function (n, r) { return vo({}, n, Lr({}, r, e(t[r]))) }, {}) : t : t }, gu = function e(t) { return t instanceof Date ? { __type: "Date", iso: t.toJSON() } : iu(t) ? Jr(t).reduce(function (n, r) { return vo({}, n, Lr({}, r, e(t[r]))) }, {}) : t }, vu = function (e, t) { return Jr(t).reduce(function (n, r) { var i = e[r] || r; return go(n, Lr({}, i, t[r])) }, {}) }, bu = ou.navigator && ou.navigator.userAgent && -1 !== ou.navigator.userAgent.indexOf("MSIE 10."), wu = function e(t, n) { return t[n] || (t.__proto__ ? e(t.__proto__, n) : void 0) }, _u = function (e, t) { return To(new Yo([].concat(So(e), So(t)))) }, Eu = function (e, t) { return To(function (t) { return new Yo(e.filter(function (e) { return !t.has(e) })) }(new Yo(t))) }, Tu = new Ha, Su = function (e) { return Tu.has(e) || Tu.set(e, {}), Tu.get(e) }, Au = function e(t, n) { if (!iu(t)) return t; var r = go({}, t); for (var i in r) if ({}.hasOwnProperty.call(r, i)) { var o = r[i]; o === n ? delete r[i] : r[i] = e(o, n) } return r }, Iu = function (e) { return Au(e, null) }, Cu = function (e) { return Iu(JSON.parse(Wr(e))) }, Ou = function (e) { return Array.isArray(e) ? e : void 0 === e || null === e ? [] : [e] }, xu = function (e, t, n) { var r = t.split("."), i = r.pop(), o = e; return r.forEach(function (e) { void 0 === o[e] && (o[e] = {}), o = o[e] }), o[i] = n, e }, Mu = "object" === ("undefined" == typeof wx ? "undefined" : Ir(wx)) && "function" == typeof wx.connectSocket, Pu = function (e) { return function (t, n, r) { var i = r.value; if (i.length) throw new Error("throttled function should not accept any arguments"); return vo({}, r, { value: function () { var t = this, r = Su(this).throttleMeta; r || (r = {}, Su(this).throttleMeta = r); var o = r[n]; o || (o = {}, r[n] = o); var s = o, a = s.previouseTimestamp, u = void 0 === a ? 0 : a, f = s.timeout, c = Date.now(), l = e - (c - u); l <= 0 ? (r[n].previouseTimestamp = c, i.apply(this)) : f || (o.timeout = setTimeout(function () { o.previouseTimestamp = Date.now(), delete o.timeout, i.apply(t) }, l)) } }) } }, Ru = ou.WebSocket || ou.MozWebSocket, Lu = Ho("LC:WebSocketPlus"), ku = function (e) { return Math.min(1e3 * Math.pow(2, e), 3e5) }, Nu = function (e, t, n) { return go({}, n, { value: function () { var e; if (!this.is("connected")) { var r = this.current; throw console.warn(t + " should not be called when the connection is " + r), (this.is("disconnected") || this.is("reconnecting")) && console.warn("disconnect and reconnect event should be handled to avoid such calls."), new Error("Connection unavailable") } for (var i = arguments.length, o = Array(i), s = 0; s < i; s++)o[s] = arguments[s]; return (e = n.value).call.apply(e, [this].concat(o)) } }) }, ju = (fu = function (e) { function t(n, r) { if (Cr(this, t), void 0 === Ru) throw new Error("WebSocket is undefined. Polyfill is required in this runtime."); var i = kr(this, e.call(this)); return i._getUrls = "function" != typeof n ? function () { return In.resolve(n) } : n, i._protocol = r, i.init(), i._createWs(i._getUrls, i._protocol).then(function () { i.__postponeTimeoutTimer = i._postponeTimeoutTimer.bind(i), ou.addEventListener && (i.__pause = function () { return i.pause() }, i.__resume = function () { return i.resume() }, ou.addEventListener("offline", i.__pause), ou.addEventListener("online", i.__resume)), i.open() }).catch(i.throw.bind(i)), i } return Yr(t, e), t.prototype._createWs = function (e, t) { var n = this; return e().then(function (e) { return hu(Ou(e).map(function (e) { return function (r, i) { Lu("connect [" + e + "] " + t); var o = t ? new Ru(e, t) : new Ru(e); o.binaryType = n.binaryType || "arraybuffer", o.onopen = function () { return r(o) }, o.onclose = function (t) { return i(t instanceof Error ? t : new Error("Failed to connect [" + e + "]")) }, o.onerror = o.onclose } })).then(function (e) { return n._ws = e, n._ws.onclose = n._handleClose.bind(n), n._ws.onmessage = n._handleMessage.bind(n), e }) }) }, t.prototype._destroyWs = function () { var e = this._ws; e && (e.onopen = null, e.onclose = null, e.onerror = null, e.onmessage = null, this._ws = null, e.close()) }, t.prototype.onbeforeevent = function (e, t, n) { for (var r = arguments.length, i = Array(r > 3 ? r - 3 : 0), o = 3; o < r; o++)i[o - 3] = arguments[o]; Lu.apply(void 0, [e + ": " + t + " -> " + n].concat(i)) }, t.prototype.onopen = function () { this.emit("open") }, t.prototype.onconnected = function () { this._startConnectionKeeper() }, t.prototype.onleaveconnected = function (e, t, n) { this._stopConnectionKeeper(), this._destroyWs(), "offline" !== n && "disconnected" !== n || this.emit("disconnect") }, t.prototype.onpause = function () { this.emit("offline") }, t.prototype.onbeforeresume = function () { this.emit("online") }, t.prototype.onreconnect = function () { this.emit("reconnect") }, t.prototype.ondisconnected = function (e, t, n) { var r = this, i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0, o = ku.call(null, i); Lu("schedule attempt=" + i + " delay=" + o), this.emit("schedule", i, o), this.__scheduledRetry && clearTimeout(this.__scheduledRetry), this.__scheduledRetry = setTimeout(function () { r.is("disconnected") && r.retry(i) }, o) }, t.prototype.onretry = function (e, t, n) { var r = this, i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 0; this.emit("retry", i), this._createWs(this._getUrls, this._protocol).then(function () { return r.can("reconnect") ? r.reconnect() : r._destroyWs() }, function () { return r.can("fail") && r.fail(i + 1) }) }, t.prototype.onerror = function (e, t, n, r) { this.emit("error", r) }, t.prototype.onclose = function () { ou.removeEventListener && (this.__pause && ou.removeEventListener("offline", this.__pause), this.__resume && ou.removeEventListener("online", this.__resume)) }, t.prototype._ping = function () { Lu("ping"); try { this.ping() } catch (e) { console.warn("websocket ping error: " + e.message) } }, t.prototype.ping = function () { this._ws.ping ? this._ws.ping() : console.warn("The WebSocket implement does not support sending ping frame.\n        Override ping method to use application defined ping/pong mechanism.") }, t.prototype._postponeTimeoutTimer = function () { var e = this; Lu("_postponeTimeoutTimer"), this._clearTimeoutTimers(), this._timeoutTimer = setTimeout(function () { Lu("timeout"), e.disconnect() }, 38e4) }, t.prototype._clearTimeoutTimers = function () { this._timeoutTimer && clearTimeout(this._timeoutTimer) }, t.prototype._startConnectionKeeper = function () { Lu("start connection keeper"), this._heartbeatTimer = setInterval(this._ping.bind(this), 18e4); var e = this._ws.addListener || this._ws.addEventListener; e.call(this._ws, "message", this.__postponeTimeoutTimer), e.call(this._ws, "pong", this.__postponeTimeoutTimer), this._postponeTimeoutTimer() }, t.prototype._stopConnectionKeeper = function () { Lu("stop connection keeper"); var e = this._ws.removeListener || this._ws.removeEventListener; e.call(this._ws, "message", this.__postponeTimeoutTimer), e.call(this._ws, "pong", this.__postponeTimeoutTimer), this._clearTimeoutTimers(), this._heartbeatTimer && clearInterval(this._heartbeatTimer) }, t.prototype._handleClose = function (e) { Lu("ws closed [" + e.code + "] " + e.reason), this.isFinished() || this.handleClose(e) }, t.prototype.handleClose = function () { this.disconnect() }, t.prototype.send = function (e) { Lu("send", e), this._ws.send(e) }, t.prototype._handleMessage = function (e) { Lu("message", e.data), this.handleMessage(e.data) }, t.prototype.handleMessage = function (e) { this.emit("message", e) }, t }(oo), M(fu.prototype, "_ping", [Nu], Da(fu.prototype, "_ping"), fu.prototype), M(fu.prototype, "send", [Nu], Da(fu.prototype, "send"), fu.prototype), fu); Ba.create({ target: ju.prototype, initial: { state: "initialized", event: "init", defer: !0 }, terminal: "closed", events: [{ name: "open", from: "initialized", to: "connected" }, { name: "disconnect", from: "connected", to: "disconnected" }, { name: "retry", from: "disconnected", to: "reconnecting" }, { name: "fail", from: "reconnecting", to: "disconnected" }, { name: "reconnect", from: "reconnecting", to: "connected" }, { name: "pause", from: ["connected", "disconnected", "reconnecting"], to: "offline" }, {}, { name: "resume", from: "offline", to: "disconnected" }, { name: "close", from: ["connected", "disconnected", "reconnecting", "offline"], to: "closed" }, { name: "throw", from: "*", to: "error" }] }); var Fu = Mn.onFreeze; $r("freeze", function (e) { return function (t) { return e && K(t) ? e(Fu(t)) : t } }); var Uu, Du = Z.Object.freeze, Bu = n(r(function (e) { e.exports = { default: Du, __esModule: !0 } })), Vu = Bu({ 1e3: { name: "CLOSE_NORMAL" }, 1006: { name: "CLOSE_ABNORMAL" }, 4100: { name: "APP_NOT_AVAILABLE", message: "App not exists or realtime message service is disabled." }, 4103: { name: "INVALID_LOGIN", message: "Malformed clientId." }, 4105: { name: "SESSION_REQUIRED", message: "Message sent before session opened. " }, 4107: { name: "READ_TIMEOUT" }, 4108: { name: "LOGIN_TIMEOUT" }, 4109: { name: "FRAME_TOO_LONG" }, 4110: { name: "INVALID_ORIGIN", message: "Access denied by domain whitelist." }, 4111: { name: "SESSION_CONFLICT" }, 4112: { name: "SESSION_TOKEN_EXPIRED" }, 4200: { name: "INTERNAL_ERROR", message: "Internal error, please contact LeanCloud for support." }, 4201: { name: "SEND_MESSAGE_TIMEOUT" }, 4302: { name: "CONVERSATION_SIGNATURE_FAILED" }, 4303: { name: "CONVERSATION_NOT_FOUND" }, 4304: { name: "CONVERSATION_FULL" }, 4305: { name: "CONVERSATION_REJECTED_BY_APP" }, 4306: { name: "CONVERSATION_UPDATE_FAILED" }, 4307: { name: "CONVERSATION_READ_ONLY" }, 4308: { name: "CONVERSATION_NOT_ALLOWED" }, 4317: { name: "CONVERSATION_EXPIRED", message: "Temporary conversation expired or does not exist." }, 4401: { name: "INVALID_MESSAGING_TARGET" }, 4402: { name: "MESSAGE_REJECTED_BY_APP" } }), Yu = Bu(Jr(Vu).reduce(function (e, t) { return go(e, Lr({}, Vu[t].name, Number(t))) }, {})), zu = function (e) { var t = e.code, n = e.reason, r = e.appCode, i = e.detail, o = n || i; !o && Vu[t] && (o = Vu[t].message || Vu[t].name), o || (o = "Unknow Error: " + t); var s = new Error(o); return go(s, { code: t, appCode: r, detail: i }) }, qu = Ho("LC:Connection"), Wu = function (e) { function t(n, r) { var i = r.format, o = r.version; Cr(this, t), qu("initializing Connection"); var s = "lc." + i + "." + o; if (Mu) a = kr(this, e.call(this, n().then(function (e) { return e.map(function (e) { return e + (-1 === e.indexOf("?") ? "?" : "&") + "subprotocol=" + encodeURIComponent(s) }) }))); else var a = kr(this, e.call(this, n, s)); return a._protocalFormat = i, a._commands = {}, a._serialId = 0, kr(a) } return Yr(t, e), t.prototype.send = function (t) { var n = this, r = !(arguments.length > 1 && void 0 !== arguments[1]) || arguments[1], i = void 0; r && (this._serialId += 1, i = this._serialId, t.i = i), qu("↑ %O sent", Cu(t)); var o = void 0; if ("proto2base64" === this._protocalFormat ? o = t.toBase64() : t.toArrayBuffer && (o = t.toArrayBuffer()), !o) throw new TypeError(t + " is not a GenericCommand"); return e.prototype.send.call(this, o), r ? new In(function (e, r) { n._commands[i] = { resolve: e, reject: r, timeout: setTimeout(function () { n._commands[i] && (qu("✗ %O timeout", Cu(t)), r(new Error("Command Timeout.")), delete n._commands[i]) }, 2e4) } }) : In.resolve() }, t.prototype.handleMessage = function (e) { var t = void 0; try { t = Ki.decode(e), qu("↓ %O received", Cu(t)) } catch (t) { console.warn("Decode message failed", e) } this.emit("allmessage", t); var n = t.i; n ? this._commands[n] ? (clearTimeout(this._commands[n].timeout), t.cmd === to.error ? this._commands[n].reject(zu(t.errorMessage)) : this._commands[n].resolve(t), delete this._commands[n]) : console.warn("Unexpected command received with serialId [" + n + "],\n         which have timed out or never been requested.") : t.cmd === to.error ? this.emit("error", zu(t.errorMessage)) : this.emit("message", t) }, t.prototype.ping = function () { return this.send(new Ki({ cmd: to.echo })).catch(function (e) { return qu("ping failed:", e) }) }, t }(ju), $u = function (e) { return function (t) { var n = t.constructor; return In.resolve(t).then(e).then(pu(function (r) { return void 0 === r || null === r ? console.warn("Middleware[" + (e._pluginName || "anonymous plugin") + ":" + (e.name || "anonymous middleware") + "] param/return types not match. It returns " + r + " while a " + t.constructor.name + " expected.") : r instanceof n ? 0 : console.warn("Middleware[" + (e._pluginName || "anonymous plugin") + ":" + (e.name || "anonymous middleware") + "] param/return types not match. It returns a " + r.constructor.name + " while a " + t.constructor.name + " expected.") })) } }, Gu = function (e, t) { e && e.forEach(function (e) { try { e(t) } catch (t) { throw e._pluginName && (t.message += "[" + e._pluginName + "]"), t } }) }, Ju = function (e) { return function (t) { return Ou(e).reduce(function (e, t) { return e.then($u(t)).catch(function (e) { throw t._pluginName && (e.message += "[" + t._pluginName + "]"), e }) }, In.resolve(t)) } }, Zu = function (e, t) { return Ou(e).reduce(function (e, n) { return e.then(function (e) { return !1 !== e && n.apply(void 0, So(t)) }).catch(function (e) { throw n._pluginName && (e.message += "[" + n._pluginName + "]"), e }) }, In.resolve(!0)) }, Hu = Ho("LC:Realtime"), Xu = new lu("push-router"), Ku = function (e) { function t(n) { Cr(this, t), Hu("initializing Realtime"); var r = kr(this, e.call(this)); if ("string" != typeof n.appId) throw new TypeError("appId [" + n.appId + "] is not a string"); if ("string" != typeof n.appKey) throw new TypeError("appKey [" + n.appKey + "] is not a string"); return r._options = go({ appId: void 0, appKey: void 0, region: "cn", pushOfflineMessages: !1, noBinary: !1, ssl: !0, RTMServerName: Y.env.RTM_SERVER_NAME }, n), r._cache = new lu("endpoints"), Su(r).clients = new Yo, r._plugins = [].concat(So(Ou(t.__preRegisteredPlugins)), So(Ou(n.plugins))).reduce(function (e, t) { for (var n in t) ({}).hasOwnProperty.call(t, n) && "name" !== n && (t.name && Ou(t[n]).forEach(function (e) { e._pluginName = t.name }), e[n] = Ou(e[n]).concat(t[n])); return e }, {}), Gu(r._plugins.onRealtimeCreate, r), r } return Yr(t, e), t.prototype._request = function () { var e = bo(lo.mark(function e(t) { var n, r, i, o, s, a, u = t.method, f = t.version, c = void 0 === f ? "1.1" : f, l = t.path, h = t.query, p = t.headers, d = t.data, m = void 0 === d ? {} : d; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return n = this._options, r = n.appId, i = n.region, e.next = 3, this.constructor._getServerUrls({ appId: r, region: i }); case 3: return o = e.sent, s = o.api, a = "https://" + s + "/" + c + l, e.abrupt("return", Is(a, { method: u, params: h, headers: vo({ "X-LC-Id": this._options.appId, "X-LC-Key": this._options.appKey }, p), data: m }).then(function (e) { return e.data })); case 7: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._open = function () { var e = this; if (this._openPromise) return this._openPromise; var t = "protobuf2"; this._options.noBinary && (t = "proto2base64"); var n = 3; this._options.pushOfflineMessages && (n = 1); var r = { format: t, version: n }; return this._openPromise = new In(function (t, n) { Hu("No connection established, create a new one."); var i = new Wu(function () { return e._getRTMServers(e._options) }, r); i.on("open", function () { return t(i) }), i.on("error", n), i.on("message", e._dispatchCommand.bind(e)), ["disconnect", "reconnect", "retry", "schedule", "offline", "online"].forEach(function (t) { return i.on(t, function () { for (var n = arguments.length, r = Array(n), i = 0; i < n; i++)r[i] = arguments[i]; Hu(t + " event emitted. %O", r), e.emit.apply(e, [t].concat(r)), "reconnect" !== t && Su(e).clients.forEach(function (e) { e.emit.apply(e, [t].concat(r)) }) }) }), i.handleClose = function (e) { [Yu.APP_NOT_AVAILABLE, Yu.INVALID_LOGIN, Yu.INVALID_ORIGIN].some(function (t) { return t === e.code }) ? this.throw(zu(e)) : this.disconnect() }, Su(e).connection = i }), this._openPromise }, t.prototype._getRTMServers = function () { var e = bo(lo.mark(function e(t) { var n, r; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (!t.RTMServers) { e.next = 2; break } return e.abrupt("return", Na(Ou(t.RTMServers))); case 2: if (n = void 0, !(r = this._cache.get("endpoints"))) { e.next = 10; break } return e.next = 7, r; case 7: n = e.sent, e.next = 14; break; case 10: return e.next = 12, this.constructor._fetchRTMServers(t); case 12: n = e.sent, this._cache.set("endpoints", n, 1e3 * n.ttl); case 14: return Hu("endpoint info: %O", n), e.abrupt("return", [n.server, n.secondary]); case 16: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t._getServerUrls = function () { var e = bo(lo.mark(function e(t) { var n, r = t.appId, i = t.region, o = t.server; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (Hu("fetch server urls"), !o) { e.next = 5; break } if ("string" == typeof o) { e.next = 4; break } return e.abrupt("return", o); case 4: return e.abrupt("return", { RTMRouter: o, api: o }); case 5: e.t0 = i, e.next = "cn" === e.t0 ? 8 : "us" === e.t0 ? 12 : 13; break; case 8: if (!(n = Xu.get(r))) { e.next = 11; break } return e.abrupt("return", n); case 11: return e.abrupt("return", Is.get("https://app-router.leancloud.cn/2/route", { params: { appId: r }, timeout: 2e4 }).then(function (e) { return e.data }).then(pu(Hu)).then(function (e) { var t = e.rtm_router_server, n = e.api_server, i = e.ttl, o = void 0 === i ? 3600 : i; if (!t) throw new Error("rtm router not exists"); var s = { RTMRouter: t, api: n }; return Xu.set(r, s, 1e3 * o), s }).catch(function () { var e = r.slice(0, 8).toLowerCase(); return { RTMRouter: e + ".rtm.lncld.net", api: e + ".api.lncld.net" } })); case 12: return e.abrupt("return", { RTMRouter: "router-a0-push.leancloud.cn", api: "us-api.leancloud.cn" }); case 13: throw new Error("Region [" + i + "] is not supported."); case 14: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t._fetchRTMServers = function (e) { var t = e.appId, n = e.region, r = e.ssl, i = e.server, o = e.RTMServerName; return Hu("fetch endpoint info"), this._getServerUrls({ appId: t, region: n, server: i }).then(pu(Hu)).then(function (e) { var n = e.RTMRouter; return Is.get("https://" + n + "/v1/route", { params: { appId: t, secure: r, features: Mu ? "wechat" : void 0, server: o, _t: Date.now() }, timeout: 2e4 }).then(function (e) { return e.data }).then(pu(Hu)) }) }, t.prototype._close = function () { this._openPromise && this._openPromise.then(function (e) { return e.close() }), delete this._openPromise }, t.prototype.retry = function () { var e = Su(this).connection; if (!e) throw new Error("no connection established"); if (e.cannot("retry")) throw new Error("retrying not allowed when not disconnected. the connection is now " + e.current); return e.retry() }, t.prototype.pause = function () { var e = Su(this).connection; e && e.can("pause") && e.pause() }, t.prototype.resume = function () { var e = Su(this).connection; e && e.can("resume") && e.resume() }, t.prototype._register = function (e) { Su(this).clients.add(e) }, t.prototype._deregister = function (e) { Su(this).clients.delete(e), 0 === Su(this).clients.size && this._close() }, t.prototype._dispatchCommand = function (e) { return Zu(this._plugins.beforeCommandDispatch, [e, this]).then(function (t) { return !!t && Hu("[WARN] Unexpected message received: %O", Cu(e)) }) }, t }(oo), Qu = z.crypto || z.msCrypto; if (Qu && Qu.getRandomValues) { var ef = new Uint8Array(16); Uu = function () { return Qu.getRandomValues(ef), ef } } if (!Uu) { var tf = new Array(16); Uu = function () { for (var e, t = 0; t < 16; t++)0 == (3 & t) && (e = 4294967296 * Math.random()), tf[t] = e >>> ((3 & t) << 3) & 255; return tf } } for (var nf = Uu, rf = [], of = 0; of < 256; ++of)rf[of] = (of + 256).toString(16).substr(1); var sf = function (e, t) { var n = t || 0, r = rf; return r[e[n++]] + r[e[n++]] + r[e[n++]] + r[e[n++]] + "-" + r[e[n++]] + r[e[n++]] + "-" + r[e[n++]] + r[e[n++]] + "-" + r[e[n++]] + r[e[n++]] + "-" + r[e[n++]] + r[e[n++]] + r[e[n++]] + r[e[n++]] + r[e[n++]] + r[e[n++]] }, af = function (e, t, n) { var r = t && n || 0; "string" == typeof e && (t = "binary" == e ? new Array(16) : null, e = null); var i = (e = e || {}).random || (e.rng || nf)(); if (i[6] = 15 & i[6] | 64, i[8] = 63 & i[8] | 128, t) for (var o = 0; o < 16; ++o)t[r + o] = i[o]; return t || sf(i) }, uf = n(r(function (e, t) { t.__esModule = !0, t.default = function (e, t) { var n = {}; for (var r in e) t.indexOf(r) >= 0 || Object.prototype.hasOwnProperty.call(e, r) && (n[r] = e[r]); return n } })), ff = We("iterator"), cf = Z.isIterable = function (e) { var t = Object(e); return void 0 !== t[ff] || "@@iterator" in t || ye.hasOwnProperty(wt(t)) }, lf = r(function (e) { e.exports = { default: cf, __esModule: !0 } }); n(lf); var hf = Z.getIterator = function (e) { var t = Ct(e); if ("function" != typeof t) throw TypeError(e + " is not iterable!"); return Q(t.call(e)) }, pf = r(function (e) { e.exports = { default: hf, __esModule: !0 } }), df = n(pf), mf = n(r(function (e, t) { function n(e) { return e && e.__esModule ? e : { default: e } } t.__esModule = !0; var r = n(lf), i = n(pf); t.default = function () { function e(e, t) { var n = [], r = !0, o = !1, s = void 0; try { for (var a, u = (0, i.default)(e); !(r = (a = u.next()).done) && (n.push(a.value), !t || n.length !== t); r = !0); } catch (e) { o = !0, s = e } finally { try { !r && u.return && u.return() } finally { if (o) throw s } } return n } return function (t, n) { if (Array.isArray(t)) return t; if ((0, r.default)(Object(t))) return e(t, n); throw new TypeError("Invalid attempt to destructure non-iterable instance") } }() })), yf = r(function (e, t) { !function () { for (var e = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", n = new Uint8Array(256), r = 0; r < e.length; r++)n[e.charCodeAt(r)] = r; t.encode = function (t) { var n, r = new Uint8Array(t), i = r.length, o = ""; for (n = 0; n < i; n += 3)o += e[r[n] >> 2], o += e[(3 & r[n]) << 4 | r[n + 1] >> 4], o += e[(15 & r[n + 1]) << 2 | r[n + 2] >> 6], o += e[63 & r[n + 2]]; return i % 3 == 2 ? o = o.substring(0, o.length - 1) + "=" : i % 3 == 1 && (o = o.substring(0, o.length - 2) + "=="), o }, t.decode = function (e) { var t, r, i, o, s, a = .75 * e.length, u = e.length, f = 0; "=" === e[e.length - 1] && (a-- , "=" === e[e.length - 2] && a--); var c = new ArrayBuffer(a), l = new Uint8Array(c); for (t = 0; t < u; t += 4)r = n[e.charCodeAt(t)], i = n[e.charCodeAt(t + 1)], o = n[e.charCodeAt(t + 2)], s = n[e.charCodeAt(t + 3)], l[f++] = r << 2 | i >> 4, l[f++] = (15 & i) << 4 | o >> 2, l[f++] = (3 & o) << 6 | 63 & s; return c } }() }), gf = yf.encode, vf = yf.decode, bf = function (e, t) { return e === t || e !== e && t !== t }, wf = function (e, t) { for (var n = e.length; n--;)if (bf(e[n][0], t)) return n; return -1 }, _f = Array.prototype.splice; P.prototype.clear = function () { this.__data__ = [], this.size = 0 }, P.prototype.delete = function (e) { var t = this.__data__, n = wf(t, e); return !(n < 0 || (n == t.length - 1 ? t.pop() : _f.call(t, n, 1), --this.size, 0)) }, P.prototype.get = function (e) { var t = this.__data__, n = wf(t, e); return n < 0 ? void 0 : t[n][1] }, P.prototype.has = function (e) { return wf(this.__data__, e) > -1 }, P.prototype.set = function (e, t) { var n = this.__data__, r = wf(n, e); return r < 0 ? (++this.size, n.push([e, t])) : n[r][1] = t, this }; var Ef = P, Tf = Us["__core-js_shared__"], Sf = function () { var e = /[^.]+$/.exec(Tf && Tf.keys && Tf.keys.IE_PROTO || ""); return e ? "Symbol(src)_1." + e : "" }(), Af = function (e) { return !!Sf && Sf in e }, If = Function.prototype.toString, Cf = function (e) { if (null != e) { try { return If.call(e) } catch (e) { } try { return e + "" } catch (e) { } } return "" }, Of = /[\\^$.*+?()[\]{}|]/g, xf = /^\[object .+?Constructor\]$/, Mf = Function.prototype, Pf = Object.prototype, Rf = Mf.toString, Lf = Pf.hasOwnProperty, kf = RegExp("^" + Rf.call(Lf).replace(Of, "\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g, "$1.*?") + "$"), Nf = function (e) { return !(!Aa(e) || Af(e)) && (Ma(e) ? kf : xf).test(Cf(e)) }, jf = function (e, t) { return null == e ? void 0 : e[t] }, Ff = function (e, t) { var n = jf(e, t); return Nf(n) ? n : void 0 }, Uf = Ff(Us, "Map"), Df = Ff(Object, "create"), Bf = "__lodash_hash_undefined__", Vf = Object.prototype.hasOwnProperty, Yf = Object.prototype.hasOwnProperty, zf = "__lodash_hash_undefined__"; R.prototype.clear = function () { this.__data__ = Df ? Df(null) : {}, this.size = 0 }, R.prototype.delete = function (e) { var t = this.has(e) && delete this.__data__[e]; return this.size -= t ? 1 : 0, t }, R.prototype.get = function (e) { var t = this.__data__; if (Df) { var n = t[e]; return n === Bf ? void 0 : n } return Vf.call(t, e) ? t[e] : void 0 }, R.prototype.has = function (e) { var t = this.__data__; return Df ? void 0 !== t[e] : Yf.call(t, e) }, R.prototype.set = function (e, t) { var n = this.__data__; return this.size += this.has(e) ? 0 : 1, n[e] = Df && void 0 === t ? zf : t, this }; var qf = R, Wf = function (e) { var t = typeof e; return "string" == t || "number" == t || "symbol" == t || "boolean" == t ? "__proto__" !== e : null === e }, $f = function (e, t) { var n = e.__data__; return Wf(t) ? n["string" == typeof t ? "string" : "hash"] : n.map }; L.prototype.clear = function () { this.size = 0, this.__data__ = { hash: new qf, map: new (Uf || Ef), string: new qf } }, L.prototype.delete = function (e) { var t = $f(this, e).delete(e); return this.size -= t ? 1 : 0, t }, L.prototype.get = function (e) { return $f(this, e).get(e) }, L.prototype.has = function (e) { return $f(this, e).has(e) }, L.prototype.set = function (e, t) { var n = $f(this, e), r = n.size; return n.set(e, t), this.size += n.size == r ? 0 : 1, this }; var Gf = L, Jf = 200; k.prototype.clear = function () { this.__data__ = new Ef, this.size = 0 }, k.prototype.delete = function (e) { var t = this.__data__, n = t.delete(e); return this.size = t.size, n }, k.prototype.get = function (e) { return this.__data__.get(e) }, k.prototype.has = function (e) { return this.__data__.has(e) }, k.prototype.set = function (e, t) { var n = this.__data__; if (n instanceof Ef) { var r = n.__data__; if (!Uf || r.length < Jf - 1) return r.push([e, t]), this.size = ++n.size, this; n = this.__data__ = new Gf(r) } return n.set(e, t), this.size = n.size, this }; var Zf = k, Hf = "__lodash_hash_undefined__"; N.prototype.add = N.prototype.push = function (e) { return this.__data__.set(e, Hf), this }, N.prototype.has = function (e) { return this.__data__.has(e) }; var Xf = N, Kf = function (e, t) { for (var n = -1, r = null == e ? 0 : e.length; ++n < r;)if (t(e[n], n, e)) return !0; return !1 }, Qf = function (e, t) { return e.has(t) }, ec = 1, tc = 2, nc = function (e, t, n, r, i, o) { var s = n & ec, a = e.length, u = t.length; if (a != u && !(s && u > a)) return !1; var f = o.get(e); if (f && o.get(t)) return f == t; var c = -1, l = !0, h = n & tc ? new Xf : void 0; for (o.set(e, t), o.set(t, e); ++c < a;) { var p = e[c], d = t[c]; if (r) var m = s ? r(d, p, c, t, e, o) : r(p, d, c, e, t, o); if (void 0 !== m) { if (m) continue; l = !1; break } if (h) { if (!Kf(t, function (e, t) { if (!Qf(h, t) && (p === e || i(p, e, n, r, o))) return h.push(t) })) { l = !1; break } } else if (p !== d && !i(p, d, n, r, o)) { l = !1; break } } return o.delete(e), o.delete(t), l }, rc = Us.Uint8Array, ic = function (e) { var t = -1, n = Array(e.size); return e.forEach(function (e, r) { n[++t] = [r, e] }), n }, oc = function (e) { var t = -1, n = Array(e.size); return e.forEach(function (e) { n[++t] = e }), n }, sc = 1, ac = 2, uc = "[object Boolean]", fc = "[object Date]", cc = "[object Error]", lc = "[object Map]", hc = "[object Number]", pc = "[object RegExp]", dc = "[object Set]", mc = "[object String]", yc = "[object Symbol]", gc = "[object ArrayBuffer]", vc = "[object DataView]", bc = Ds ? Ds.prototype : void 0, wc = bc ? bc.valueOf : void 0, _c = function (e, t, n, r, i, o, s) { switch (n) { case vc: if (e.byteLength != t.byteLength || e.byteOffset != t.byteOffset) return !1; e = e.buffer, t = t.buffer; case gc: return !(e.byteLength != t.byteLength || !o(new rc(e), new rc(t))); case uc: case fc: case hc: return bf(+e, +t); case cc: return e.name == t.name && e.message == t.message; case pc: case mc: return e == t + ""; case lc: var a = ic; case dc: var u = r & sc; if (a || (a = oc), e.size != t.size && !u) return !1; var f = s.get(e); if (f) return f == t; r |= ac, s.set(e, t); var c = nc(a(e), a(t), r, i, o, s); return s.delete(e), c; case yc: if (wc) return wc.call(e) == wc.call(t) }return !1 }, Ec = function (e, t) { for (var n = -1, r = t.length, i = e.length; ++n < r;)e[i + n] = t[n]; return e }, Tc = function (e, t, n) { var r = t(e); return ia(e) ? r : Ec(r, n(e)) }, Sc = function (e, t) { for (var n = -1, r = null == e ? 0 : e.length, i = 0, o = []; ++n < r;) { var s = e[n]; t(s, n, e) && (o[i++] = s) } return o }, Ac = function () { return [] }, Ic = Object.prototype.propertyIsEnumerable, Cc = Object.getOwnPropertySymbols, Oc = Cc ? function (e) { return null == e ? [] : (e = Object(e), Sc(Cc(e), function (t) { return Ic.call(e, t) })) } : Ac, xc = function (e) { return Tc(e, Ra, Oc) }, Mc = 1, Pc = Object.prototype.hasOwnProperty, Rc = function (e, t, n, r, i, o) { var s = n & Mc, a = xc(e), u = a.length; if (u != xc(t).length && !s) return !1; for (var f = u; f--;) { var c = a[f]; if (!(s ? c in t : Pc.call(t, c))) return !1 } var l = o.get(e); if (l && o.get(t)) return l == t; var h = !0; o.set(e, t), o.set(t, e); for (var p = s; ++f < u;) { var d = e[c = a[f]], m = t[c]; if (r) var y = s ? r(m, d, c, t, e, o) : r(d, m, c, e, t, o); if (!(void 0 === y ? d === m || i(d, m, n, r, o) : y)) { h = !1; break } p || (p = "constructor" == c) } if (h && !p) { var g = e.constructor, v = t.constructor; g != v && "constructor" in e && "constructor" in t && !("function" == typeof g && g instanceof g && "function" == typeof v && v instanceof v) && (h = !1) } return o.delete(e), o.delete(t), h }, Lc = Ff(Us, "DataView"), kc = Ff(Us, "Promise"), Nc = Ff(Us, "Set"), jc = Ff(Us, "WeakMap"), Fc = Cf(Lc), Uc = Cf(Uf), Dc = Cf(kc), Bc = Cf(Nc), Vc = Cf(jc), Yc = Hs; (Lc && "[object DataView]" != Yc(new Lc(new ArrayBuffer(1))) || Uf && "[object Map]" != Yc(new Uf) || kc && "[object Promise]" != Yc(kc.resolve()) || Nc && "[object Set]" != Yc(new Nc) || jc && "[object WeakMap]" != Yc(new jc)) && (Yc = function (e) { var t = Hs(e), n = "[object Object]" == t ? e.constructor : void 0, r = n ? Cf(n) : ""; if (r) switch (r) { case Fc: return "[object DataView]"; case Uc: return "[object Map]"; case Dc: return "[object Promise]"; case Bc: return "[object Set]"; case Vc: return "[object WeakMap]" }return t }); var zc = Yc, qc = 1, Wc = "[object Arguments]", $c = "[object Array]", Gc = "[object Object]", Jc = Object.prototype.hasOwnProperty, Zc = function (e, t, n, r, i, o) { var s = ia(e), a = ia(t), u = s ? $c : zc(e), f = a ? $c : zc(t), c = (u = u == Wc ? Gc : u) == Gc, l = (f = f == Wc ? Gc : f) == Gc, h = u == f; if (h && sa(e)) { if (!sa(t)) return !1; s = !0, c = !1 } if (h && !c) return o || (o = new Zf), s || ya(e) ? nc(e, t, n, r, i, o) : _c(e, t, u, n, r, i, o); if (!(n & qc)) { var p = c && Jc.call(e, "__wrapped__"), d = l && Jc.call(t, "__wrapped__"); if (p || d) { var m = p ? e.value() : e, y = d ? t.value() : t; return o || (o = new Zf), i(m, y, n, r, o) } } return !!h && (o || (o = new Zf), Rc(e, t, n, r, i, o)) }, Hc = j, Xc = 1, Kc = 2, Qc = function (e, t, n, r) { var i = n.length, o = i, s = !r; if (null == e) return !o; for (e = Object(e); i--;) { var a = n[i]; if (s && a[2] ? a[1] !== e[a[0]] : !(a[0] in e)) return !1 } for (; ++i < o;) { var u = (a = n[i])[0], f = e[u], c = a[1]; if (s && a[2]) { if (void 0 === f && !(u in e)) return !1 } else { var l = new Zf; if (r) var h = r(f, c, u, e, t, l); if (!(void 0 === h ? Hc(c, f, Xc | Kc, r, l) : h)) return !1 } } return !0 }, el = function (e) { return e === e && !Aa(e) }, tl = function (e) { for (var t = Ra(e), n = t.length; n--;) { var r = t[n], i = e[r]; t[n] = [r, i, el(i)] } return t }, nl = function (e, t) { return function (n) { return null != n && n[e] === t && (void 0 !== t || e in Object(n)) } }, rl = function (e) { var t = tl(e); return 1 == t.length && t[0][2] ? nl(t[0][0], t[0][1]) : function (n) { return n === e || Qc(n, e, t) } }, il = "[object Symbol]", ol = function (e) { return "symbol" == typeof e || Xs(e) && Hs(e) == il }, sl = /\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/, al = /^\w*$/, ul = function (e, t) { if (ia(e)) return !1; var n = typeof e; return !("number" != n && "symbol" != n && "boolean" != n && null != e && !ol(e)) || al.test(e) || !sl.test(e) || null != t && e in Object(t) }, fl = "Expected a function"; F.Cache = Gf; var cl = F, ll = 500, hl = /^\./, pl = /[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g, dl = /\\(\\)?/g, ml = function (e) { var t = cl(e, function (e) { return n.size === ll && n.clear(), e }), n = t.cache; return t }(function (e) { var t = []; return hl.test(e) && t.push(""), e.replace(pl, function (e, n, r, i) { t.push(r ? i.replace(dl, "$1") : n || e) }), t }), yl = 1 / 0, gl = Ds ? Ds.prototype : void 0, vl = gl ? gl.toString : void 0, bl = U, wl = function (e) { return null == e ? "" : bl(e) }, _l = function (e, t) { return ia(e) ? e : ul(e, t) ? [e] : ml(wl(e)) }, El = 1 / 0, Tl = function (e) { if ("string" == typeof e || ol(e)) return e; var t = e + ""; return "0" == t && 1 / e == -El ? "-0" : t }, Sl = function (e, t) { for (var n = 0, r = (t = _l(t, e)).length; null != e && n < r;)e = e[Tl(t[n++])]; return n && n == r ? e : void 0 }, Al = function (e, t, n) { var r = null == e ? void 0 : Sl(e, t); return void 0 === r ? n : r }, Il = function (e, t) { return null != e && t in Object(e) }, Cl = function (e, t, n) { for (var r = -1, i = (t = _l(t, e)).length, o = !1; ++r < i;) { var s = Tl(t[r]); if (!(o = null != e && n(e, s))) break; e = e[s] } return o || ++r != i ? o : !!(i = null == e ? 0 : e.length) && la(i) && fa(s, i) && (ia(e) || ra(e)) }, Ol = function (e, t) { return null != e && Cl(e, t, Il) }, xl = 1, Ml = 2, Pl = function (e, t) { return ul(e) && el(t) ? nl(Tl(e), t) : function (n) { var r = Al(n, e); return void 0 === r && r === t ? Ol(n, e) : Hc(t, r, xl | Ml) } }, Rl = function (e) { return e }, Ll = function (e) { return function (t) { return null == t ? void 0 : t[e] } }, kl = function (e) { return function (t) { return Sl(t, e) } }, Nl = function (e) { return ul(e) ? Ll(Tl(e)) : kl(e) }, jl = function (e) { return "function" == typeof e ? e : null == e ? Rl : "object" == typeof e ? ia(e) ? Pl(e[0], e[1]) : rl(e) : Nl(e) }, Fl = function (e) { var t = null == e ? 0 : e.length; return t ? e[t - 1] : void 0 }, Ul = function (e, t, n) { var r = -1, i = e.length; t < 0 && (t = -t > i ? 0 : i + t), (n = n > i ? i : n) < 0 && (n += i), i = t > n ? 0 : n - t >>> 0, t >>>= 0; for (var o = Array(i); ++r < i;)o[r] = e[r + t]; return o }, Dl = function (e, t) { return t.length < 2 ? e : Sl(e, Ul(t, 0, -1)) }, Bl = function (e, t) { return t = _l(t, e), null == (e = Dl(e, t)) || delete e[Tl(Fl(t))] }, Vl = Array.prototype.splice, Yl = function (e, t) { for (var n = e ? t.length : 0, r = n - 1; n--;) { var i = t[n]; if (n == r || i !== o) { var o = i; fa(i) ? Vl.call(e, i, 1) : Bl(e, i) } } return e }, zl = function (e, t) { var n = []; if (!e || !e.length) return n; var r = -1, i = [], o = e.length; for (t = jl(t, 3); ++r < o;) { var s = e[r]; t(s, r, e) && (n.push(s), i.push(r)) } return Yl(e, i), n }, ql = ko(5), Wl = !0; "find" in [] && Array(1).find(function () { Wl = !1 }), he(he.P + he.F * Wl, "Array", { find: function (e) { return ql(this, e, arguments.length > 1 ? arguments[1] : void 0) } }), st(); var $l = Z.Array.find, Gl = n(r(function (e) { e.exports = { default: $l, __esModule: !0 } })), Jl = "[object Map]", Zl = "[object Set]", Hl = Object.prototype.hasOwnProperty, Xl = function (e) { if (null == e) return !0; if (Pa(e) && (ia(e) || "string" == typeof e || "function" == typeof e.splice || sa(e) || ya(e) || ra(e))) return !e.length; var t = zc(e); if (t == Jl || t == Zl) return !e.size; if (wa(e)) return !Sa(e).length; for (var n in e) if (Hl.call(e, n)) return !1; return !0 }, Kl = function (e, t) { for (var n = -1, r = null == e ? 0 : e.length; ++n < r && !1 !== t(e[n], n, e);); return e }, Ql = function () { try { var e = Ff(Object, "defineProperty"); return e({}, "", {}), e } catch (e) { } }(), eh = function (e, t, n) { "__proto__" == t && Ql ? Ql(e, t, { configurable: !0, enumerable: !0, value: n, writable: !0 }) : e[t] = n }, th = Object.prototype.hasOwnProperty, nh = function (e, t, n) { var r = e[t]; th.call(e, t) && bf(r, n) && (void 0 !== n || t in e) || eh(e, t, n) }, rh = function (e, t, n, r) { var i = !n; n || (n = {}); for (var o = -1, s = t.length; ++o < s;) { var a = t[o], u = r ? r(n[a], e[a], a, n, e) : void 0; void 0 === u && (u = e[a]), i ? eh(n, a, u) : nh(n, a, u) } return n }, ih = function (e, t) { return e && rh(t, Ra(t), e) }, oh = function (e) { var t = []; if (null != e) for (var n in Object(e)) t.push(n); return t }, sh = Object.prototype.hasOwnProperty, ah = function (e) { if (!Aa(e)) return oh(e); var t = wa(e), n = []; for (var r in e) ("constructor" != r || !t && sh.call(e, r)) && n.push(r); return n }, uh = function (e) { return Pa(e) ? va(e, !0) : ah(e) }, fh = function (e, t) { return e && rh(t, uh(t), e) }, ch = r(function (e, t) { var n = t && !t.nodeType && t, r = n && !0 && e && !e.nodeType && e, i = r && r.exports === n ? Us.Buffer : void 0, o = i ? i.allocUnsafe : void 0; e.exports = function (e, t) { if (t) return e.slice(); var n = e.length, r = o ? o(n) : new e.constructor(n); return e.copy(r), r } }), lh = function (e, t) { return rh(e, Oc(e), t) }, hh = Object.getOwnPropertySymbols ? function (e) { for (var t = []; e;)Ec(t, Oc(e)), e = Xa(e); return t } : Ac, ph = function (e, t) { return rh(e, hh(e), t) }, dh = function (e) { return Tc(e, uh, hh) }, mh = Object.prototype.hasOwnProperty, yh = function (e) { var t = e.length, n = e.constructor(t); return t && "string" == typeof e[0] && mh.call(e, "index") && (n.index = e.index, n.input = e.input), n }, gh = function (e) { var t = new e.constructor(e.byteLength); return new rc(t).set(new rc(e)), t }, vh = function (e, t) { var n = t ? gh(e.buffer) : e.buffer; return new e.constructor(n, e.byteOffset, e.byteLength) }, bh = function (e, t) { return e.set(t[0], t[1]), e }, wh = function (e, t, n, r) { var i = -1, o = null == e ? 0 : e.length; for (r && o && (n = e[++i]); ++i < o;)n = t(n, e[i], i, e); return n }, _h = 1, Eh = function (e, t, n) { var r = t ? n(ic(e), _h) : ic(e); return wh(r, bh, new e.constructor) }, Th = /\w*$/, Sh = function (e) { var t = new e.constructor(e.source, Th.exec(e)); return t.lastIndex = e.lastIndex, t }, Ah = function (e, t) { return e.add(t), e }, Ih = 1, Ch = function (e, t, n) { var r = t ? n(oc(e), Ih) : oc(e); return wh(r, Ah, new e.constructor) }, Oh = Ds ? Ds.prototype : void 0, xh = Oh ? Oh.valueOf : void 0, Mh = function (e) { return xh ? Object(xh.call(e)) : {} }, Ph = function (e, t) { var n = t ? gh(e.buffer) : e.buffer; return new e.constructor(n, e.byteOffset, e.length) }, Rh = "[object Boolean]", Lh = "[object Date]", kh = "[object Map]", Nh = "[object Number]", jh = "[object RegExp]", Fh = "[object Set]", Uh = "[object String]", Dh = "[object Symbol]", Bh = "[object ArrayBuffer]", Vh = "[object DataView]", Yh = "[object Float32Array]", zh = "[object Float64Array]", qh = "[object Int8Array]", Wh = "[object Int16Array]", $h = "[object Int32Array]", Gh = "[object Uint8Array]", Jh = "[object Uint8ClampedArray]", Zh = "[object Uint16Array]", Hh = "[object Uint32Array]", Xh = function (e, t, n, r) { var i = e.constructor; switch (t) { case Bh: return gh(e); case Rh: case Lh: return new i(+e); case Vh: return vh(e, r); case Yh: case zh: case qh: case Wh: case $h: case Gh: case Jh: case Zh: case Hh: return Ph(e, r); case kh: return Eh(e, r, n); case Nh: case Uh: return new i(e); case jh: return Sh(e); case Fh: return Ch(e, r, n); case Dh: return Mh(e) } }, Kh = Object.create, Qh = function () { function e() { } return function (t) { if (!Aa(t)) return {}; if (Kh) return Kh(t); e.prototype = t; var n = new e; return e.prototype = void 0, n } }(), ep = function (e) { return "function" != typeof e.constructor || wa(e) ? {} : Qh(Xa(e)) }, tp = 1, np = 2, rp = 4, ip = "[object Arguments]", op = "[object Function]", sp = "[object GeneratorFunction]", ap = "[object Object]", up = {}; up[ip] = up["[object Array]"] = up["[object ArrayBuffer]"] = up["[object DataView]"] = up["[object Boolean]"] = up["[object Date]"] = up["[object Float32Array]"] = up["[object Float64Array]"] = up["[object Int8Array]"] = up["[object Int16Array]"] = up["[object Int32Array]"] = up["[object Map]"] = up["[object Number]"] = up[ap] = up["[object RegExp]"] = up["[object Set]"] = up["[object String]"] = up["[object Symbol]"] = up["[object Uint8Array]"] = up["[object Uint8ClampedArray]"] = up["[object Uint16Array]"] = up["[object Uint32Array]"] = !0, up["[object Error]"] = up[op] = up["[object WeakMap]"] = !1; var fp, cp = D, lp = 1, hp = 4, pp = function (e) { return cp(e, lp | hp) }, dp = { NONE: Sr("none"), SENDING: Sr("sending"), SENT: Sr("sent"), DELIVERED: Sr("delivered"), FAILED: Sr("failed") }; Bu(dp); var mp, yp, gp, vp, bp = (fp = {}, Lr(fp, dp.NONE, !0), Lr(fp, dp.SENDING, !0), Lr(fp, dp.SENT, !0), Lr(fp, dp.DELIVERED, !0), Lr(fp, dp.READ, !0), Lr(fp, dp.FAILED, !0), fp), wp = function () { function e(t) { Cr(this, e), go(this, { content: t }, { id: af(), cid: null, timestamp: new Date, from: void 0, mentionList: [], mentionedAll: !1, _mentioned: !1 }), this._setStatus(dp.NONE) } return e.prototype.getPayload = function () { return this.content }, e.prototype._toJSON = function () { return { id: this.id, cid: this.cid, from: this.from, timestamp: this.timestamp, deliveredAt: this.deliveredAt, updatedAt: this.updatedAt, mentionList: this.mentionList, mentionedAll: this.mentionedAll, mentioned: this.mentioned } }, e.prototype.toJSON = function () { return vo({}, this._toJSON(), { data: this.content }) }, e.prototype.toFullJSON = function () { var e = this.content, t = this.id, n = this.cid, r = this.from, i = this.timestamp, o = this.deliveredAt, s = this._updatedAt, a = this.mentionList, u = this.mentionedAll; return { data: e, id: t, cid: n, from: r, timestamp: mu(i), deliveredAt: mu(o), updatedAt: mu(s), mentionList: a, mentionedAll: u } }, e.prototype._setStatus = function (e) { if (!bp[e]) throw new Error("Invalid message status"); this._status = e }, e.prototype._updateMentioned = function (e) { this._mentioned = this.from !== e && (this.mentionedAll || this.mentionList.indexOf(e) > -1) }, e.prototype.getMentionList = function () { return this.mentionList }, e.prototype.setMentionList = function (e) { return this.mentionList = Ou(e), this }, e.prototype.mentionAll = function () { var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0]; return this.mentionedAll = Boolean(e), this }, e.validate = function () { return !0 }, e.parse = function (e, t) { return t || new this(e) }, vi(e, [{ key: "status", get: function () { return this._status } }, { key: "timestamp", get: function () { return this._timestamp }, set: function (e) { this._timestamp = du(e) } }, { key: "deliveredAt", get: function () { return this._deliveredAt }, set: function (e) { this._deliveredAt = du(e) } }, { key: "updatedAt", get: function () { return this._updatedAt || this.timestamp }, set: function (e) { this._updatedAt = du(e) } }, { key: "mentioned", get: function () { return this._mentioned } }]), e }(), _p = function (e) { if ("number" != typeof e) throw new TypeError(e + " is not a Number"); return function (t) { t.TYPE = e, t.validate = function (t) { return t._lctype === e }, t.prototype._getType = function () { return { _lctype: e } } } }, Ep = function (e) { if ("string" != typeof e) { if (!Array.isArray(e)) throw new TypeError(e + " is not an Array"); if (e.some(function (e) { return "string" != typeof e })) throw new TypeError("fields contains non-string typed member") } return function (t) { var n = bu ? wu(t, "_customFields") : t._customFields; n = Array.isArray(n) ? n : [], t._customFields = n.concat(e) } }, Tp = function (e) { bu && (e.parse = wu(e, "parse")) }, Sp = (mp = Ep(["_lctext", "_lcattrs"]))(yp = function (e) { function t() { return Cr(this, t), kr(this, e.apply(this, arguments)) } return Yr(t, e), t.prototype.setText = function (e) { return this._lctext = e, this }, t.prototype.getText = function () { return this._lctext }, t.prototype.setAttributes = function (e) { return this._lcattrs = e, this }, t.prototype.getAttributes = function () { return this._lcattrs }, t.prototype._getCustomFields = function () { var e = this; return (Array.isArray(this.constructor._customFields) ? this.constructor._customFields : []).reduce(function (t, n) { return "string" != typeof n ? t : (t[n] = e[n], t) }, {}) }, t.prototype._getType = function () { throw new Error("not implemented") }, t.prototype.getPayload = function () { return Au(go({ _lctext: this.getText(), _lcattrs: this.getAttributes() }, this._getCustomFields(), this._getType())) }, t.prototype.toJSON = function () { var t = this.type, n = this.text, r = this.attributes, i = this.summary; return vo({}, e.prototype._toJSON.call(this), { type: t, text: n, attributes: r, summary: i }) }, t.prototype.toFullJSON = function () { return vo({}, e.prototype.toFullJSON.call(this), { data: this.getPayload() }) }, t.parse = function (t) { var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : new this; n.content = t; var r = bu ? wu(n.constructor, "_customFields") : n.constructor._customFields, i = Array.isArray(r) ? r : []; return i = i.reduce(function (e, n) { return "string" != typeof n ? e : (e[n] = t[n], e) }, {}), go(n, i), e.parse.call(this, t, n) }, vi(t, [{ key: "type", get: function () { return this.constructor.TYPE } }, { key: "text", set: function (e) { return this.setText(e) }, get: function () { return this.getText() } }, { key: "attributes", set: function (e) { return this.setAttributes(e) }, get: function () { return this.getAttributes() } }, { key: "summary", get: function () { return this.text } }]), t }(wp)) || yp, Ap = (gp = _p(-127))(vp = function (e) { function t() { return Cr(this, t), kr(this, e.apply(this, arguments)) } return Yr(t, e), vi(t, [{ key: "summary", get: function () { return "[该消息已撤回]" } }]), t }(Sp)) || vp, Ip = Ho("LC:Conversation"), Cp = function (e) { var t = e.getPayload(), n = void 0, r = void 0; return t instanceof ArrayBuffer ? r = t : n = "string" != typeof t ? Wr(t) : t, { msg: n, binaryMsg: r } }, Op = Wi.QueryDirection, xp = Op.NEW, Mp = { NEW_TO_OLD: Op.OLD, OLD_TO_NEW: xp }; Bu(Mp); var Pp, Rp, Lp, kp, Np, jp, Fp = function (e) { function t(n, r) { var i = n.id, o = n.lastMessageAt, s = n.lastMessage, a = n.lastDeliveredAt, u = n.lastReadAt, f = n.unreadMessagesCount, c = void 0 === f ? 0 : f, l = n.members, h = void 0 === l ? [] : l, p = n.mentioned, d = void 0 !== p && p, m = uf(n, ["id", "lastMessageAt", "lastMessage", "lastDeliveredAt", "lastReadAt", "unreadMessagesCount", "members", "mentioned"]); Cr(this, t); var y = kr(this, e.call(this)); if (go(y, vo({ id: i, lastMessageAt: o, lastMessage: s, members: h }, m)), y.members = To(new Yo(y.members)), go(Su(y), { messagesWaitingForReceipt: {}, lastDeliveredAt: a, lastReadAt: u, unreadMessagesCount: c, mentioned: d }), !(r instanceof Hp)) throw new TypeError("Conversation must be initialized with a client"); return y._client = r, ["kicked", "membersjoined", "membersleft", "message", "receipt", "lastdeliveredatupdate", "lastreadatupdate", "messagerecall", "messageupdate"].forEach(function (e) { return y.on(e, function () { for (var t = arguments.length, n = Array(t), r = 0; r < t; r++)n[r] = arguments[r]; return y._debug(e + " event emitted. %O", n) }) }), Gu(y._client._plugins.onConversationCreate, y), y } return Yr(t, e), t.prototype._setUnreadMessagesMentioned = function (e) { Su(this).unreadMessagesMentioned = Boolean(e) }, t.prototype._setLastDeliveredAt = function (e) { var t = du(e); t < Su(this).lastDeliveredAt || (Su(this).lastDeliveredAt = t, this.emit("lastdeliveredatupdate")) }, t.prototype._setLastReadAt = function (e) { var t = du(e); t < Su(this).lastReadAt || (Su(this).lastReadAt = t, this.emit("lastreadatupdate")) }, t.prototype.toFullJSON = function () { var e = this.id, t = this.members, n = this.lastMessageAt, r = this.lastDeliveredAt, i = this.lastReadAt, o = this.lastMessage, s = this.unreadMessagesCount; return { id: e, members: t, lastMessageAt: mu(n), lastDeliveredAt: mu(r), lastReadAt: mu(i), lastMessage: o ? o.toFullJSON() : void 0, unreadMessagesCount: s } }, t.prototype.toJSON = function () { var e = this.id, t = this.members, n = this.lastMessageAt, r = this.lastDeliveredAt, i = this.lastReadAt, o = this.lastMessage, s = this.unreadMessagesCount, a = this.unreadMessagesMentioned; return { id: e, members: t, lastMessageAt: n, lastDeliveredAt: r, lastReadAt: i, lastMessage: o ? o.toJSON() : void 0, unreadMessagesCount: s, unreadMessagesMentioned: a } }, t.prototype._debug = function () { for (var e = arguments.length, t = Array(e), n = 0; n < e; n++)t[n] = arguments[n]; Ip.apply(void 0, t.concat(["[" + this.id + "]"])) }, t.prototype._send = function (e) { var t; null === e.cmd && (e.cmd = "conv"), "conv" === e.cmd && null === e.convMessage && (e.convMessage = new zi), e.convMessage && null === e.convMessage.cid && (e.convMessage.cid = this.id); for (var n = arguments.length, r = Array(n > 1 ? n - 1 : 0), i = 1; i < n; i++)r[i - 1] = arguments[i]; return (t = this._client)._send.apply(t, [e].concat(r)) }, t.prototype.send = function () { var e = bo(lo.mark(function e(t, n) { var r, i, o, s, a, u, f, c, l, h, p, d, m, y, g, v, b; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this._debug(t, "send"), t instanceof wp) { e.next = 3; break } throw new TypeError(t + " is not a Message"); case 3: return r = go({}, t.constructor.sendOptions, "function" == typeof t.constructor.getSendOptions ? t.constructor.getSendOptions(t) : {}, n), i = r.transient, o = r.receipt, s = r.priority, a = r.pushData, u = r.will, o && (this.transient ? console.warn("receipt option is ignored as the conversation is transient.") : i ? console.warn("receipt option is ignored as the message is sent transiently.") : this.members.length > 2 && console.warn("receipt option is recommended to be used in one-on-one conversation.")), s && !this.transient && console.warn("priority option is ignored as the conversation is not transient."), go(t, { cid: this.id, from: this._client.id }), t._setStatus(dp.SENDING), f = Cp(t), c = f.msg, l = f.binaryMsg, h = new Ki({ cmd: "direct", directMessage: new Bi({ msg: c, binaryMsg: l, cid: this.id, r: o, transient: i, dt: t.id, pushData: Wr(a), will: u, mentionPids: t.mentionList, mentionAll: t.mentionedAll }), priority: s }), e.prev = 10, e.next = 13, this._send(h, !i); case 13: if (p = e.sent, i) { e.next = 21; break } if (d = p.ackMessage, m = d.uid, y = d.t, g = d.code, v = d.reason, b = d.appCode, null === g) { e.next = 18; break } throw zu({ code: g, reason: v, appCode: b }); case 18: go(t, { id: m, timestamp: y }), this.lastMessage = t, this.lastMessageAt = t.timestamp; case 21: return t._setStatus(dp.SENT), o && (Su(this).messagesWaitingForReceipt[t.id] = t), e.abrupt("return", t); case 26: throw e.prev = 26, e.t0 = e.catch(10), t._setStatus(dp.FAILED), e.t0; case 30: case "end": return e.stop() } }, e, this, [[10, 26]]) })); return function (t, n) { return e.apply(this, arguments) } }(), t.prototype._update = function () { var e = bo(lo.mark(function e(t, n, r) { var i, o, s, a, u, f, c, l; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this._debug("patch %O %O %O", t, n, r), !(t instanceof wp)) { e.next = 8; break } if (t.from === this._client.id) { e.next = 4; break } throw new Error("Updating message from others is not allowed"); case 4: if (t.status === dp.SENT || t.status === dp.DELIVERED) { e.next = 6; break } throw new Error("Message is not sent"); case 6: e.next = 10; break; case 8: if (t.id && t.timestamp) { e.next = 10; break } throw new TypeError(t + " is not a Message"); case 10: return i = void 0, o = void 0, r || (s = Cp(n), i = s.msg, o = s.binaryMsg), e.next = 15, this._send(new Ki({ cmd: to.patch, op: no.modify, patchMessage: new Qi({ patches: [new eo({ cid: this.id, mid: t.id, timestamp: Number(t.timestamp), recall: r, data: i, binaryMsg: o, mentionPids: n.mentionList, mentionAll: n.mentionedAll })], lastPatchTime: this._client._lastPatchTime }) })); case 15: return a = t.id, u = t.cid, f = t.timestamp, c = t.from, l = t._status, go(n, { id: a, cid: u, timestamp: f, from: c, _status: l }), this.lastMessage.id === n.id && (this.lastMessage = n), e.abrupt("return", n); case 19: case "end": return e.stop() } }, e, this) })); return function (t, n, r) { return e.apply(this, arguments) } }(), t.prototype.count = function () { var e = bo(lo.mark(function e() { var t; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return this._debug("count"), e.next = 3, this._send(new Ki({ op: "count" })); case 3: return t = e.sent, e.abrupt("return", t.convMessage.count); case 5: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.update = function () { var e = bo(lo.mark(function e(t, n) { return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (n instanceof wp) { e.next = 2; break } throw new TypeError(n + " is not a Message"); case 2: return e.abrupt("return", this._update(t, n, !1)); case 3: case "end": return e.stop() } }, e, this) })); return function (t, n) { return e.apply(this, arguments) } }(), t.prototype.recall = function () { var e = bo(lo.mark(function e(t) { return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return e.abrupt("return", this._update(t, new Ap, !0)); case 1: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype.queryMessages = function () { var e = bo(lo.mark(function e() { var t, n, r, i, o, s, a, u, f, c, l, h, p, d, m = this, y = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this._debug("query messages %O", y), t = y.beforeTime, n = y.beforeMessageId, r = y.afterTime, i = y.afterMessageId, o = y.limit, s = y.direction, a = y.startTime, u = y.startMessageId, f = y.startClosed, c = y.endTime, l = y.endMessageId, h = y.endClosed, !(n || t || i || r)) { e.next = 5; break } return console.log("DEPRECATION: queryMessages options beforeTime, beforeMessageId, afterTime and afterMessageId are deprecated in favor of startTime, startMessageId, endTime and endMessageId."), e.abrupt("return", this.queryMessages({ startTime: t, startMessageId: n, endTime: r, endMessageId: i, limit: o })); case 5: if (!u || a) { e.next = 7; break } throw new Error("query option startMessageId must be used with option startTime"); case 7: if (!l || c) { e.next = 9; break } throw new Error("query option endMessageId must be used with option endTime"); case 9: return (p = { t: a, mid: u, tIncluded: f, tt: c, tmid: l, ttIncluded: h, l: o }).t instanceof Date && (p.t = p.t.getTime()), p.tt instanceof Date && (p.tt = p.tt.getTime()), void 0 !== s ? p.direction = s : p.tt > p.t && (p.direction = Mp.OLD_TO_NEW), e.next = 15, this._send(new Ki({ cmd: "logs", logsMessage: new Wi(go(p, { cid: this.id })) })); case 15: return d = e.sent, e.abrupt("return", In.all(d.logsMessage.logs.map(function () { var e = bo(lo.mark(function e(t) { var n, r, i, o = t.msgId, s = t.timestamp, a = t.patchTimestamp, u = t.from, f = t.ackAt, c = t.readAt, l = t.data, h = t.mentionAll, p = t.mentionPids, d = t.bin; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return n = { data: l, bin: d, id: o, cid: m.id, timestamp: s, from: u, deliveredAt: f, updatedAt: a, mentionList: p, mentionedAll: h }, e.next = 3, m._client.parseMessage(n); case 3: return r = e.sent, i = dp.SENT, 2 === m.members.length && (f && (i = dp.DELIVERED), f && m._setLastDeliveredAt(f), c && m._setLastReadAt(c)), r._setStatus(i), e.abrupt("return", r); case 8: case "end": return e.stop() } }, e, m) })); return function (t) { return e.apply(this, arguments) } }()))); case 17: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.createMessagesIterator = function () { var e = this, t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, n = t.beforeTime, r = t.beforeMessageId, i = t.limit, o = void 0; return { next: function () { return (o = void 0 === o ? e.queryMessages({ limit: i, startTime: n, startMessageId: r }) : o.then(function (t) { return 0 === t.length || t.length < i ? [] : e.queryMessages({ startTime: t[0].timestamp, startMessageId: t[0].id, limit: i }) })).then(function (e) { return { value: To(e), done: 0 === e.length || e.length < i } }) } } }, t.prototype.read = function () { var e = bo(lo.mark(function e() { var t; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this.unreadMessagesCount = 0, this._setUnreadMessagesMentioned(!1), !this.transient) { e.next = 4; break } return e.abrupt("return", this); case 4: return t = this._client, Su(t).readConversationsBuffer || (Su(t).readConversationsBuffer = new Yo), Su(t).readConversationsBuffer.add(this), t._doSendRead(), e.abrupt("return", this); case 9: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype._handleReceipt = function (e) { var t = e.messageId, n = e.timestamp; e.read ? this._setLastReadAt(n) : this._setLastDeliveredAt(n); var r = Su(this).messagesWaitingForReceipt, i = r[t]; i && (i._setStatus(dp.DELIVERED), i.deliveredAt = n, delete r[t]) }, t.prototype.fetchReceiptTimestamps = function () { var e = bo(lo.mark(function e() { var t, n, r, i; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return e.next = 2, this._send(new Ki({ op: "max_read" })); case 2: return t = e.sent, n = t.convMessage, r = n.maxReadTimestamp, i = n.maxAckTimestamp, this._setLastDeliveredAt(i), this._setLastReadAt(r), e.abrupt("return", this); case 9: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype._fetchAllReceiptTimestamps = function () { var e = new zi({ queryAllMembers: !0 }); return this._send(new Ki({ op: "max_read", convMessage: e })).then(function (e) { return e.convMessage.maxReadTuples.filter(function (e) { return e.maxAckTimestamp || e.maxReadTimestamp }).map(function (e) { var t = e.pid, n = e.maxAckTimestamp, r = e.maxReadTimestamp; return { pid: t, lastDeliveredAt: du(n), lastReadAt: du(r) } }) }) }, vi(t, [{ key: "unreadMessagesMentioned", get: function () { return Su(this).unreadMessagesMentioned } }, { key: "unreadMessagesCount", set: function (e) { e !== this.unreadMessagesCount && (Su(this).unreadMessagesCount = e, this._client.emit("unreadmessagescountupdate", [this])) }, get: function () { return Su(this).unreadMessagesCount } }, { key: "lastMessageAt", set: function (e) { var t = du(e); t <= this._lastMessageAt || (this._lastMessageAt = t) }, get: function () { return this._lastMessageAt } }, { key: "lastDeliveredAt", get: function () { return 2 !== this.members.length ? null : Su(this).lastDeliveredAt } }, { key: "lastReadAt", get: function () { return 2 !== this.members.length ? null : Su(this).lastReadAt } }]), t }(oo), Up = Ho("LC:SignatureFactoryRunner"), Dp = function (e, t) { return In.resolve().then(function () { return Up("call signatureFactory with %O", t), e.apply(void 0, So(t)) }).then(pu(function (e) { return Up("sign result %O", e) }), function (e) { throw e.message = "sign error: " + e.message, Up(e), e }).then(B) }, Bp = function (e) { function t(n, r, i) { var o = r.creator, s = r.createdAt, a = r.updatedAt, u = r.transient, f = void 0 !== u && u, c = r.system, l = void 0 !== c && c, h = r.muted, p = void 0 !== h && h, d = r.mutedMembers, m = void 0 === d ? [] : d, y = uf(r, ["creator", "createdAt", "updatedAt", "transient", "system", "muted", "mutedMembers"]); Cr(this, t); var g = kr(this, e.call(this, vo({}, n, { creator: o, createdAt: s, updatedAt: a, mutedMembers: m, transient: f, system: l, muted: p, _attributes: y }), i)); return g._reset(), g } return Yr(t, e), t.prototype.get = function (e) { return Su(this).currentAttributes[e] }, t.prototype.set = function (e, t) { this._debug("set [" + e + "]: " + t); var n = Su(this).pendingAttributes, r = Jr(n), i = new RegExp("^" + e), o = r.filter(i.test.bind(i)); if (o.forEach(function (e) { delete n[e] }), o.length) n[e] = t; else { var s = Gl(r, function (t) { return 0 === e.indexOf(t) }); s ? xu(n[s], e.slice(s.length + 1), t) : n[e] = t } return Su(this).currentAttributes = Jr(n).reduce(function (e, t) { return xu(e, t, n[t]) }, pp(this._attributes)), this }, t.prototype._reset = function () { Su(this).pendingAttributes = {}, Su(this).currentAttributes = this._attributes }, t.prototype.save = function () { var e = bo(lo.mark(function e() { var t, n, r; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this._debug("save"), t = Su(this).pendingAttributes, !Xl(t)) { e.next = 5; break } return this._debug("nothing touched, resolve with self"), e.abrupt("return", this); case 5: return this._debug("attr: %O", t), n = new zi({ attr: new ki({ data: Wr(gu(t)) }) }), e.next = 9, this._send(new Ki({ op: "update", convMessage: n })); case 9: return r = e.sent, this.updatedAt = r.convMessage.udate, this._attributes = Su(this).currentAttributes, Su(this).pendingAttributes = {}, e.abrupt("return", this); case 14: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.fetch = function () { var e = bo(lo.mark(function e() { var t; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return t = this._client.getQuery().equalTo("objectId", this.id), e.next = 3, t.find(); case 3: return e.abrupt("return", this); case 4: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.mute = function () { var e = bo(lo.mark(function e() { return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return this._debug("mute"), e.next = 3, this._send(new Ki({ op: "mute" })); case 3: return this.transient || (this.muted = !0, this.mutedMembers = _u(this.mutedMembers, [this._client.id])), e.abrupt("return", this); case 5: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.unmute = function () { var e = bo(lo.mark(function e() { return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return this._debug("unmute"), e.next = 3, this._send(new Ki({ op: "unmute" })); case 3: return this.transient || (this.muted = !1, this.mutedMembers = Eu(this.mutedMembers, [this._client.id])), e.abrupt("return", this); case 5: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.add = function () { var e = bo(lo.mark(function e(t) { var n, r, i, o; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this._debug("add", t), "string" == typeof t && (t = [t]), n = new zi({ m: t }), r = new Ki({ op: "add", convMessage: n }), !this._client.options.conversationSignatureFactory) { e.next = 10; break } return i = [this.id, this._client.id, t.sort(), "add"], e.next = 8, Dp(this._client.options.conversationSignatureFactory, i); case 8: o = e.sent, go(r.convMessage, vu({ signature: "s", timestamp: "t", nonce: "n" }, o)); case 10: return e.next = 12, this._send(r); case 12: return this.transient || this.system || (this.members = _u(this.members, t)), e.abrupt("return", this); case 14: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype.remove = function () { var e = bo(lo.mark(function e(t) { var n, r, i, o; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this._debug("remove", t), "string" == typeof t && (t = [t]), n = new zi({ m: t }), r = new Ki({ op: "remove", convMessage: n }), !this._client.options.conversationSignatureFactory) { e.next = 10; break } return i = [this.id, this._client.id, t.sort(), "remove"], e.next = 8, Dp(this._client.options.conversationSignatureFactory, i); case 8: o = e.sent, go(r.convMessage, vu({ signature: "s", timestamp: "t", nonce: "n" }, o)); case 10: return e.next = 12, this._send(r); case 12: return this.transient || this.system || (this.members = Eu(this.members, t)), e.abrupt("return", this); case 14: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype.join = function () { var e = bo(lo.mark(function e() { return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return this._debug("join"), e.abrupt("return", this.add(this._client.id)); case 2: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.quit = function () { var e = bo(lo.mark(function e() { return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return this._debug("quit"), e.abrupt("return", this.remove(this._client.id)); case 2: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.toFullJSON = function () { var t = this.creator, n = this.system, r = this.transient, i = this.createdAt, o = this.updatedAt, s = this._attributes; return vo({}, e.prototype.toFullJSON.call(this), { creator: t, system: n, transient: r, createdAt: mu(i), updatedAt: mu(o) }, s) }, t.prototype.toJSON = function () { var t = this.creator, n = this.system, r = this.transient, i = this.muted, o = this.mutedMembers, s = this.createdAt, a = this.updatedAt, u = this._attributes; return vo({}, e.prototype.toJSON.call(this), { creator: t, system: n, transient: r, muted: i, mutedMembers: o, createdAt: s, updatedAt: a }, u) }, vi(t, [{ key: "createdAt", set: function (e) { this._createdAt = du(e) }, get: function () { return this._createdAt } }, { key: "updatedAt", set: function (e) { this._updatedAt = du(e) }, get: function () { return this._updatedAt } }, { key: "name", get: function () { return this.get("name") }, set: function (e) { this.set("name", e) } }]), t }(Fp), Vp = function (e) { function t() { return Cr(this, t), kr(this, e.apply(this, arguments)) } return Yr(t, e), t }(Bp), Yp = function (e) { function t() { return Cr(this, t), kr(this, e.apply(this, arguments)) } return Yr(t, e), t }(Bp), zp = function (e) { function t() { return Cr(this, t), kr(this, e.apply(this, arguments)) } return Yr(t, e), t }(Bp), qp = function (e) { return e.code === Yu.CONVERSATION_NOT_FOUND ? zu({ code: Yu.CONVERSATION_EXPIRED }) : e }, Wp = function (e) { function t(n, r, i) { var o = r.expiredAt; return Cr(this, t), kr(this, e.call(this, vo({}, n, { expiredAt: o }), i)) } return Yr(t, e), t.prototype._send = function () { var t = bo(lo.mark(function t() { var n, r, i, o, s = arguments; return lo.wrap(function (t) { for (; ;)switch (t.prev = t.next) { case 0: if (!this.expired) { t.next = 2; break } throw zu({ code: Yu.CONVERSATION_EXPIRED }); case 2: for (t.prev = 2, r = s.length, i = Array(r), o = 0; o < r; o++)i[o] = s[o]; return t.next = 6, (n = e.prototype._send).call.apply(n, [this].concat(So(i))); case 6: return t.abrupt("return", t.sent); case 9: throw t.prev = 9, t.t0 = t.catch(2), qp(t.t0); case 12: case "end": return t.stop() } }, t, this, [[2, 9]]) })); return function () { return t.apply(this, arguments) } }(), t.prototype.send = function () { var t = bo(lo.mark(function t() { var n, r, i, o, s = arguments; return lo.wrap(function (t) { for (; ;)switch (t.prev = t.next) { case 0: for (t.prev = 0, r = s.length, i = Array(r), o = 0; o < r; o++)i[o] = s[o]; return t.next = 4, (n = e.prototype.send).call.apply(n, [this].concat(So(i))); case 4: return t.abrupt("return", t.sent); case 7: throw t.prev = 7, t.t0 = t.catch(0), qp(t.t0); case 10: case "end": return t.stop() } }, t, this, [[0, 7]]) })); return function () { return t.apply(this, arguments) } }(), t.prototype.toFullJSON = function () { var t = this.expiredAt; return vo({}, e.prototype.toFullJSON.call(this), { expiredAt: mu(t) }) }, t.prototype.toJSON = function () { var t = this.expiredAt, n = this.expired; return vo({}, e.prototype.toJSON.call(this), { expiredAt: t, expired: n }) }, vi(t, [{ key: "expiredAt", set: function (e) { this._expiredAt = du(e) }, get: function () { return this._expiredAt } }, { key: "expired", get: function () { return this.expiredAt < new Date } }]), t }(Fp), $p = Ho("LC:ConversationQuery"), Gp = function () { function e(t) { Cr(this, e), this._client = t, this._where = {}, this._extraOptions = {} } return e._encode = function (e) { return e instanceof Date ? { __type: "Date", iso: e.toJSON() } : e instanceof RegExp ? e.source : e }, e._quote = function (e) { return "\\Q" + e.replace("\\E", "\\E\\\\E\\Q") + "\\E" }, e._calculateFlag = function (e) { return ["withLastMessagesRefreshed", "compact"].reduce(function (t, n) { return (t << 1) + Boolean(e[n]) }, 0) }, e.prototype._addCondition = function (e, t, n) { return this._where[e] || (this._where[e] = {}), this._where[e][t] = this.constructor._encode(n), this }, e.prototype.toJSON = function () { var e = { where: this._where, flag: this.constructor._calculateFlag(this._extraOptions) }; return void 0 !== this._skip && (e.skip = this._skip), void 0 !== this._limit && (e.limit = this._limit), void 0 !== this._order && (e.sort = this._order), $p(e), e }, e.prototype.containsMembers = function (e) { return this.containsAll("m", e) }, e.prototype.withMembers = function (e, t) { var n = new Yo(e); return t && n.add(this._client.id), this.sizeEqualTo("m", n.size), this.containsMembers(To(n)) }, e.prototype.equalTo = function (e, t) { return this._where[e] = this.constructor._encode(t), this }, e.prototype.lessThan = function (e, t) { return this._addCondition(e, "$lt", t) }, e.prototype.lessThanOrEqualTo = function (e, t) { return this._addCondition(e, "$lte", t) }, e.prototype.greaterThan = function (e, t) { return this._addCondition(e, "$gt", t) }, e.prototype.greaterThanOrEqualTo = function (e, t) { return this._addCondition(e, "$gte", t) }, e.prototype.notEqualTo = function (e, t) { return this._addCondition(e, "$ne", t) }, e.prototype.exists = function (e) { return this._addCondition(e, "$exists", !0) }, e.prototype.doesNotExist = function (e) { return this._addCondition(e, "$exists", !1) }, e.prototype.containedIn = function (e, t) { return this._addCondition(e, "$in", t) }, e.prototype.notContainsIn = function (e, t) { return this._addCondition(e, "$nin", t) }, e.prototype.containsAll = function (e, t) { return this._addCondition(e, "$all", t) }, e.prototype.contains = function (t, n) { return this._addCondition(t, "$regex", e._quote(n)) }, e.prototype.startsWith = function (t, n) { return this._addCondition(t, "$regex", "^" + e._quote(n)) }, e.prototype.endsWith = function (t, n) { return this._addCondition(t, "$regex", e._quote(n) + "$") }, e.prototype.matches = function (e, t) { this._addCondition(e, "$regex", t); var n = ""; return t.ignoreCase && (n += "i"), t.multiline && (n += "m"), n && n.length && this._addCondition(e, "$options", n), this }, e.prototype.sizeEqualTo = function (e, t) { return this._addCondition(e, "$size", t) }, e.prototype.limit = function (e) { return this._limit = e, this }, e.prototype.skip = function (e) { return this._skip = e, this }, e.prototype.ascending = function (e) { return this._order = e, this }, e.prototype.addAscending = function (e) { return this._order ? this._order += "," + e : this._order = e, this }, e.prototype.descending = function (e) { return this._order = "-" + e, this }, e.prototype.addDescending = function (e) { return this._order ? this._order += ",-" + e : this._order = "-" + e, this }, e.prototype.withLastMessagesRefreshed = function () { var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0]; return this._extraOptions.withLastMessagesRefreshed = e, this }, e.prototype.compact = function () { var e = !(arguments.length > 0 && void 0 !== arguments[0]) || arguments[0]; return this._extraOptions.compact = e, this }, e.prototype.find = function () { var e = bo(lo.mark(function e() { return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return e.abrupt("return", this._client._executeQuery(this)); case 1: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), e }(), Jp = Ho("LC:IMClient"), Zp = function (e) { return /^_tmp:/.test(e) }, Hp = (Pp = Pu(1e3), Rp = Pu(1e3), Lp = function (e) { function t(n) { var r = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : {}, i = arguments[2], o = arguments[3]; if (Cr(this, t), void 0 !== n && "string" != typeof n) throw new TypeError("Client id [" + n + "] is not a String"); var s = kr(this, e.call(this)); if (go(s, { id: n, _connection: i, options: r }, o), !s._messageParser) throw new Error("IMClient must be initialized with a MessageParser"); return s._conversationCache = new lu("client:" + s.id), s._ackMessageBuffer = {}, Su(s).lastPatchTime = Date.now(), Su(s)._eventemitter = new oo, ["invited", "kicked", "membersjoined", "membersleft", "message", "unreadmessages", "unreadmessagescountupdate", "close", "conflict", "unhandledmessage", "reconnect", "reconnecterror"].forEach(function (e) { return s.on(e, function () { for (var t = arguments.length, n = Array(t), r = 0; r < t; r++)n[r] = arguments[r]; return s._debug(e + " event emitted. %O", n) }) }), Gu(s._plugins.onIMClientCreate, s), s } return Yr(t, e), t.prototype._debug = function () { for (var e = arguments.length, t = Array(e), n = 0; n < e; n++)t[n] = arguments[n]; Jp.apply(void 0, t.concat(["[" + this.id + "]"])) }, t.prototype._dispatchCommand = function () { var e = bo(lo.mark(function e(t) { return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: this._debug(Cu(t), "received"), e.t0 = t.cmd, e.next = e.t0 === to.conv ? 4 : e.t0 === to.direct ? 5 : e.t0 === to.session ? 6 : e.t0 === to.unread ? 7 : e.t0 === to.rcp ? 8 : e.t0 === to.patch ? 9 : 10; break; case 4: return e.abrupt("return", this._dispatchConvMessage(t)); case 5: return e.abrupt("return", this._dispatchDirectMessage(t)); case 6: return e.abrupt("return", this._dispatchSessionMessage(t)); case 7: return e.abrupt("return", this._dispatchUnreadMessage(t)); case 8: return e.abrupt("return", this._dispatchRcpMessage(t)); case 9: return e.abrupt("return", this._dispatchPatchMessage(t)); case 10: return e.abrupt("return", this.emit("unhandledmessage", t)); case 11: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._dispatchSessionMessage = function () { var e = bo(lo.mark(function e(t) { var n, r, i; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: n = t.sessionMessage, r = n.code, i = n.reason, e.t0 = t.op, e.next = e.t0 === no.closed ? 4 : 8; break; case 4: if (Su(this)._eventemitter.emit("close"), r !== Yu.SESSION_CONFLICT) { e.next = 7; break } return e.abrupt("return", this.emit("conflict", { reason: i })); case 7: return e.abrupt("return", this.emit("close", { code: r, reason: i })); case 8: throw this.emit("unhandledmessage", t), new Error("Unrecognized session command"); case 10: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._dispatchUnreadMessage = function (e) { var t = this, n = e.unreadMessage, r = n.convs, i = n.notifTime; return Su(this).lastUnreadNotifTime = i, this.getConversations(r.map(function (e) { return e.cid })).then(function () { return In.all(r.map(function (e) { var n = e.cid, r = e.unread, i = e.mid, o = e.timestamp, s = e.from, a = e.data, u = e.binaryMsg, f = e.patchTimestamp, c = e.mentioned, l = t._conversationCache.get(n); if (!l) return null; var h = void 0; return o && (h = new Date(o.toNumber()), l.lastMessageAt = h), (i ? t._messageParser.parse(u || a).then(function (e) { go(e, { id: i, cid: n, timestamp: h, updatedAt: f, from: s }), l.lastMessage = e }) : In.resolve()).then(function () { return l._setUnreadMessagesMentioned(c), r === Su(l).unreadMessagesCount ? null : (Su(l).unreadMessagesCount = r, l) }) })).then(function (e) { return e.filter(function (e) { return e }) }) }).then(function (e) { e.length && t.emit("unreadmessagescountupdate", e) }) }, t.prototype._dispatchRcpMessage = function () { var e = bo(lo.mark(function e(t) { var n, r, i, o, s, a; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (n = t.rcpMessage, r = t.rcpMessage.read, i = n.cid, o = n.id, s = new Date(n.t.toNumber()), a = this._conversationCache.get(i)) { e.next = 7; break } return e.abrupt("return"); case 7: a._handleReceipt({ messageId: o, timestamp: s, read: r }); case 8: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._dispatchPatchMessage = function (e) { var t = this, n = e.patchMessage.patches; return this.getConversations(n.map(function (e) { return e.cid })).then(function () { return In.all(n.map(function (e) { var n = e.cid, r = e.mid, i = e.timestamp, o = e.recall, s = e.data, a = e.patchTimestamp, u = e.from, f = e.binaryMsg, c = e.mentionAll, l = e.mentionPids, h = t._conversationCache.get(n); return h ? t._messageParser.parse(f || s).then(function (e) { var s = a.toNumber(); go(e, { id: r, cid: n, timestamp: i, updatedAt: s, from: u, mentionList: l, mentionedAll: c }), e._setStatus(dp.SENT), e._updateMentioned(t.id), Su(t).lastPatchTime < s && (Su(t).lastPatchTime = s), h.lastMessage && h.lastMessage.id === r && (h.lastMessage = e), o ? (t.emit("messagerecall", e, h), h.emit("messagerecall", e)) : (t.emit("messageupdate", e, h), h.emit("messageupdate", e)) }) : null })) }) }, t.prototype._dispatchConvMessage = function () { var e = bo(lo.mark(function e(t) { var n, r, i, o, s, a, u, f, c; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return n = t.convMessage, r = t.convMessage, i = r.initBy, o = r.m, e.next = 3, this.getConversation(n.cid); case 3: s = e.sent, e.t0 = t.op, e.next = e.t0 === no.joined ? 7 : e.t0 === no.left ? 12 : e.t0 === no.members_joined ? 17 : e.t0 === no.members_left ? 22 : 27; break; case 7: return s.transient || (s.members = _u(s.members, [this.id])), a = { invitedBy: i }, this.emit("invited", a, s), s.emit("invited", a), e.abrupt("return"); case 12: return s.transient || (s.members = Eu(s.members, [this.id])), u = { kickedBy: i }, this.emit("kicked", u, s), s.emit("kicked", u), e.abrupt("return"); case 17: return s.transient || (s.members = _u(s.members, n.m)), f = { invitedBy: i, members: o }, this.emit("membersjoined", f, s), s.emit("membersjoined", f), e.abrupt("return"); case 22: return s.transient || (s.members = Eu(s.members, n.m)), c = { kickedBy: i, members: o }, this.emit("membersleft", c, s), s.emit("membersleft", c), e.abrupt("return"); case 27: throw this.emit("unhandledmessage", t), new Error("Unrecognized conversation command"); case 29: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._dispatchDirectMessage = function (e) { var t = this, n = e.directMessage, r = e.directMessage, i = r.id, o = r.cid, s = r.fromPeerId, a = r.timestamp, u = r.transient, f = r.patchTimestamp, c = r.mentionPids, l = r.mentionAll, h = r.binaryMsg, p = r.msg, d = h ? h.toArrayBuffer() : p; return In.all([this.getConversation(n.cid), this._messageParser.parse(d)]).then(function (e) { var n = mf(e, 2), r = n[0], h = n[1]; if (r) return go(h, { id: i, cid: o, timestamp: a, updatedAt: f, from: s, mentionList: c, mentionedAll: l }), h._updateMentioned(t.id), h._setStatus(dp.SENT), h.from !== t.id && (u || r.transient || t._sendAck(h)), t._dispatchParsedMessage(h, r) }) }, t.prototype._dispatchParsedMessage = function (e, t) { var n = this; return Zu(this._plugins.beforeMessageDispatch, [e, t]).then(function (r) { !1 !== r && (t.lastMessage = e, t.lastMessageAt = e.timestamp, e.from !== n.id && (t.unreadMessagesCount += 1, e.mentioned && t._setUnreadMessagesMentioned(!0)), n.emit("message", e, t), t.emit("message", e)) }) }, t.prototype._sendAck = function (e) { this._debug("send ack for %O", e); var t = e.cid; if (!t) throw new Error("missing cid"); return this._ackMessageBuffer[t] || (this._ackMessageBuffer[t] = []), this._ackMessageBuffer[t].push(e), this._doSendAck() }, t.prototype._doSendAck = function () { var e = this; this._connection.is("connected") && (this._debug("do send ack %O", this._ackMessageBuffer), In.all(Jr(this._ackMessageBuffer).map(function (t) { var n = e._ackMessageBuffer[t], r = n.map(function (e) { return e.timestamp }), i = new Ki({ cmd: "ack", peerId: e.id, ackMessage: new Vi({ cid: t, fromts: Math.min.apply(null, r), tots: Math.max.apply(null, r) }) }); return delete e._ackMessageBuffer[t], e._send(i, !1).catch(function (r) { e._debug("send ack failed: %O", r), e._ackMessageBuffer[t] = n }) }))) }, t.prototype._omitPeerId = function (e) { Su(this).peerIdOmittable = e }, t.prototype._send = function (e) { var t, n = e; !Su(this).peerIdOmittable && this.id && (n.peerId = this.id); for (var r = arguments.length, i = Array(r > 1 ? r - 1 : 0), o = 1; o < r; o++)i[o - 1] = arguments[o]; return (t = this._connection).send.apply(t, [n].concat(i)) }, t.prototype._open = function (e, t, n) { var r = this, i = arguments.length > 3 && void 0 !== arguments[3] && arguments[3]; this._debug("open session"); var o = Su(this), s = o.lastUnreadNotifTime, a = o.lastPatchTime; return In.resolve(new Ki({ cmd: "session", op: "open", appId: e, sessionMessage: new Ui({ ua: "js/4.0.0-beta.0", r: i, lastUnreadNotifTime: s, lastPatchTime: a, configBitmap: 1 }) })).then(function (e) { if (i) { var o = Su(r).sessionToken; if (o) { var s = o.value; if (s && s !== uu.EXPIRED) return go(e.sessionMessage, { st: s }), e } } return go(e.sessionMessage, Cu({ tag: t, deviceId: n })), r.options.signatureFactory ? Dp(r.options.signatureFactory, [r._identity]).then(function (t) { return go(e.sessionMessage, vu({ signature: "s", timestamp: "t", nonce: "n" }, t)), e }) : e }).then(this._send.bind(this)).then(function (e) { var t = e.peerId, n = e.sessionMessage, i = e.sessionMessage, o = i.st, s = i.stTtl; if (i.code) throw zu(n); t ? (r.id = t, r._identity || (r._identity = t), o && (Su(r).sessionToken = new uu(o, 1e3 * s))) : console.warn("Unexpected session opened without peerId.") }).catch(function (o) { if (o.code === Yu.SESSION_TOKEN_EXPIRED) { if (void 0 === Su(r).sessionToken) throw new Error("Unexpected session expiration"); return Jp("Session token expired, reopening"), delete Su(r).sessionToken, r._open(e, t, n, i) } throw o }) }, t.prototype.close = function () { var e = bo(lo.mark(function e() { var t; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return this._debug("close session"), t = new Ki({ cmd: "session", op: "close" }), e.next = 4, this._send(t); case 4: Su(this)._eventemitter.emit("close"), this.emit("close", { code: 0 }); case 6: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.ping = function () { var e = bo(lo.mark(function e(t) { var n, r; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (this._debug("ping"), t instanceof Array) { e.next = 3; break } throw new TypeError("clientIds " + t + " is not an Array"); case 3: if (t.length) { e.next = 5; break } return e.abrupt("return", In.resolve([])); case 5: return n = new Ki({ cmd: "session", op: "query", sessionMessage: new Ui({ sessionPeerIds: t }) }), e.next = 8, this._send(n); case 8: return r = e.sent, e.abrupt("return", r.sessionMessage.onlineSessionPeerIds); case 10: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype.getConversation = function () { var e = bo(lo.mark(function e(t) { var n, r = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if ("string" == typeof t) { e.next = 2; break } throw new TypeError(t + " is not a String"); case 2: if (r) { e.next = 6; break } if (!(n = this._conversationCache.get(t))) { e.next = 6; break } return e.abrupt("return", n); case 6: if (!Zp(t)) { e.next = 8; break } return e.abrupt("return", this._getTemporaryConversations(t)); case 8: return e.abrupt("return", this.getQuery().equalTo("objectId", t).find().then(function (e) { return e[0] || null })); case 9: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype.getConversations = function () { var e = bo(lo.mark(function e(t) { var n, r, i, o, s = this, a = arguments.length > 1 && void 0 !== arguments[1] && arguments[1]; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (!(n = a ? t : t.filter(function (e) { return null === s._conversationCache.get(e) })).length) { e.next = 8; break } return r = zl(n, Zp), i = [], n.length && i.push(this.getQuery().containedIn("objectId", n).limit(999).find()), r.length && (o = r.map(this._getTemporaryConversations.bind(this)), i.push.apply(i, So(o))), e.next = 8, In.all(i); case 8: return e.abrupt("return", t.map(function (e) { return s._conversationCache.get(e) })); case 9: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._getTemporaryConversations = function () { var e = bo(lo.mark(function e(t) { var n, r; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return n = new Ki({ cmd: "conv", op: "query", convMessage: new zi({ tempConvId: t }) }), e.next = 3, this._send(n); case 3: return r = e.sent, e.next = 6, this._handleQueryResults(r); case 6: return e.abrupt("return", e.sent[0]); case 7: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype.getQuery = function () { return new Gp(this) }, t.prototype._executeQuery = function () { var e = bo(lo.mark(function e(t) { var n, r, i; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return n = t.toJSON(), n.where = new ki({ data: Wr(gu(n.where)) }), r = new Ki({ cmd: "conv", op: "query", convMessage: new zi(n) }), e.next = 5, this._send(r); case 5: return i = e.sent, e.abrupt("return", this._handleQueryResults(i)); case 7: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._handleQueryResults = function () { var e = bo(lo.mark(function e(t) { var n, r; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: n = void 0, e.prev = 1, n = JSON.parse(yu(t.convMessage.results.data)), e.next = 9; break; case 5: throw e.prev = 5, e.t0 = e.catch(1), r = Wr(Cu(t)), new Error("Parse query result failed: " + e.t0.message + ". Command: " + r); case 9: return e.next = 11, In.all(n.map(this._parseConversationFromRawData.bind(this))); case 11: return n = e.sent, e.abrupt("return", n.map(this._upsertConversationToCache.bind(this))); case 13: case "end": return e.stop() } }, e, this, [[1, 5]]) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._upsertConversationToCache = function (e) { var t = this._conversationCache.get(e.id); return t ? (this._debug("update cached conversation"), ["creator", "createdAt", "updatedAt", "lastMessageAt", "lastMessage", "mutedMembers", "members", "_attributes", "transient", "muted"].forEach(function (n) { var r = e[n]; void 0 !== r && (t[n] = r) }), t._reset && t._reset()) : (t = e, this._debug("no match, set cache"), this._conversationCache.set(e.id, e)), t }, t.prototype.parseMessage = function () { var e = bo(lo.mark(function e(t) { var n, r, i = t.data, o = t.bin, s = void 0 !== o && o, a = uf(t, ["data", "bin"]); return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return n = s ? vf(i) : i, e.next = 3, this._messageParser.parse(n); case 3: return r = e.sent, go(r, a), r._updateMentioned(this.id), e.abrupt("return", r); case 7: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype.parseConversation = function () { var e = bo(lo.mark(function e(t) { var n, r, i, o, s = t.id, a = t.lastMessageAt, u = t.lastMessage, f = t.lastDeliveredAt, c = t.lastReadAt, l = t.unreadMessagesCount, h = t.members, p = t.mentioned, d = uf(t, ["id", "lastMessageAt", "lastMessage", "lastDeliveredAt", "lastReadAt", "unreadMessagesCount", "members", "mentioned"]); return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (n = { id: s, lastMessageAt: a, lastMessage: u, lastDeliveredAt: f, lastReadAt: c, unreadMessagesCount: l, members: h, mentioned: p }, !u) { e.next = 6; break } return e.next = 4, this.parseMessage(u); case 4: n.lastMessage = e.sent, n.lastMessage._setStatus(dp.SENT); case 6: if (r = d.transient, i = d.system, o = d.expiredAt, !r) { e.next = 9; break } return e.abrupt("return", new Yp(n, d, this)); case 9: if (!i) { e.next = 11; break } return e.abrupt("return", new zp(n, d, this)); case 11: if (!o && !Zp(s)) { e.next = 13; break } return e.abrupt("return", new Wp(n, { expiredAt: o }, this)); case 13: return e.abrupt("return", new Vp(n, d, this)); case 14: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._parseConversationFromRawData = function () { var e = bo(lo.mark(function e(t) { var n, r; return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return (n = vu({ objectId: "id", lm: "lastMessageAt", m: "members", tr: "transient", sys: "system", c: "creator", mu: "mutedMembers" }, t)).msg && (n.lastMessage = { data: n.msg, bin: n.bin, from: n.msg_from, id: n.msg_mid, timestamp: n.msg_timestamp, updatedAt: n.patch_timestamp }, delete n.lastMessageFrom, delete n.lastMessageId, delete n.lastMessageTimestamp, delete n.lastMessagePatchTimestamp), (r = n.ttl) && (n.expiredAt = Date.now() + 1e3 * r), e.abrupt("return", this.parseConversation(n)); case 5: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype.createConversation = function () { var e = bo(lo.mark(function e() { var t, n, r, i, o, s, a, u, f, c, l, h, p, d = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}, m = d.members, y = d.name, g = d.transient, v = d.unique, b = d._tempConv, w = d._tempConvTTL, _ = uf(d, ["members", "name", "transient", "unique", "_tempConv", "_tempConvTTL"]); return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: if (g || Array.isArray(m)) { e.next = 2; break } throw new TypeError("conversation members " + m + " is not an array"); case 2: if ((t = new Yo(m)).add(this.id), t = To(t).sort(), n = _ || {}, !y) { e.next = 10; break } if ("string" == typeof y) { e.next = 9; break } throw new TypeError("conversation name " + y + " is not a string"); case 9: n.name = y; case 10: if (n = new ki({ data: Wr(gu(n)) }), r = { m: t, attr: n, transient: g, unique: v, tempConv: b, tempConvTTL: w }, i = new Ki({ cmd: "conv", op: "start", convMessage: new zi(r) }), !this.options.conversationSignatureFactory) { e.next = 19; break } return o = [null, this._identity, t, "create"], e.next = 17, Dp(this.options.conversationSignatureFactory, o); case 17: s = e.sent, go(i.convMessage, vu({ signature: "s", timestamp: "t", nonce: "n" }, s)); case 19: return e.next = 21, this._send(i); case 21: return a = e.sent, u = a.convMessage, f = u.cid, c = u.cdate, l = u.tempConvTTL, h = vo({ name: y, transient: g, unique: v, id: f, createdAt: c, updatedAt: c, lastMessageAt: null, creator: this.id, members: g ? [] : t }, _), l && (h.expiredAt = Date.now() + 1e3 * l), e.next = 30, this.parseConversation(h); case 30: return p = e.sent, e.abrupt("return", this._upsertConversationToCache(p)); case 32: case "end": return e.stop() } }, e, this) })); return function () { return e.apply(this, arguments) } }(), t.prototype.createChatRoom = function () { var e = bo(lo.mark(function e(t) { return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return e.abrupt("return", this.createConversation(vo({}, t, { transient: !0, members: null, unique: !1 }))); case 1: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype.createTemporaryConversation = function () { var e = bo(lo.mark(function e(t) { var n = t.ttl, r = uf(t, ["ttl"]); return lo.wrap(function (e) { for (; ;)switch (e.prev = e.next) { case 0: return e.abrupt("return", this.createConversation(vo({}, r, { transient: !1, unique: !1, _tempConv: !0, _tempConvTTL: n }))); case 1: case "end": return e.stop() } }, e, this) })); return function (t) { return e.apply(this, arguments) } }(), t.prototype._doSendRead = function () { var e = this; if (this._connection.is("connected")) { var t = Su(this).readConversationsBuffer, n = To(t); if (n.length) { var r = n.map(function (e) { if (!(e instanceof Vp)) throw new TypeError(e + " is not a Conversation"); return e.id }); this._debug("mark [" + r + "] as read"), t.clear(), this._sendReadCommand(n).catch(function (r) { e._debug("send read failed: %O", r), n.forEach(t.add.bind(t)) }) } } }, t.prototype._sendReadCommand = function (e) { var t = this; return this._send(new Ki({ cmd: "read", readMessage: new Zi({ convs: e.map(function (e) { return new Gi({ cid: e.id, mid: e.lastMessage && e.lastMessage.from !== t.id ? e.lastMessage.id : void 0, timestamp: (e.lastMessageAt || new Date).getTime() }) }) }) }), !1) }, t }(oo), V(Lp.prototype, "_doSendAck", [Pp], Da(Lp.prototype, "_doSendAck"), Lp.prototype), V(Lp.prototype, "_doSendRead", [Rp], Da(Lp.prototype, "_doSendRead"), Lp.prototype), Lp), Xp = function (e) { function t(n) { if (Cr(this, t), !(n instanceof ArrayBuffer)) throw new TypeError(n + " is not an ArrayBuffer"); return kr(this, e.call(this, n)) } return Yr(t, e), t.validate = function (e) { return e instanceof ArrayBuffer }, t.prototype.toJSON = function () { return vo({}, e.prototype._toJSON.call(this), { data: gf(this.content) }) }, t.prototype.toFullJSON = function () { return vo({}, e.prototype.toFullJSON.call(this), { bin: !0, data: gf(this.content) }) }, vi(t, [{ key: "buffer", get: function () { return this.content }, set: function (e) { this.content = e } }]), t }(wp), Kp = (kp = _p(-1))(Np = Tp(Np = function (e) { function t() { var n = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : ""; if (Cr(this, t), "string" != typeof n) throw new TypeError(n + " is not a string"); var r = kr(this, e.call(this)); return r.setText(n), r } return Yr(t, e), t }(Sp)) || Np) || Np, Qp = Ho("LC:MessageParser"), ed = (jp = function () { function e() { var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {}; Cr(this, e), this._plugins = t, this._messageClasses = [] } return e.prototype.register = function (e) { if (!(e && e.parse && e.prototype && e.prototype.getPayload)) throw new TypeError("Invalid messageClass"); this._messageClasses.unshift(e) }, e.prototype.parse = function (e) { Qp("parsing message: %O", e); var t = !0, n = !1, r = void 0; try { for (var i, o = df(this._messageClasses); !(t = (i = o.next()).done); t = !0) { var s = i.value, a = iu(e) ? go({}, e) : e, u = void 0, f = void 0; try { u = s.validate(a) } catch (e) { } if (u) { try { f = s.parse(a) } catch (e) { console.warn("parsing a valid message content error", { error: e, Klass: s, content: a }) } if (void 0 !== f) return Qp("parse result: %O", f), f } } } catch (e) { n = !0, r = e } finally { try { !t && o.return && o.return() } finally { if (n) throw r } } throw new Error("No Message Class matched") }, e }(), function (e, t, n, r, i) { var o = {}; Object.keys(r).forEach(function (e) { o[e] = r[e] }), o.enumerable = !!o.enumerable, o.configurable = !!o.configurable, ("value" in o || o.initializer) && (o.writable = !0), o = n.slice().reverse().reduce(function (n, r) { return r(e, t, n) || n }, o), i && void 0 !== o.initializer && (o.value = o.initializer ? o.initializer.call(i) : void 0, o.initializer = void 0), void 0 === o.initializer && (Object.defineProperty(e, t, o), o = null) }(jp.prototype, "parse", [function (e, t, n) { var r = n.value; n.value = function (e) { var t = void 0; if ("string" != typeof e) t = e; else try { t = JSON.parse(e) } catch (n) { t = e } return r.call(this, t) } }, function (e, t, n) { var r = n.value; n.value = function (e) { var t = this; return In.resolve(e).then(Ju(this._plugins.beforeMessageParse)).then(function (e) { return r.call(t, e) }).then(Ju(this._plugins.afterMessageParse)) } }], Da(jp.prototype, "parse"), jp.prototype), jp), td = Ho("LC:IMPlugin"), nd = { HIGH: 1, NORMAL: 2, LOW: 3 }; Bu(nd); var rd = function (e) { var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : { get: function () { return this.get(e) }, set: function (t) { this.set(e, t) } }; Rr(Vp.prototype, e, t) }, id = { name: "leancloud-realtime-plugin-im", onRealtimeCreate: function (e) { var t = af(); e._IMClients = {}, e._IMClientsCreationCount = 0; var n = new ed(e._plugins); e._messageParser = n; var r = function () { var t = bo(lo.mark(function t(n) { return lo.wrap(function (t) { for (; ;)switch (t.prev = t.next) { case 0: return t.abrupt("return", e._request({ method: "POST", path: "/rtm/sign", data: { session_token: n.getSessionToken() } })); case 1: case "end": return t.stop() } }, t, void 0) })); return function (e) { return t.apply(this, arguments) } }(), i = function (e) { return Ou(e).map(n.register.bind(n)) }; i(Ou(e._plugins.messageClasses)); var o = function () { var i = bo(lo.mark(function i(o, s, a) { var u, f, c, l; return lo.wrap(function (i) { for (; ;)switch (i.prev = i.next) { case 0: if (u = void 0, f = {}, !o) { i.next = 18; break } if ("string" != typeof o) { i.next = 7; break } u = o, i.next = 16; break; case 7: if (!o.id || !o.getSessionToken) { i.next = 15; break } if (u = o.id, c = o.getSessionToken()) { i.next = 12; break } throw new Error("User must be authenticated"); case 12: f.signatureFactory = r, i.next = 16; break; case 15: throw new TypeError("Identity must be a String or an AV.User"); case 16: if (void 0 === e._IMClients[u]) { i.next = 18; break } return i.abrupt("return", e._IMClients[u]); case 18: return l = e._open().then(function (r) { var i = new Hp(u, vo({}, f, s), r, { _messageParser: n, _plugins: e._plugins, _identity: o }); return r.on("reconnect", function () { return i._open(e._options.appId, a, t, !0).then(function () { return i.emit("reconnect") }, function (e) { return i.emit("reconnecterror", e) }) }), Su(i)._eventemitter.on("close", function () { delete e._IMClients[i.id], e._deregister(i) }, e), i._open(e._options.appId, a, t).then(function () { return e._IMClients[i.id] = i, e._IMClientsCreationCount += 1, 1 === e._IMClientsCreationCount ? (i._omitPeerId(!0), e._firstIMClient = i) : e._IMClientsCreationCount > 1 && e._firstIMClient && e._firstIMClient._omitPeerId(!1), e._register(i), i }).catch(function (t) { throw delete e._IMClients[i.id], t }) }), o && (e._IMClients[u] = l), i.abrupt("return", l); case 21: case "end": return i.stop() } }, i, void 0) })); return function (e, t, n) { return i.apply(this, arguments) } }(); go(e, { register: i, createIMClient: o }) }, beforeCommandDispatch: function (e, t) { if (null !== e.service && 2 !== e.service) return !0; var n = e.peerId ? t._IMClients[e.peerId] : t._firstIMClient; return n ? In.resolve(n).then(function (t) { return t._dispatchCommand(e) }).catch(td) : td("[WARN] Unexpected message received without any live client match: %O", Cu(e)), !1 }, messageClasses: [wp, Xp, Ap, Kp] }; Ku.defineConversationProperty = rd, Ku.__preRegisteredPlugins = [id], e.Protocals = io, e.Promise = In, e.EventEmitter = oo, e.Realtime = Ku, e.ErrorCode = Yu, e.Message = wp, e.BinaryMessage = Xp, e.TypedMessage = Sp, e.TextMessage = Kp, e.RecalledMessage = Ap, e.MessagePriority = nd, e.MessageStatus = dp, e.MessageQueryDirection = Mp, e.defineConversationProperty = rd, e.IMPlugin = id, e.messageType = _p, e.messageField = Ep, e.IE10Compatible = Tp, e.Conversation = Vp, e.ChatRoom = Yp, e.ServiceConversation = zp, e.TemporaryConversation = Wp, Object.defineProperty(e, "__esModule", { value: !0 }) });
//# sourceMappingURL=realtime.weapp.min.js.map